angular.module("storiesModule",["ngRoute","ngCookies","ui.bootstrap","ui.sortable","configModule","bodyModule","topMenuModule","storyModule","compositeClassesModule","compositesModule","runnerModule","loginModule","tourModule"]).service("TcBddService",["$modal","$http","$location","$q",function(t,e,o,s){this.openCompositeClass=function(e){var o=this;t.open({templateUrl:"/assets/html/compositeClasses/compositeClasses.tmpl.html",controller:"compositeClassesCtrl",resolve:{compositeClasses:["$route","$http","$modal",function(){return o.getJson("/groovyComposites",!1)}],compositeStepText:function(){return e}}})},this.newCollectionItem=function(t,e){13===t.which&&e.push({})},this.removeCollectionElement=function(t,e){t.splice(e,1)},this.buttonCssClass=function(t){return{"btn-success":t.$valid,"btn-danger":t.$invalid}},this.getRunnerProgressCss=function(t){return{"progress progress-striped active":t,progress:!t}},this.getStoryRunnerStatusText=function(t,e,o){return t?"Story run is in progress":e?o>0?"Story run was successful with "+o+" pending steps":"Story run was successful":"Story run failed"},this.getRunnerStatusCss=function(t,e,o){return{"progress-bar progress-bar-info":t,"progress-bar progress-bar-warning":!t&&e&&o,"progress-bar progress-bar-success":!t&&e&&!o,"progress-bar progress-bar-danger":!t&&!e}},this.openRunnerParametersModal=function(e,o){var s=this;return t.open({templateUrl:"/assets/html/runner/runnerParams.tmpl.html",controller:"runnerParamsCtrl",resolve:{data:["$route","$http","$modal",function(){return s.getJson("/steps/classes.json",!0)}],showGetApi:function(){return e},features:function(){return{runStory:o.features.runStory}}}})},this.openDir=function(t,e){if(".."===e){var o=t.rootPath.split("/");t.rootPath=o.slice(0,o.length-2).join("/"),""!==t.rootPath&&(t.rootPath+="/"),this.getStories(t,"")}else this.getStories(t,e)},this.getStories=function(t,o){var s=this;void 0===t.rootPath&&(t.rootPath=""),e.get("/stories/list.json?path="+t.rootPath+o).then(function(e){t.files=e.data,""!==o&&(t.rootPath+=o+"/")},function(t){s.openErrorModal(t.data)})},this.stepTextPattern=function(){return/^(Given|When|Then) .+$/},this.openConfirmationModal=function(e){return t.open({templateUrl:"/assets/html/confirmationModal.tmpl.html",controller:"modalCtrl",resolve:{data:function(){return e}}})},this.classNamePattern=function(){return/^[a-zA-Z_$][a-zA-Z\d_$]*$/},this.cssClass=function(t){return{"has-error":t.$invalid,"has-success":t.$valid&&t.$dirty}},this.deleteStory=function(t){var n=this,r=s.defer(),a={status:"Delete Story",message:"Are you sure you want to delete this story?"},i=this.openConfirmationModal(a);return i.result.then(function(){e.delete("/stories/story/"+t).then(function(){o.path("/page/stories/new/"),r.resolve("OK")},function(t){n.openErrorModal(t.data),r.reject("NOK")})},function(){r.reject("NOK")}),r.promise},this.getJson=function(t,o){var s=this;return e.get(t,{cache:o}).then(function(t){return t.data},function(t){s.openErrorModal(t.data)})},this.openErrorModal=function(e){t.open({templateUrl:"/assets/html/errorModal.tmpl.html",controller:"modalCtrl",resolve:{data:function(){return e}}})},this.startJoyRide=function(t,o){e.get("/api/v1/data/"+t).then(function(t){o.configJoyRide=t.data.data,o.tours=[{}],o.startJoyRideFlag=!0},function(){o.startJoyRideFlag=!1})},this.onFinishJoyRide=function(t){t.startJoyRideFlag=!1,t.tours=[]}}]).controller("modalCtrl",["$scope","$modalInstance","data",function(t,e,o){t.data=o,t.ok=function(){e.close("ok")},t.cancel=function(){e.dismiss("cancel")}}]),angular.module("configModule",[]).config(["$routeProvider","$locationProvider",function(t,e){e.html5Mode(!0),t.when("/page/tour/",{templateUrl:"/assets/html/tour/tour.tmpl.html",controller:"tourCtrl"}).when("/page/stories/new/",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",resolve:{story:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/stories/story.json",!1)}],steps:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/steps/list.json",!0)}],groovyComposites:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/groovyComposites",!0)}]}}).when("/page/stories/new/:path*",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",resolve:{story:["$route","$http","$modal","TcBddService",function(t,e,o,s){return s.getJson("/stories/story.json?path="+t.current.params.path+".story",!1)}],steps:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/steps/list.json",!0)}],groovyComposites:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/groovyComposites",!0)}]}}).when("/page/stories/view/:path*",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",resolve:{story:["$route","$http","$modal","TcBddService",function(t,e,o,s){return s.getJson("/stories/story.json?path="+t.current.params.path+".story",!1)}],steps:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/steps/list.json",!0)}],groovyComposites:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/groovyComposites",!0)}]},reloadOnSearch:!1}).when("/page/composites/:className*",{templateUrl:"/assets/html/composites/composites.tmpl.html",controller:"compositesCtrl",resolve:{compositesClass:["$route","$http",function(t,e){var o=t.current.params.className,s="/groovyComposites/"+o;return e.get(s,{cache:!1}).then(function(t){return t.data},function(){var t=o.substring(0,o.lastIndexOf("."));return{"class":t,composites:[{stepText:"",compositeSteps:[{}]}],isNew:!0}})}],steps:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/steps/list.json",!1)}]}}).when("/page/runner/",{templateUrl:"/assets/html/runner/runner.tmpl.html",controller:"runnerCtrl",resolve:{data:["$route",function(t){return{reportsPath:t.current.params.path}}]}}).when("/page/login/",{templateUrl:"/assets/html/login/login.tmpl.html",controller:"loginCtrl"}).when("/page/loginWelcome/",{templateUrl:"/assets/html/login/loginWelcome.tmpl.html",controller:"loginWelcomeCtrl"}).otherwise({redirectTo:"/page/tour"})}]),angular.module("bodyModule",["ngJoyRide"]).controller("bodyCtrl",["$scope","$http","$modal","$location","TcBddService","$rootScope",function(t,e,o,s,n){t.onFinishJoyRide=function(){n.onFinishJoyRide(t)},t.startJoyRide=function(e){n.startJoyRide(e,t)},t.startJoyRideOnLoad=function(){void 0!==s.search().tour&&t.startJoyRide("tour_"+s.search().tour)},t.openStory=function(){o.open({templateUrl:"/assets/html/stories.tmpl.html",controller:"storiesCtrl",resolve:{data:function(){return{}},features:function(){return{deleteStory:t.features.deleteStory}}}})},t.openModal=function(){if(void 0!==s.search().openModal){var e=s.search().openModal;"openStory"===e&&t.openStory()}},t.loadFeatures=function(){e.get("/api/v1/data/features").then(function(e){t.features=e.data.data,t.openModal()},function(){t.features=[]})},t.loadFeatures(),t.startJoyRideOnLoad()}]),angular.module("compositeClassesModule",[]).controller("compositeClassesCtrl",["$scope","$http","$modalInstance","compositeClasses","compositeStepText","TcBddService",function(t,e,o,s,n,r){t.compositeClasses=s,t.compositeStepText=n,t.close=function(){o.close()},t.compositeClassUrl=function(e,o){var s="/page/composites/";void 0!==e&&""!==e&&(s+=e+".");var n;return n=o.split(o.indexOf("/")>=0?"/":"\\"),s+=n[n.length-1],void 0!==t.compositeStepText&&""!==t.compositeStepText&&(s+="?stepText="+t.compositeStepText),s},t.compositeClassText=function(t){var e;e=t.split(t.indexOf("/")>=0?"/":"\\");var o=e[e.length-1];return o.indexOf(".")>=0&&(o=o.substr(0,o.lastIndexOf("."))),o},t.classNamePattern=r.classNamePattern,t.cssClass=r.cssClass,t.data={"class":""}}]),angular.module("compositesModule",[]).controller("compositesCtrl",["$scope","$http","$modal","$location","$cookieStore","compositesClass","steps","TcBddService",function(t,e,o,s,n,r,a,i){t.addNewComposite=function(){t.composite={stepText:"",compositeSteps:[{}]},t.compositesClass.composites.push(t.composite)},t.addStepTextParam=function(){void 0!==s.search().stepText&&""!==s.search().stepText&&t.compositesClass.composites.push({stepText:s.search().stepText,compositeSteps:[]})},t.addNewCompositeStep=function(){t.composite.compositeSteps.push({})},t.setLastComposite=function(){if(void 0!==t.compositesClass){var e=t.compositesClass.composites.length;t.composite=t.compositesClass.composites[e-1]}else t.composite={}},t.compositesClass=r,t.addStepTextParam(),t.originalCompositesClass=angular.copy(r),t.setLastComposite(),t.steps=a,t.classNamePattern=i.classNamePattern,t.stepTextPattern=i.stepTextPattern,t.cssClass=i.cssClass,t.buttonCssClass=function(t,e){return i.buttonCssClass(t.$valid?e:t)},t.openComposite=function(e){t.composite=e},t.newCollectionItem=i.newCollectionItem,t.removeCollectionElement=i.removeCollectionElement,t.revertCompositesClass=function(){t.compositesClass=angular.copy(t.originalCompositesClass),t.composite=t.compositesClass.composites[0]},t.canRevertCompositesClass=function(){return!angular.equals(t.compositesClass,t.originalCompositesClass)},t.canSaveCompositesClass=function(e){var o=e.$valid,s=!angular.equals(t.compositesClass,t.originalCompositesClass),n=t.compositesClass.isNew;return(n||s)&&o},t.compositesAreValid=function(e){var o=e.$valid;return angular.forEach(t.compositesClass.composites,function(t){void 0===t.stepText||""===t.stepText?o=!1:(void 0===t.compositeSteps||0===t.compositeSteps.length)&&(o=!1)}),o},t.saveCompositesClass=function(){e.put("/groovyComposites",t.compositesClass).then(function(){t.deleteCompositesClassWithoutConfirmation(),s.path("/page/composites/"+t.compositesClass.class+".groovy"),t.compositesClass.isNew=!1,t.originalCompositesClass=angular.copy(t.compositesClass),n.put("compositeClass",t.compositesClass.class)},function(t){i.openErrorModal(t.data)})},t.canDeleteCompositesClass=function(){return!t.compositesClass.isNew},t.deleteCompositesClassWithoutConfirmation=function(){var o=t.compositesClass.class,s=t.originalCompositesClass.class;o!==s&&e.delete("/groovyComposites/"+s).then(function(){},function(t){i.openErrorModal(t.data)})},t.deleteCompositesClass=function(){var o={status:"Delete Composites Class",message:"Are you sure you want to delete this composites class?"},n=i.openConfirmationModal(o);n.result.then(function(){e.delete("/groovyComposites/"+t.originalCompositesClass.class).then(function(){s.path("/")},function(t){i.openErrorModal(t.data)})},function(){})},t.saveCompositesText=function(){return t.compositesClass.isNew?"Create New Composites":"Update Composites"}}]),angular.module("loginModule",[]).controller("loginCtrl",["$scope","$location","TcBddService",function(t,e,o){t.init=function(){t.users=[]},t.cssClass=o.cssClass,t.buttonCssClass=o.buttonCssClass,t.canLogin=function(){return t.loginForm.$valid},t.register=function(){t.users.push(t.user),t.user={}},t.delete=function(){angular.forEach(t.users,function(e,o){e.username===t.user.username&&(t.users.splice(o,1),t.user={})})},t.login=function(){angular.forEach(t.users,function(o){o.username===t.user.username&&e.path("/page/loginWelcome")}),t.user.notRegistered=!0},t.init()}]).controller("loginWelcomeCtrl",["$scope",function(){}]),angular.module("runnerModule",[]).controller("runnerCtrl",["$scope","$modal","$http","$location","$timeout","TcBddService",function(t,e,o,s,n,r){t.openRunnerSelector=function(){return e.open({templateUrl:"/assets/html/runner/runnerSelector.tmpl.html",controller:"runnerSelectorCtrl",resolve:{data:function(){return{}}}})},t.openRunner=function(){var e=t.openRunnerSelector();void 0!==e&&e.result.then(function(e){var s=[];e.dirs.forEach(function(t){s.push({path:t.path+"/**/*.story"})}),e.stories.forEach(function(t){s.push({path:t.path})}),r.openRunnerParametersModal(!0,t).result.then(function(e){var n=e.classes,r=e.action;o.get("/groovyComposites").then(function(e){var o=e.data;t.apiJson={storyPaths:s,classes:n,groovyComposites:o},"run"===r?(t.run(t.apiJson),t.showApi=!1):t.showApi=!0})})})},t.run=function(e){var s="/api/v1/reporters/get/";t.reportsUrl="",t.storyRunnerSuccess=!1,t.showRunnerProgress=!0,o.post("/runner/run.json",e).then(function(e){var o=e.data;"OK"===o.status?(t.reportsUrl=s+o.reportsPath,t.storyRunnerInProgress=!0,t.getReports(o.id)):"FAILED"===o.status?(t.reportsUrl=s+o.reportsPath,t.storyRunnerInProgress=!1):r.openErrorModal(o)},function(e){t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!1,r.openErrorModal(e.data)})},t.getReports=function(e){o.get("/api/v1/reporters/list/"+e).then(function(o){t.reports=o.data,"finished"!==t.reports.status?(t.showRunnerProgress=!0,n(function(){t.getReports(e)},15e3)):t.showRunnerProgress=!1},function(o){"ID is NOT correct"===o.data.message?n(function(){t.getReports(e)},15e3):(t.showRunnerProgress=!1,r.openErrorModal(o.data))})},t.getRunnerStatusCss=function(){return r.getRunnerStatusCss(t.storyRunnerInProgress,t.storyRunnerSuccess,t.pendingSteps>0)},t.getStoryRunnerStatusText=function(){return t.storyRunnerInProgress?"Stories run is in progress":"Stories run is finished"},t.getRunnerProgressCss=function(){return r.getRunnerProgressCss(t.storyRunnerInProgress)},t.onLoad=function(){if(t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!1,t.showRunnerProgress=!1,t.pendingSteps=[],t.reportsUrl="",void 0===s.search().reportsId)t.openRunner();else{var e=s.search().reportsId;t.reportsUrl="/api/v1/reporters/get/"+e+"/view/reports.html",t.getReports(e)}t.showApi=!1},t.apiUrl=function(){return s.protocol()+"://"+s.host()+":"+s.port()+"/runner/run.json"},t.onLoad()}]).controller("runnerSelectorCtrl",["$scope","$http","$modal","$modalInstance","TcBddService",function(t,e,o,s,n){t.files={dirs:[],stories:[]},n.getStories(t,""),t.openDir=function(e){n.openDir(t,e)},t.cancelRunnerSelector=function(){s.dismiss("cancel")},t.okRunnerSelector=function(){var e={dirs:[],stories:[]};angular.forEach(t.files.dirs,function(o){o.selected&&e.dirs.push({path:t.rootPath+o.name})}),angular.forEach(t.files.stories,function(o){o.selected&&e.stories.push({path:t.rootPath+o.name+".story"})}),s.close(e)},t.allowToPrevDir=function(){return""!==t.rootPath},t.canContinue=function(){var e=!1;return angular.forEach(t.files.dirs,function(t){t.selected&&(e=!0)}),e||angular.forEach(t.files.stories,function(t){t.selected&&(e=!0)}),e}}]).controller("runnerParamsCtrl",["$scope","$modalInstance","$cookieStore","data","showGetApi","TcBddService","features",function(t,e,o,s,n,r,a){t.onLoad=function(){t.paramArray=[],t.features=a},t.classes=s.classes,t.setParams=function(){t.classes.forEach(function(t){t.params.forEach(function(e){if(void 0!==e.value&&""!==e.value)e.disabled=!0;else{e.disabled=!1;try{e.value=o.get(t.fullName+"."+e.key)}catch(s){console.log("Could not retrieve cookie "+t.fullName+"."+e.key),console.log(s.message)}}})})},t.hasOptions=function(t){return t?t.length>0:!1},t.hasParams=function(t){return void 0!==t.params&&t.params.length>0},t.ok=function(){e.close({action:"run",classes:t.classes})},t.cancel=function(){e.dismiss("cancel")},t.showGetApi=function(){return n},t.getApi=function(){e.close({action:"api",classes:t.classes})},t.paramElementId=function(t,e){var o=t.charAt(0).toLowerCase()+t.slice(1),s=e.charAt(0).toUpperCase()+e.slice(1);return o+s},t.setParams(),t.onFinishJoyRide=function(){r.onFinishJoyRide(t)},t.startJoyRide=function(e){r.startJoyRide(e,t)},t.onLoad()}]),angular.module("storyModule",[]).controller("storyCtrl",["$scope","$http","$modal","$location","$cookieStore","$q","$anchorScroll","$timeout","story","steps","groovyComposites","TcBddService",function(t,e,o,s,n,r,a,i,l,c,u,p){t.onLoad=function(){t.pendingSteps=[],t.story=l,t.steps=c,t.groovyComposites=u,t.stepTypes=["GIVEN","WHEN","THEN"],t.storyFormClass="col-md-12",t.storyRunnerVisible=!1,t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!0,t.expandPanels(),t.originalStory=angular.copy(l);var e=t.story.path.split("/");if(t.dirPath=e.slice(0,e.length-1).join("/"),""!==t.dirPath&&(t.dirPath+="/"),t.setAction(),void 0!==s.search().reportsId&&(t.storyFormClass="col-md-6",t.storyRunnerClass="col-md-6",t.storyRunnerVisible=!0,t.getReports(s.search().reportsId)),void 0!==s.search().openModal){var o=s.search().openModal;"openRunStory"===o&&t.openRunnerParams()}},t.setAction=function(){t.action=""!==t.story.name?"PUT":"POST"},t.expandPanels=function(){var e=!0;void 0===t.panelsExpanded?t.panelsExpanded=!1:(t.panelsExpanded=!t.panelsExpanded,e=t.panelsExpanded),t.panels={story:t.panelsExpanded,description:t.panelsExpanded,meta:t.panelsExpanded,narrative:t.panelsExpanded,givenStories:t.panelsExpanded,lifecycle:t.panelsExpanded,scenarios:e}},t.cssClass=p.cssClass,t.buttonCssClass=p.buttonCssClass,t.canSaveStory=function(){var e=t.storyForm.$valid,o=!angular.equals(t.story,t.originalStory);return e&&o},t.stepTextPattern=p.stepTextPattern,t.saveStory=function(){if(t.canSaveStory())if(t.story.path=t.dirPath+t.story.name+".story","POST"===t.action){var o=t.dirPath.split("/"),n=o.slice(0,o.length-1).join("/");""!==n&&(n+="/"),e.post("/stories/story.json",t.story).then(function(){s.path("/page/stories/view/"+n+t.story.name),t.originalStory=angular.copy(t.story)},function(e){t.openErrorModal(e.data)})}else t.story.name!==t.originalStory.name&&(t.story.originalPath=t.originalStory.path),e.put("/stories/story.json",t.story).then(function(){t.originalStory=angular.copy(t.story)},function(e){t.openErrorModal(e.data)})},t.canRunStory=function(){return t.storyForm.$valid&&!t.storyRunnerInProgress},t.runStory=function(){t.canRunStory()&&(t.saveStory(),t.openRunnerParams())},t.openRunnerParams=function(){t.openRunnerModal().result.then(function(o){var s=o.classes;t.storyFormClass="col-md-6",t.storyRunnerClass="col-md-6",t.storyRunnerVisible=!0,t.storyRunnerInProgress=!0,s.forEach(function(t){t.params.forEach(function(e){n.put(t.fullName+"."+e.key,e.value)})});var r={storyPaths:[{path:t.story.path}],classes:s,groovyComposites:t.groovyComposites};e.post("/runner/run.json",r).then(function(e){t.getReports(e.data.id)},function(e){t.storyRunnerSuccess=!1,t.storyRunnerInProgress=!1,t.openErrorModal(e.data)})},function(e){t.openErrorModal(e.data)})},t.getReports=function(o){e.get("/api/v1/reporters/list/"+o).then(function(e){if(console.log(o),console.log(e.data),"finished"!==e.data.status)console.log("111"),t.storyRunnerInProgress=!0,i(function(){t.getReports(o)},5e3);else{console.log("222");var s=e.data.reports;t.reports=s,t.reports.id=o,t.setPendingSteps(s),t.storyRunnerInProgress=!1,t.storyRunnerSuccess=t.isStoryRunnerSuccess(s)}},function(e){"ID is NOT correct"===e.data.message?i(function(){t.getReports(o)},5e3):(t.storyRunnerInProgress=!1,p.openErrorModal(e.data))})},t.isStoryRunnerSuccess=function(t){var e=!0;return t.forEach(function(t){t.steps.forEach(function(t){"successful"!==t.status&&"pending"!==t.status&&"notPerformed"!==t.status&&(e=!1)})}),e},t.getReportUrl=function(t,e){return"/api/v1/reporters/get/"+t+"/"+e},t.openRunnerModal=function(){return p.openRunnerParametersModal(!1,t)},t.getRunnerProgressCss=function(){return p.getRunnerProgressCss(t.storyRunnerInProgress)},t.getRunnerStatusCss=function(){return p.getRunnerStatusCss(t.storyRunnerInProgress,t.storyRunnerSuccess,t.pendingSteps>0)},t.setPendingSteps=function(e){t.pendingSteps=[],e.forEach(function(e){e.steps.forEach(function(e){"pending"===e.status&&t.pendingSteps.push({text:e.text})})})},t.hasPendingSteps=function(){return void 0!==t.pendingSteps&&t.pendingSteps.length>0},t.getStoryRunnerStatusText=function(){return p.getStoryRunnerStatusText(t.storyRunnerInProgress,t.storyRunnerSuccess,t.pendingSteps.length)},t.removeCollectionElement=p.removeCollectionElement,t.addElement=function(t){t.push({})},t.addScenarioElement=function(t){t.push({title:"",meta:[],steps:[],examplesTable:""})},t.revertStory=function(){t.story=angular.copy(t.originalStory),t.storyForm.$setPristine()},t.canRevertStory=function(){return!angular.equals(t.story,t.originalStory)},t.canDeleteStory=function(){return"PUT"===t.action&&!t.storyRunnerInProgress},t.deleteStory=function(){var e=t.dirPath+t.story.name+".story";p.deleteStory(e)},t.stepEnterKey=p.newCollectionItem,t.clickPendingStep=function(t){var e=n.get("compositeClass");return void 0===e||""===e?p.openCompositeClass(t):s.search("stepText",t).path("/page/composites/"+e+".groovy")},t.openErrorModal=p.openErrorModal,t.onLoad()}]).controller("storiesCtrl",["$scope","$http","$modal","$modalInstance","$location","$q","TcBddService","features",function(t,e,o,s,n,r,a,i){a.getStories(t,""),t.features=i,t.openDir=function(e){a.openDir(t,e)},t.close=function(){s.close()},t.openStory=function(e){t.onFinishJoyRide(),s.close(),n.path("/page/stories/view/"+t.rootPath+e)},t.allowToPrevDir=function(){return""!==t.rootPath},t.deleteStory=function(e,o){var s=t.rootPath+e+".story";a.deleteStory(s).then(function(){t.files.stories.splice(o,1)})},t.createDirectory=function(o){var s='{"path": "'+t.rootPath+o+'"}';e.post("/stories/dir.json",s).then(function(){t.files.dirs.push({name:o})},function(t){a.openErrorModal(t.data)})},t.onFinishJoyRide=function(){a.onFinishJoyRide(t)},t.startJoyRide=function(e){a.startJoyRide(e,t)}}]),angular.module("topMenuModule",[]).controller("topMenuController",["$scope","$location","TcBddService",function(t,e,o){t.openCompositeClass=function(){o.openCompositeClass()},t.getTitle=function(){var t=e.path();return 0===t.indexOf("/page/stories/view/")?"View Story":0===t.indexOf("/page/stories/new/")?"New Story":0===t.indexOf("/page/composites/")?"Composites":0===t.indexOf("/page/reports/")?"Reports":0===t.indexOf("/page/login/")?"Login":0===t.indexOf("/page/loginWelcome/")?"Welcome":0===t.indexOf("/page/tour/")?"Home":""}}]),angular.module("tourModule",[]).controller("tourCtrl",["$scope","$location",function(){}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlcyI6WyJpbmRleC5qcyIsImNvbmZpZy5qcyIsImNvbW1vblxcYm9keS5jdHJsLmpzIiwiY29tcG9zaXRlQ2xhc3Nlc1xcY29tcG9zaXRlQ2xhc3Nlcy5jdHJsLmpzIiwiY29tcG9zaXRlc1xcY29tcG9zaXRlcy5jdHJsLmpzIiwibG9naW5cXGxvZ2luLmN0cmwuanMiLCJydW5uZXJcXHJ1bm5lci5jdHJsLmpzIiwic3RvcnlcXHN0b3J5LmN0cmwuanMiLCJ0b3BNZW51XFx0b3BNZW51LmN0cmwuanMiLCJ0b3VyXFx0b3VyLmN0cmwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsUUFBQSxPQUFBLGlCQUNBLFVBQ0EsWUFDQSxlQUNBLGNBQ0EsZUFDQSxhQUNBLGdCQUNBLGNBQ0EseUJBQ0EsbUJBQ0EsZUFDQSxjQUNBLGVBRUEsUUFBQSxnQkFBQSxTQUFBLFFBQUEsWUFBQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxLQUFBLG1CQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsSUFDQSxHQUFBLE1BQ0EsWUFBQSwyREFDQSxXQUFBLHVCQUNBLFNBQ0Esa0JBQUEsU0FBQSxRQUFBLFNBQUEsV0FDQSxNQUFBLEdBQUEsUUFBQSxxQkFBQSxLQUVBLGtCQUFBLFdBQ0EsTUFBQSxRQUtBLEtBQUEsa0JBQUEsU0FBQSxFQUFBLEdBQ0EsS0FBQSxFQUFBLE9BQ0EsRUFBQSxVQUdBLEtBQUEsd0JBQUEsU0FBQSxFQUFBLEdBQ0EsRUFBQSxPQUFBLEVBQUEsSUFFQSxLQUFBLGVBQUEsU0FBQSxHQUNBLE9BQ0EsY0FBQSxFQUFBLE9BQ0EsYUFBQSxFQUFBLFdBR0EsS0FBQSxxQkFBQSxTQUFBLEdBQ0EsT0FDQSxtQ0FBQSxFQUNBLFVBQUEsSUFHQSxLQUFBLHlCQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUNBLDJCQUNBLEVBQ0EsRUFBQSxFQUNBLGlDQUFBLEVBQUEsaUJBRUEsMkJBR0Esb0JBR0EsS0FBQSxtQkFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLE9BQ0EsaUNBQUEsRUFDQSxxQ0FBQSxHQUFBLEdBQUEsRUFDQSxxQ0FBQSxHQUFBLElBQUEsRUFDQSxvQ0FBQSxJQUFBLElBR0EsS0FBQSwwQkFBQSxTQUFBLEVBQUEsR0FDQSxHQUFBLEdBQUEsSUFDQSxPQUFBLEdBQUEsTUFDQSxZQUFBLDZDQUNBLFdBQUEsbUJBQ0EsU0FDQSxNQUFBLFNBQUEsUUFBQSxTQUFBLFdBQ0EsTUFBQSxHQUFBLFFBQUEsdUJBQUEsS0FFQSxXQUFBLFdBQ0EsTUFBQSxJQUVBLFNBQUEsV0FDQSxPQUFBLFNBQUEsRUFBQSxTQUFBLGVBS0EsS0FBQSxRQUFBLFNBQUEsRUFBQSxHQUNBLEdBQUEsT0FBQSxFQUFBLENBQ0EsR0FBQSxHQUFBLEVBQUEsU0FBQSxNQUFBLElBQ0EsR0FBQSxTQUFBLEVBQUEsTUFBQSxFQUFBLEVBQUEsT0FBQSxHQUFBLEtBQUEsS0FDQSxLQUFBLEVBQUEsV0FDQSxFQUFBLFVBQUEsS0FFQSxLQUFBLFdBQUEsRUFBQSxRQUVBLE1BQUEsV0FBQSxFQUFBLElBR0EsS0FBQSxXQUFBLFNBQUEsRUFBQSxHQUNBLEdBQUEsR0FBQSxJQUNBLFVBQUEsRUFBQSxXQUNBLEVBQUEsU0FBQSxJQUVBLEVBQUEsSUFBQSwyQkFBQSxFQUFBLFNBQUEsR0FBQSxLQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsRUFBQSxLQUNBLEtBQUEsSUFDQSxFQUFBLFVBQUEsRUFBQSxNQUVBLFNBQUEsR0FDQSxFQUFBLGVBQUEsRUFBQSxTQUdBLEtBQUEsZ0JBQUEsV0FDQSxNQUFBLDBCQUVBLEtBQUEsc0JBQUEsU0FBQSxHQUNBLE1BQUEsR0FBQSxNQUNBLFlBQUEsMkNBQ0EsV0FBQSxZQUNBLFNBQ0EsS0FBQSxXQUNBLE1BQUEsUUFLQSxLQUFBLGlCQUFBLFdBQ0EsTUFBQSw2QkFFQSxLQUFBLFNBQUEsU0FBQSxHQUNBLE9BQ0EsWUFBQSxFQUFBLFNBQ0EsY0FBQSxFQUFBLFFBQUEsRUFBQSxTQUlBLEtBQUEsWUFBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLEtBQ0EsRUFBQSxFQUFBLFFBQ0EsR0FBQSxPQUFBLGVBQUEsUUFBQSwrQ0FDQSxFQUFBLEtBQUEsc0JBQUEsRUFZQSxPQVhBLEdBQUEsT0FBQSxLQUFBLFdBQ0EsRUFBQSxPQUFBLGtCQUFBLEdBQUEsS0FBQSxXQUNBLEVBQUEsS0FBQSxzQkFDQSxFQUFBLFFBQUEsT0FDQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEVBQUEsTUFDQSxFQUFBLE9BQUEsVUFFQSxXQUNBLEVBQUEsT0FBQSxTQUVBLEVBQUEsU0FFQSxLQUFBLFFBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLElBQ0EsT0FBQSxHQUFBLElBQUEsR0FBQSxNQUFBLElBQUEsS0FBQSxTQUFBLEdBQ0EsTUFBQSxHQUFBLE1BQ0EsU0FBQSxHQUNBLEVBQUEsZUFBQSxFQUFBLFNBR0EsS0FBQSxlQUFBLFNBQUEsR0FDQSxFQUFBLE1BQ0EsWUFBQSxvQ0FDQSxXQUFBLFlBQ0EsU0FDQSxLQUFBLFdBQ0EsTUFBQSxRQUtBLEtBQUEsYUFBQSxTQUFBLEVBQUEsR0FDQSxFQUFBLElBQUEsZ0JBQUEsR0FBQSxLQUFBLFNBQUEsR0FDQSxFQUFBLGNBQUEsRUFBQSxLQUFBLEtBQ0EsRUFBQSxXQUNBLEVBQUEsa0JBQUEsR0FDQSxXQUNBLEVBQUEsa0JBQUEsS0FHQSxLQUFBLGdCQUFBLFNBQUEsR0FDQSxFQUFBLGtCQUFBLEVBQ0EsRUFBQSxhQUdBLFdBQUEsYUFBQSxTQUFBLGlCQUFBLE9BQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLEtBQUEsRUFDQSxFQUFBLEdBQUEsV0FDQSxFQUFBLE1BQUEsT0FFQSxFQUFBLE9BQUEsV0FDQSxFQUFBLFFBQUEsY0NyTUEsUUFBQSxPQUFBLG1CQUNBLFFBQUEsaUJBQUEsb0JBQUEsU0FBQSxFQUFBLEdBQ0EsRUFBQSxXQUFBLEdBQ0EsRUFDQSxLQUFBLGVBQ0EsWUFBQSxtQ0FDQSxXQUFBLGFBRUEsS0FBQSxzQkFDQSxZQUFBLHFDQUNBLFdBQUEsWUFFQSxTQUNBLE9BQUEsUUFBQSxTQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxNQUFBLEdBQUEsUUFBQSx1QkFBQSxLQUVBLE9BQUEsUUFBQSxTQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxNQUFBLEdBQUEsUUFBQSxvQkFBQSxLQUVBLGtCQUFBLFFBQUEsU0FBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLFFBQUEscUJBQUEsUUFJQSxLQUFBLDRCQUNBLFlBQUEscUNBQ0EsV0FBQSxZQUVBLFNBQ0EsT0FBQSxTQUFBLFFBQUEsU0FBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxNQUFBLEdBQUEsUUFBQSw0QkFBQSxFQUFBLFFBQUEsT0FBQSxLQUFBLFVBQUEsS0FFQSxPQUFBLFFBQUEsU0FBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLFFBQUEsb0JBQUEsS0FFQSxrQkFBQSxRQUFBLFNBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsR0FBQSxRQUFBLHFCQUFBLFFBSUEsS0FBQSw2QkFDQSxZQUFBLHFDQUNBLFdBQUEsWUFFQSxTQUNBLE9BQUEsU0FBQSxRQUFBLFNBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLFFBQUEsNEJBQUEsRUFBQSxRQUFBLE9BQUEsS0FBQSxVQUFBLEtBRUEsT0FBQSxRQUFBLFNBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsR0FBQSxRQUFBLG9CQUFBLEtBRUEsa0JBQUEsUUFBQSxTQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxNQUFBLEdBQUEsUUFBQSxxQkFBQSxNQUdBLGdCQUFBLElBRUEsS0FBQSxnQ0FDQSxZQUFBLCtDQUNBLFdBQUEsaUJBRUEsU0FDQSxpQkFBQSxTQUFBLFFBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsUUFBQSxPQUFBLFVBQ0EsRUFBQSxxQkFBQSxDQUNBLE9BQUEsR0FBQSxJQUFBLEdBQUEsT0FBQSxJQUFBLEtBQUEsU0FBQSxHQUNBLE1BQUEsR0FBQSxNQUNBLFdBQ0EsR0FBQSxHQUFBLEVBQUEsVUFBQSxFQUFBLEVBQUEsWUFBQSxLQUNBLFFBQ0EsUUFBQSxFQUNBLGFBQUEsU0FBQSxHQUFBLHNCQUNBLE9BQUEsT0FJQSxPQUFBLFFBQUEsU0FBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLFFBQUEsb0JBQUEsUUFJQSxLQUFBLGlCQUNBLFlBQUEsdUNBQ0EsV0FBQSxhQUVBLFNBQ0EsTUFBQSxTQUFBLFNBQUEsR0FDQSxPQUFBLFlBQUEsRUFBQSxRQUFBLE9BQUEsV0FJQSxLQUFBLGdCQUNBLFlBQUEscUNBQ0EsV0FBQSxjQUVBLEtBQUEsdUJBQ0EsWUFBQSw0Q0FDQSxXQUFBLHFCQUVBLFdBQ0EsV0FBQSxrQkNwR0EsUUFBQSxPQUFBLGNBQUEsY0FDQSxXQUFBLFlBQUEsU0FBQSxRQUFBLFNBQUEsWUFBQSxlQUFBLGFBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxnQkFBQSxXQUNBLEVBQUEsZ0JBQUEsSUFFQSxFQUFBLGFBQUEsU0FBQSxHQUNBLEVBQUEsYUFBQSxFQUFBLElBRUEsRUFBQSxtQkFBQSxXQUNBLFNBQUEsRUFBQSxTQUFBLE1BQ0EsRUFBQSxhQUFBLFFBQUEsRUFBQSxTQUFBLE9BSUEsRUFBQSxVQUFBLFdBQ0EsRUFBQSxNQUNBLFlBQUEsaUNBQ0EsV0FBQSxjQUNBLFNBQ0EsS0FBQSxXQUNBLFVBRUEsU0FBQSxXQUNBLE9BQUEsWUFBQSxFQUFBLFNBQUEsa0JBS0EsRUFBQSxVQUFBLFdBQ0EsR0FBQSxTQUFBLEVBQUEsU0FBQSxVQUFBLENBQ0EsR0FBQSxHQUFBLEVBQUEsU0FBQSxTQUNBLGVBQUEsR0FDQSxFQUFBLGNBSUEsRUFBQSxhQUFBLFdBQ0EsRUFBQSxJQUFBLHlCQUFBLEtBQUEsU0FBQSxHQUNBLEVBQUEsU0FBQSxFQUFBLEtBQUEsS0FDQSxFQUFBLGFBQ0EsV0FDQSxFQUFBLGVBR0EsRUFBQSxlQUNBLEVBQUEsd0JDN0NBLFFBQUEsT0FBQSw2QkFDQSxXQUFBLHdCQUFBLFNBQUEsUUFBQSxpQkFBQSxtQkFBQSxvQkFBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxpQkFBQSxFQUNBLEVBQUEsa0JBQUEsRUFFQSxFQUFBLE1BQUEsV0FDQSxFQUFBLFNBRUEsRUFBQSxrQkFBQSxTQUFBLEVBQUEsR0FDQSxHQUFBLEdBQUEsbUJBQ0EsVUFBQSxHQUFBLEtBQUEsSUFDQSxHQUFBLEVBQUEsSUFFQSxJQUFBLEVBVUEsT0FSQSxHQUFBLEVBQUEsTUFEQSxFQUFBLFFBQUEsTUFBQSxFQUNBLElBRUEsTUFFQSxHQUFBLEVBQUEsRUFBQSxPQUFBLEdBQ0EsU0FBQSxFQUFBLG1CQUFBLEtBQUEsRUFBQSxvQkFDQSxHQUFBLGFBQUEsRUFBQSxtQkFFQSxHQUVBLEVBQUEsbUJBQUEsU0FBQSxHQUNBLEdBQUEsRUFFQSxHQUFBLEVBQUEsTUFEQSxFQUFBLFFBQUEsTUFBQSxFQUNBLElBRUEsS0FFQSxJQUFBLEdBQUEsRUFBQSxFQUFBLE9BQUEsRUFJQSxPQUhBLEdBQUEsUUFBQSxNQUFBLElBQ0EsRUFBQSxFQUFBLE9BQUEsRUFBQSxFQUFBLFlBQUEsT0FFQSxHQUVBLEVBQUEsaUJBQUEsRUFBQSxpQkFFQSxFQUFBLFNBQUEsRUFBQSxTQUNBLEVBQUEsTUFBQSxRQUFBLE9DekNBLFFBQUEsT0FBQSx1QkFDQSxXQUFBLGtCQUFBLFNBQUEsUUFBQSxTQUFBLFlBQUEsZUFBQSxrQkFBQSxRQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxnQkFBQSxXQUNBLEVBQUEsV0FBQSxTQUFBLEdBQUEscUJBQ0EsRUFBQSxnQkFBQSxXQUFBLEtBQUEsRUFBQSxZQUVBLEVBQUEsaUJBQUEsV0FDQSxTQUFBLEVBQUEsU0FBQSxVQUFBLEtBQUEsRUFBQSxTQUFBLFVBQ0EsRUFBQSxnQkFBQSxXQUFBLE1BQUEsU0FBQSxFQUFBLFNBQUEsU0FBQSxxQkFHQSxFQUFBLG9CQUFBLFdBQ0EsRUFBQSxVQUFBLGVBQUEsVUFFQSxFQUFBLGlCQUFBLFdBQ0EsR0FBQSxTQUFBLEVBQUEsZ0JBQUEsQ0FDQSxHQUFBLEdBQUEsRUFBQSxnQkFBQSxXQUFBLE1BQ0EsR0FBQSxVQUFBLEVBQUEsZ0JBQUEsV0FBQSxFQUFBLE9BRUEsR0FBQSxjQUdBLEVBQUEsZ0JBQUEsRUFDQSxFQUFBLG1CQUNBLEVBQUEsd0JBQUEsUUFBQSxLQUFBLEdBQ0EsRUFBQSxtQkFDQSxFQUFBLE1BQUEsRUFDQSxFQUFBLGlCQUFBLEVBQUEsaUJBQ0EsRUFBQSxnQkFBQSxFQUFBLGdCQUNBLEVBQUEsU0FBQSxFQUFBLFNBQ0EsRUFBQSxlQUFBLFNBQUEsRUFBQSxHQUNBLE1BR0EsR0FBQSxlQUhBLEVBQUEsT0FHQSxFQUZBLElBS0EsRUFBQSxjQUFBLFNBQUEsR0FDQSxFQUFBLFVBQUEsR0FFQSxFQUFBLGtCQUFBLEVBQUEsa0JBQ0EsRUFBQSx3QkFBQSxFQUFBLHdCQUNBLEVBQUEsc0JBQUEsV0FDQSxFQUFBLGdCQUFBLFFBQUEsS0FBQSxFQUFBLHlCQUNBLEVBQUEsVUFBQSxFQUFBLGdCQUFBLFdBQUEsSUFFQSxFQUFBLHlCQUFBLFdBQ0EsT0FBQSxRQUFBLE9BQUEsRUFBQSxnQkFBQSxFQUFBLDBCQUVBLEVBQUEsdUJBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLE9BQ0EsR0FBQSxRQUFBLE9BQUEsRUFBQSxnQkFBQSxFQUFBLHlCQUNBLEVBQUEsRUFBQSxnQkFBQSxLQUNBLFFBQUEsR0FBQSxJQUFBLEdBRUEsRUFBQSxtQkFBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsTUFRQSxPQVBBLFNBQUEsUUFBQSxFQUFBLGdCQUFBLFdBQUEsU0FBQSxHQUNBLFNBQUEsRUFBQSxVQUFBLEtBQUEsRUFBQSxTQUNBLEdBQUEsR0FDQSxTQUFBLEVBQUEsZ0JBQUEsSUFBQSxFQUFBLGVBQUEsVUFDQSxHQUFBLEtBR0EsR0FFQSxFQUFBLG9CQUFBLFdBQ0EsRUFBQSxJQUFBLG9CQUFBLEVBQUEsaUJBQUEsS0FBQSxXQUNBLEVBQUEsMkNBQ0EsRUFBQSxLQUFBLG9CQUFBLEVBQUEsZ0JBQUEsTUFBQSxXQUNBLEVBQUEsZ0JBQUEsT0FBQSxFQUNBLEVBQUEsd0JBQUEsUUFBQSxLQUFBLEVBQUEsaUJBQ0EsRUFBQSxJQUFBLGlCQUFBLEVBQUEsZ0JBQUEsUUFDQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEVBQUEsU0FHQSxFQUFBLHlCQUFBLFdBQ0EsT0FBQSxFQUFBLGdCQUFBLE9BSUEsRUFBQSx5Q0FBQSxXQUNBLEdBQUEsR0FBQSxFQUFBLGdCQUFBLE1BQ0EsRUFBQSxFQUFBLHdCQUFBLEtBQ0EsS0FBQSxHQUNBLEVBQUEsT0FBQSxxQkFBQSxHQUFBLEtBQUEsYUFDQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEVBQUEsU0FLQSxFQUFBLHNCQUFBLFdBQ0EsR0FBQSxJQUFBLE9BQUEsMEJBQUEsUUFBQSwwREFDQSxFQUFBLEVBQUEsc0JBQUEsRUFDQSxHQUFBLE9BQUEsS0FBQSxXQUNBLEVBQUEsT0FBQSxxQkFBQSxFQUFBLHdCQUFBLE9BQUEsS0FBQSxXQUNBLEVBQUEsS0FBQSxNQUNBLFNBQUEsR0FDQSxFQUFBLGVBQUEsRUFBQSxTQUVBLGVBSUEsRUFBQSxtQkFBQSxXQUNBLE1BQUEsR0FBQSxnQkFBQSxNQUNBLHdCQUVBLHdCQzlHQSxRQUFBLE9BQUEsa0JBQ0EsV0FBQSxhQUFBLFNBQUEsWUFBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxLQUFBLFdBQ0EsRUFBQSxVQUVBLEVBQUEsU0FBQSxFQUFBLFNBQ0EsRUFBQSxlQUFBLEVBQUEsZUFDQSxFQUFBLFNBQUEsV0FDQSxNQUFBLEdBQUEsVUFBQSxRQUdBLEVBQUEsU0FBQSxXQUNBLEVBQUEsTUFBQSxLQUFBLEVBQUEsTUFDQSxFQUFBLFNBR0EsRUFBQSxPQUFBLFdBQ0EsUUFBQSxRQUFBLEVBQUEsTUFBQSxTQUFBLEVBQUEsR0FDQSxFQUFBLFdBQUEsRUFBQSxLQUFBLFdBQ0EsRUFBQSxNQUFBLE9BQUEsRUFBQSxHQUNBLEVBQUEsWUFJQSxFQUFBLE1BQUEsV0FFQSxRQUFBLFFBQUEsRUFBQSxNQUFBLFNBQUEsR0FDQSxFQUFBLFdBQUEsRUFBQSxLQUFBLFVBQ0EsRUFBQSxLQUFBLHdCQUdBLEVBQUEsS0FBQSxlQUFBLEdBRUEsRUFBQSxVQUVBLFdBQUEsb0JBQUEsU0FBQSxlQ25DQSxRQUFBLE9BQUEsbUJBQ0EsV0FBQSxjQUFBLFNBQUEsU0FBQSxRQUFBLFlBQUEsV0FBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsRUFBQSxtQkFBQSxXQUNBLE1BQUEsR0FBQSxNQUNBLFlBQUEsK0NBQ0EsV0FBQSxxQkFDQSxTQUNBLEtBQUEsV0FDQSxjQU1BLEVBQUEsV0FBQSxXQUNBLEdBQUEsR0FBQSxFQUFBLG9CQUNBLFVBQUEsR0FDQSxFQUFBLE9BQUEsS0FBQSxTQUFBLEdBQ0EsR0FBQSxLQUNBLEdBQUEsS0FBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsS0FBQSxFQUFBLEtBQUEsa0JBRUEsRUFBQSxRQUFBLFFBQUEsU0FBQSxHQUNBLEVBQUEsTUFBQSxLQUFBLEVBQUEsU0FFQSxFQUFBLDJCQUFBLEVBQUEsR0FBQSxPQUFBLEtBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLFFBQ0EsRUFBQSxFQUFBLE1BQ0EsR0FBQSxJQUFBLHFCQUFBLEtBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLElBQ0EsR0FBQSxTQUNBLFdBQUEsRUFDQSxRQUFBLEVBQ0EsaUJBQUEsR0FFQSxRQUFBLEdBQ0EsRUFBQSxJQUFBLEVBQUEsU0FDQSxFQUFBLFNBQUEsR0FFQSxFQUFBLFNBQUEsU0FPQSxFQUFBLElBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSx3QkFDQSxHQUFBLFdBQUEsR0FDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSxvQkFBQSxFQUNBLEVBQUEsS0FBQSxtQkFBQSxHQUFBLEtBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLElBQ0EsUUFBQSxFQUFBLFFBQ0EsRUFBQSxXQUFBLEVBQUEsRUFBQSxZQUNBLEVBQUEsdUJBQUEsRUFDQSxFQUFBLFdBQUEsRUFBQSxLQUNBLFdBQUEsRUFBQSxRQUNBLEVBQUEsV0FBQSxFQUFBLEVBQUEsWUFDQSxFQUFBLHVCQUFBLEdBRUEsRUFBQSxlQUFBLElBRUEsU0FBQSxHQUNBLEVBQUEsdUJBQUEsRUFDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSxlQUFBLEVBQUEsU0FHQSxFQUFBLFdBQUEsU0FBQSxHQUNBLEVBQUEsSUFBQSwwQkFBQSxHQUFBLEtBQUEsU0FBQSxHQUNBLEVBQUEsUUFBQSxFQUFBLEtBQ0EsYUFBQSxFQUFBLFFBQUEsUUFDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSxXQUNBLEVBQUEsV0FBQSxJQUNBLE9BRUEsRUFBQSxvQkFBQSxHQUVBLFNBQUEsR0FDQSxzQkFBQSxFQUFBLEtBQUEsUUFDQSxFQUFBLFdBQ0EsRUFBQSxXQUFBLElBQ0EsT0FFQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSxlQUFBLEVBQUEsVUFJQSxFQUFBLG1CQUFBLFdBQ0EsTUFBQSxHQUFBLG1CQUNBLEVBQUEsc0JBQ0EsRUFBQSxtQkFDQSxFQUFBLGFBQUEsSUFHQSxFQUFBLHlCQUFBLFdBQ0EsTUFBQSxHQUFBLHNCQUNBLDZCQUVBLDJCQUdBLEVBQUEscUJBQUEsV0FDQSxNQUFBLEdBQUEscUJBQUEsRUFBQSx3QkFFQSxFQUFBLE9BQUEsV0FNQSxHQUxBLEVBQUEsdUJBQUEsRUFDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSxvQkFBQSxFQUNBLEVBQUEsZ0JBQ0EsRUFBQSxXQUFBLEdBQ0EsU0FBQSxFQUFBLFNBQUEsVUFDQSxFQUFBLGlCQUNBLENBQ0EsR0FBQSxHQUFBLEVBQUEsU0FBQSxTQUNBLEdBQUEsV0FBQSx5QkFBQSxFQUFBLHFCQUNBLEVBQUEsV0FBQSxHQUVBLEVBQUEsU0FBQSxHQUVBLEVBQUEsT0FBQSxXQUNBLE1BQUEsR0FBQSxXQUFBLE1BQUEsRUFBQSxPQUFBLElBQUEsRUFBQSxPQUFBLG9CQUVBLEVBQUEsWUFFQSxXQUFBLHNCQUFBLFNBQUEsUUFBQSxTQUFBLGlCQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxPQUFBLFFBQUEsWUFDQSxFQUFBLFdBQUEsRUFBQSxJQUNBLEVBQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxRQUFBLEVBQUEsSUFFQSxFQUFBLHFCQUFBLFdBQ0EsRUFBQSxRQUFBLFdBRUEsRUFBQSxpQkFBQSxXQUNBLEdBQUEsSUFBQSxRQUFBLFdBQ0EsU0FBQSxRQUFBLEVBQUEsTUFBQSxLQUFBLFNBQUEsR0FDQSxFQUFBLFVBQ0EsRUFBQSxLQUFBLE1BQUEsS0FBQSxFQUFBLFNBQUEsRUFBQSxTQUdBLFFBQUEsUUFBQSxFQUFBLE1BQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxVQUNBLEVBQUEsUUFBQSxNQUFBLEtBQUEsRUFBQSxTQUFBLEVBQUEsS0FBQSxhQUdBLEVBQUEsTUFBQSxJQUVBLEVBQUEsZUFBQSxXQUNBLE1BQUEsS0FBQSxFQUFBLFVBRUEsRUFBQSxZQUFBLFdBQ0EsR0FBQSxJQUFBLENBYUEsT0FaQSxTQUFBLFFBQUEsRUFBQSxNQUFBLEtBQUEsU0FBQSxHQUNBLEVBQUEsV0FDQSxHQUFBLEtBR0EsR0FDQSxRQUFBLFFBQUEsRUFBQSxNQUFBLFFBQUEsU0FBQSxHQUNBLEVBQUEsV0FDQSxHQUFBLEtBSUEsTUFHQSxXQUFBLG9CQUFBLFNBQUEsaUJBQUEsZUFBQSxPQUFBLGFBQUEsZUFBQSxXQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLE9BQUEsV0FDQSxFQUFBLGNBQ0EsRUFBQSxTQUFBLEdBRUEsRUFBQSxRQUFBLEVBQUEsUUFDQSxFQUFBLFVBQUEsV0FDQSxFQUFBLFFBQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxPQUFBLFFBQUEsU0FBQSxHQUNBLEdBQUEsU0FBQSxFQUFBLE9BQUEsS0FBQSxFQUFBLE1BQ0EsRUFBQSxVQUFBLE1BQ0EsQ0FDQSxFQUFBLFVBQUEsQ0FDQSxLQUNBLEVBQUEsTUFBQSxFQUFBLElBQUEsRUFBQSxTQUFBLElBQUEsRUFBQSxLQUNBLE1BQUEsR0FDQSxRQUFBLElBQUEsNkJBQUEsRUFBQSxTQUFBLElBQUEsRUFBQSxLQUNBLFFBQUEsSUFBQSxFQUFBLGdCQU1BLEVBQUEsV0FBQSxTQUFBLEdBQ0EsTUFBQSxHQUNBLEVBQUEsT0FBQSxHQUVBLEdBR0EsRUFBQSxVQUFBLFNBQUEsR0FDQSxNQUFBLFVBQUEsRUFBQSxRQUFBLEVBQUEsT0FBQSxPQUFBLEdBRUEsRUFBQSxHQUFBLFdBQ0EsRUFBQSxPQUFBLE9BQUEsTUFBQSxRQUFBLEVBQUEsV0FFQSxFQUFBLE9BQUEsV0FDQSxFQUFBLFFBQUEsV0FFQSxFQUFBLFdBQUEsV0FDQSxNQUFBLElBRUEsRUFBQSxPQUFBLFdBQ0EsRUFBQSxPQUFBLE9BQUEsTUFBQSxRQUFBLEVBQUEsV0FFQSxFQUFBLGVBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsT0FBQSxHQUFBLGNBQUEsRUFBQSxNQUFBLEdBQ0EsRUFBQSxFQUFBLE9BQUEsR0FBQSxjQUFBLEVBQUEsTUFBQSxFQUNBLE9BQUEsR0FBQSxHQUVBLEVBQUEsWUFDQSxFQUFBLGdCQUFBLFdBQ0EsRUFBQSxnQkFBQSxJQUVBLEVBQUEsYUFBQSxTQUFBLEdBQ0EsRUFBQSxhQUFBLEVBQUEsSUFFQSxFQUFBLFlDck9BLFFBQUEsT0FBQSxrQkFDQSxXQUFBLGFBQUEsU0FBQSxRQUFBLFNBQUEsWUFBQSxlQUFBLEtBQUEsZ0JBQUEsV0FBQSxRQUFBLFFBQUEsbUJBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsT0FBQSxXQUNBLEVBQUEsZ0JBQ0EsRUFBQSxNQUFBLEVBQ0EsRUFBQSxNQUFBLEVBQ0EsRUFBQSxpQkFBQSxFQUNBLEVBQUEsV0FBQSxRQUFBLE9BQUEsUUFDQSxFQUFBLGVBQUEsWUFDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSx1QkFBQSxFQUNBLEVBQUEsb0JBQUEsRUFDQSxFQUFBLGVBQ0EsRUFBQSxjQUFBLFFBQUEsS0FBQSxFQUNBLElBQUEsR0FBQSxFQUFBLE1BQUEsS0FBQSxNQUFBLElBWUEsSUFYQSxFQUFBLFFBQUEsRUFBQSxNQUFBLEVBQUEsRUFBQSxPQUFBLEdBQUEsS0FBQSxLQUNBLEtBQUEsRUFBQSxVQUNBLEVBQUEsU0FBQSxLQUVBLEVBQUEsWUFDQSxTQUFBLEVBQUEsU0FBQSxZQUNBLEVBQUEsZUFBQSxXQUNBLEVBQUEsaUJBQUEsV0FDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSxXQUFBLEVBQUEsU0FBQSxZQUVBLFNBQUEsRUFBQSxTQUFBLFVBQUEsQ0FDQSxHQUFBLEdBQUEsRUFBQSxTQUFBLFNBQ0Esa0JBQUEsR0FDQSxFQUFBLHFCQUlBLEVBQUEsVUFBQSxXQUVBLEVBQUEsT0FEQSxLQUFBLEVBQUEsTUFBQSxLQUNBLE1BRUEsUUFHQSxFQUFBLGFBQUEsV0FDQSxHQUFBLElBQUEsQ0FDQSxVQUFBLEVBQUEsZUFDQSxFQUFBLGdCQUFBLEdBRUEsRUFBQSxnQkFBQSxFQUFBLGVBQ0EsRUFBQSxFQUFBLGdCQUVBLEVBQUEsUUFDQSxNQUFBLEVBQUEsZUFDQSxZQUFBLEVBQUEsZUFDQSxLQUFBLEVBQUEsZUFDQSxVQUFBLEVBQUEsZUFDQSxhQUFBLEVBQUEsZUFDQSxVQUFBLEVBQUEsZUFDQSxVQUFBLElBR0EsRUFBQSxTQUFBLEVBQUEsU0FDQSxFQUFBLGVBQUEsRUFBQSxlQUNBLEVBQUEsYUFBQSxXQUNBLEdBQUEsR0FBQSxFQUFBLFVBQUEsT0FDQSxHQUFBLFFBQUEsT0FBQSxFQUFBLE1BQUEsRUFBQSxjQUNBLE9BQUEsSUFBQSxHQUVBLEVBQUEsZ0JBQUEsRUFBQSxnQkFFQSxFQUFBLFVBQUEsV0FDQSxHQUFBLEVBQUEsZUFFQSxHQURBLEVBQUEsTUFBQSxLQUFBLEVBQUEsUUFBQSxFQUFBLE1BQUEsS0FBQSxTQUNBLFNBQUEsRUFBQSxPQUFBLENBQ0EsR0FBQSxHQUFBLEVBQUEsUUFBQSxNQUFBLEtBQ0EsRUFBQSxFQUFBLE1BQUEsRUFBQSxFQUFBLE9BQUEsR0FBQSxLQUFBLElBQ0EsTUFBQSxJQUNBLEdBQUEsS0FFQSxFQUFBLEtBQUEsc0JBQUEsRUFBQSxPQUFBLEtBQUEsV0FDQSxFQUFBLEtBQUEsc0JBQUEsRUFBQSxFQUFBLE1BQUEsTUFDQSxFQUFBLGNBQUEsUUFBQSxLQUFBLEVBQUEsUUFDQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEVBQUEsWUFHQSxHQUFBLE1BQUEsT0FBQSxFQUFBLGNBQUEsT0FDQSxFQUFBLE1BQUEsYUFBQSxFQUFBLGNBQUEsTUFFQSxFQUFBLElBQUEsc0JBQUEsRUFBQSxPQUFBLEtBQUEsV0FDQSxFQUFBLGNBQUEsUUFBQSxLQUFBLEVBQUEsUUFDQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEVBQUEsU0FLQSxFQUFBLFlBQUEsV0FDQSxNQUFBLEdBQUEsVUFBQSxTQUFBLEVBQUEsdUJBRUEsRUFBQSxTQUFBLFdBQ0EsRUFBQSxnQkFDQSxFQUFBLFlBQ0EsRUFBQSxxQkFJQSxFQUFBLGlCQUFBLFdBQ0EsRUFBQSxrQkFBQSxPQUFBLEtBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLE9BQ0EsR0FBQSxlQUFBLFdBQ0EsRUFBQSxpQkFBQSxXQUNBLEVBQUEsb0JBQUEsRUFDQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLE9BQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxJQUFBLEVBQUEsU0FBQSxJQUFBLEVBQUEsSUFBQSxFQUFBLFVBR0EsSUFBQSxJQUNBLGFBQUEsS0FBQSxFQUFBLE1BQUEsT0FDQSxRQUFBLEVBQ0EsaUJBQUEsRUFBQSxpQkFFQSxHQUFBLEtBQUEsbUJBQUEsR0FBQSxLQUFBLFNBQUEsR0FDQSxFQUFBLFdBQUEsRUFBQSxLQUFBLEtBQ0EsU0FBQSxHQUNBLEVBQUEsb0JBQUEsRUFDQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxlQUFBLEVBQUEsU0FFQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEVBQUEsU0FHQSxFQUFBLFdBQUEsU0FBQSxHQUNBLEVBQUEsSUFBQSwwQkFBQSxHQUFBLEtBQUEsU0FBQSxHQUdBLEdBRkEsUUFBQSxJQUFBLEdBQ0EsUUFBQSxJQUFBLEVBQUEsTUFDQSxhQUFBLEVBQUEsS0FBQSxPQUNBLFFBQUEsSUFBQSxPQUNBLEVBQUEsdUJBQUEsRUFDQSxFQUFBLFdBQ0EsRUFBQSxXQUFBLElBQ0EsU0FDQSxDQUNBLFFBQUEsSUFBQSxNQUNBLElBQUEsR0FBQSxFQUFBLEtBQUEsT0FDQSxHQUFBLFFBQUEsRUFDQSxFQUFBLFFBQUEsR0FBQSxFQUNBLEVBQUEsZ0JBQUEsR0FDQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxtQkFBQSxFQUFBLHFCQUFBLEtBRUEsU0FBQSxHQUNBLHNCQUFBLEVBQUEsS0FBQSxRQUNBLEVBQUEsV0FDQSxFQUFBLFdBQUEsSUFDQSxNQUVBLEVBQUEsdUJBQUEsRUFDQSxFQUFBLGVBQUEsRUFBQSxVQUlBLEVBQUEscUJBQUEsU0FBQSxHQUNBLEdBQUEsSUFBQSxDQVFBLE9BUEEsR0FBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsUUFBQSxTQUFBLEdBQ0EsZUFBQSxFQUFBLFFBQUEsWUFBQSxFQUFBLFFBQUEsaUJBQUEsRUFBQSxTQUNBLEdBQUEsT0FJQSxHQUVBLEVBQUEsYUFBQSxTQUFBLEVBQUEsR0FDQSxNQUFBLHlCQUFBLEVBQUEsSUFBQSxHQUVBLEVBQUEsZ0JBQUEsV0FDQSxNQUFBLEdBQUEsMkJBQUEsRUFBQSxJQUVBLEVBQUEscUJBQUEsV0FDQSxNQUFBLEdBQUEscUJBQUEsRUFBQSx3QkFFQSxFQUFBLG1CQUFBLFdBQ0EsTUFBQSxHQUFBLG1CQUNBLEVBQUEsc0JBQ0EsRUFBQSxtQkFDQSxFQUFBLGFBQUEsSUFHQSxFQUFBLGdCQUFBLFNBQUEsR0FDQSxFQUFBLGdCQUNBLEVBQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxNQUFBLFFBQUEsU0FBQSxHQUNBLFlBQUEsRUFBQSxRQUNBLEVBQUEsYUFBQSxNQUFBLEtBQUEsRUFBQSxZQUtBLEVBQUEsZ0JBQUEsV0FDQSxNQUFBLFVBQUEsRUFBQSxjQUFBLEVBQUEsYUFBQSxPQUFBLEdBRUEsRUFBQSx5QkFBQSxXQUNBLE1BQUEsR0FBQSx5QkFDQSxFQUFBLHNCQUNBLEVBQUEsbUJBQ0EsRUFBQSxhQUFBLFNBR0EsRUFBQSx3QkFBQSxFQUFBLHdCQUNBLEVBQUEsV0FBQSxTQUFBLEdBQ0EsRUFBQSxVQUVBLEVBQUEsbUJBQUEsU0FBQSxHQUNBLEVBQUEsTUFBQSxNQUFBLEdBQUEsUUFBQSxTQUFBLGNBQUEsTUFFQSxFQUFBLFlBQUEsV0FDQSxFQUFBLE1BQUEsUUFBQSxLQUFBLEVBQUEsZUFDQSxFQUFBLFVBQUEsZ0JBRUEsRUFBQSxlQUFBLFdBQ0EsT0FBQSxRQUFBLE9BQUEsRUFBQSxNQUFBLEVBQUEsZ0JBRUEsRUFBQSxlQUFBLFdBQ0EsTUFBQSxRQUFBLEVBQUEsU0FBQSxFQUFBLHVCQUdBLEVBQUEsWUFBQSxXQUNBLEdBQUEsR0FBQSxFQUFBLFFBQUEsRUFBQSxNQUFBLEtBQUEsUUFDQSxHQUFBLFlBQUEsSUFFQSxFQUFBLGFBQUEsRUFBQSxrQkFFQSxFQUFBLGlCQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxJQUFBLGlCQUNBLE9BQUEsVUFBQSxHQUFBLEtBQUEsRUFDQSxFQUFBLG1CQUFBLEdBRUEsRUFBQSxPQUFBLFdBQUEsR0FBQSxLQUFBLG9CQUFBLEVBQUEsWUFJQSxFQUFBLGVBQUEsRUFBQSxlQUNBLEVBQUEsWUFFQSxXQUFBLGVBQUEsU0FBQSxRQUFBLFNBQUEsaUJBQUEsWUFBQSxLQUFBLGVBQUEsV0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLFdBQUEsRUFBQSxJQUNBLEVBQUEsU0FBQSxFQUNBLEVBQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxRQUFBLEVBQUEsSUFFQSxFQUFBLE1BQUEsV0FDQSxFQUFBLFNBRUEsRUFBQSxVQUFBLFNBQUEsR0FDQSxFQUFBLGtCQUNBLEVBQUEsUUFDQSxFQUFBLEtBQUEsc0JBQUEsRUFBQSxTQUFBLElBRUEsRUFBQSxlQUFBLFdBQ0EsTUFBQSxLQUFBLEVBQUEsVUFHQSxFQUFBLFlBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsU0FBQSxFQUFBLFFBQ0EsR0FBQSxZQUFBLEdBQUEsS0FBQSxXQUNBLEVBQUEsTUFBQSxRQUFBLE9BQUEsRUFBQSxNQUlBLEVBQUEsZ0JBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxhQUFBLEVBQUEsU0FBQSxFQUFBLElBQ0EsR0FBQSxLQUFBLG9CQUFBLEdBQUEsS0FBQSxXQUNBLEVBQUEsTUFBQSxLQUFBLE1BQUEsS0FBQSxLQUNBLFNBQUEsR0FDQSxFQUFBLGVBQUEsRUFBQSxTQUdBLEVBQUEsZ0JBQUEsV0FDQSxFQUFBLGdCQUFBLElBRUEsRUFBQSxhQUFBLFNBQUEsR0FDQSxFQUFBLGFBQUEsRUFBQSxPQzFSQSxRQUFBLE9BQUEsb0JBQ0EsV0FBQSxxQkFBQSxTQUFBLFlBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsbUJBQUEsV0FDQSxFQUFBLHNCQUVBLEVBQUEsU0FBQSxXQUNBLEdBQUEsR0FBQSxFQUFBLE1BQ0EsT0FBQSxLQUFBLEVBQUEsUUFBQSx1QkFDQSxhQUNBLElBQUEsRUFBQSxRQUFBLHNCQUNBLFlBQ0EsSUFBQSxFQUFBLFFBQUEscUJBQ0EsYUFDQSxJQUFBLEVBQUEsUUFBQSxrQkFDQSxVQUNBLElBQUEsRUFBQSxRQUFBLGdCQUNBLFFBQ0EsSUFBQSxFQUFBLFFBQUEsdUJBQ0EsVUFDQSxJQUFBLEVBQUEsUUFBQSxlQUNBLE9BRUEsT0N0QkEsUUFBQSxPQUFBLGlCQUNBLFdBQUEsWUFBQSxTQUFBLFlBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnc3Rvcmllc01vZHVsZScsIFtcclxuICAgICduZ1JvdXRlJyxcclxuICAgICduZ0Nvb2tpZXMnLFxyXG4gICAgJ3VpLmJvb3RzdHJhcCcsXHJcbiAgICAndWkuc29ydGFibGUnLFxyXG4gICAgJ2NvbmZpZ01vZHVsZScsXHJcbiAgICAnYm9keU1vZHVsZScsXHJcbiAgICAndG9wTWVudU1vZHVsZScsXHJcbiAgICAnc3RvcnlNb2R1bGUnLFxyXG4gICAgJ2NvbXBvc2l0ZUNsYXNzZXNNb2R1bGUnLFxyXG4gICAgJ2NvbXBvc2l0ZXNNb2R1bGUnLFxyXG4gICAgJ3J1bm5lck1vZHVsZScsXHJcbiAgICAnbG9naW5Nb2R1bGUnLFxyXG4gICAgJ3RvdXJNb2R1bGUnXHJcbl0pXHJcbiAgICAuc2VydmljZSgnVGNCZGRTZXJ2aWNlJywgZnVuY3Rpb24oJG1vZGFsLCAkaHR0cCwgJGxvY2F0aW9uLCAkcSkge1xyXG4gICAgICAgIHRoaXMub3BlbkNvbXBvc2l0ZUNsYXNzID0gZnVuY3Rpb24oY29tcG9zaXRlU3RlcFRleHQpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9jb21wb3NpdGVDbGFzc2VzL2NvbXBvc2l0ZUNsYXNzZXMudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjb21wb3NpdGVDbGFzc2VzQ3RybCcsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcG9zaXRlQ2xhc3NlczogZnVuY3Rpb24oJHJvdXRlLCAkaHR0cCwgJG1vZGFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmdldEpzb24oJy9ncm9vdnlDb21wb3NpdGVzJywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY29tcG9zaXRlU3RlcFRleHQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9zaXRlU3RlcFRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMubmV3Q29sbGVjdGlvbkl0ZW0gPSBmdW5jdGlvbihldmVudCwgY29sbGVjdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQud2hpY2ggPT09IDEzKSB7XHJcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLnB1c2goe30pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnJlbW92ZUNvbGxlY3Rpb25FbGVtZW50ID0gZnVuY3Rpb24oY29sbGVjdGlvbiwgaW5kZXgpIHtcclxuICAgICAgICAgICAgY29sbGVjdGlvbi5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5idXR0b25Dc3NDbGFzcyA9IGZ1bmN0aW9uKG5nTW9kZWxDb250cm9sbGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAnYnRuLXN1Y2Nlc3MnOiBuZ01vZGVsQ29udHJvbGxlci4kdmFsaWQsXHJcbiAgICAgICAgICAgICAgICAnYnRuLWRhbmdlcic6IG5nTW9kZWxDb250cm9sbGVyLiRpbnZhbGlkXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldFJ1bm5lclByb2dyZXNzQ3NzID0gZnVuY3Rpb24oaW5Qcm9ncmVzcykge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgJ3Byb2dyZXNzIHByb2dyZXNzLXN0cmlwZWQgYWN0aXZlJzogaW5Qcm9ncmVzcyxcclxuICAgICAgICAgICAgICAgICdwcm9ncmVzcyc6ICFpblByb2dyZXNzXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldFN0b3J5UnVubmVyU3RhdHVzVGV4dCA9IGZ1bmN0aW9uKGluUHJvZ3Jlc3MsIHN1Y2Nlc3MsIHBlbmRpbmdTdGVwc0xlbmd0aCkge1xyXG4gICAgICAgICAgICBpZiAoaW5Qcm9ncmVzcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdTdG9yeSBydW4gaXMgaW4gcHJvZ3Jlc3MnO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nU3RlcHNMZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdTdG9yeSBydW4gd2FzIHN1Y2Nlc3NmdWwgd2l0aCAnICsgcGVuZGluZ1N0ZXBzTGVuZ3RoICsgJyBwZW5kaW5nIHN0ZXBzJztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdTdG9yeSBydW4gd2FzIHN1Y2Nlc3NmdWwnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdTdG9yeSBydW4gZmFpbGVkJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5nZXRSdW5uZXJTdGF0dXNDc3MgPSBmdW5jdGlvbihpblByb2dyZXNzLCBzdWNjZXNzLCBwZW5kaW5nU3RlcHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICdwcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyLWluZm8nOiBpblByb2dyZXNzLFxyXG4gICAgICAgICAgICAgICAgJ3Byb2dyZXNzLWJhciBwcm9ncmVzcy1iYXItd2FybmluZyc6ICFpblByb2dyZXNzICYmIHN1Y2Nlc3MgJiYgcGVuZGluZ1N0ZXBzLFxyXG4gICAgICAgICAgICAgICAgJ3Byb2dyZXNzLWJhciBwcm9ncmVzcy1iYXItc3VjY2Vzcyc6ICFpblByb2dyZXNzICYmIHN1Y2Nlc3MgJiYgIXBlbmRpbmdTdGVwcyxcclxuICAgICAgICAgICAgICAgICdwcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyLWRhbmdlcic6ICFpblByb2dyZXNzICYmICFzdWNjZXNzXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm9wZW5SdW5uZXJQYXJhbWV0ZXJzTW9kYWwgPSBmdW5jdGlvbihzaG93R2V0QXBpLCAkc2NvcGUpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICByZXR1cm4gJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvcnVubmVyL3J1bm5lclBhcmFtcy50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3J1bm5lclBhcmFtc0N0cmwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uKCRyb3V0ZSwgJGh0dHAsICRtb2RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRKc29uKCcvc3RlcHMvY2xhc3Nlcy5qc29uJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBzaG93R2V0QXBpOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNob3dHZXRBcGk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBmZWF0dXJlczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7cnVuU3Rvcnk6ICRzY29wZS5mZWF0dXJlcy5ydW5TdG9yeX07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMub3BlbkRpciA9IGZ1bmN0aW9uKCRzY29wZSwgcGF0aCkge1xyXG4gICAgICAgICAgICBpZiAocGF0aCA9PT0gJy4uJykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRpcnMgPSAkc2NvcGUucm9vdFBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yb290UGF0aCA9IGRpcnMuc2xpY2UoMCwgZGlycy5sZW5ndGggLSAyKS5qb2luKCcvJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnJvb3RQYXRoICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yb290UGF0aCArPSAnLyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFN0b3JpZXMoJHNjb3BlLCAnJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFN0b3JpZXMoJHNjb3BlLCBwYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5nZXRTdG9yaWVzID0gZnVuY3Rpb24gKCRzY29wZSwgcGF0aCkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUucm9vdFBhdGggPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJvb3RQYXRoID0gJyc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJGh0dHAuZ2V0KCcvc3Rvcmllcy9saXN0Lmpzb24/cGF0aD0nICsgJHNjb3BlLnJvb3RQYXRoICsgcGF0aCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZpbGVzID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAgICAgICAgIGlmIChwYXRoICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yb290UGF0aCArPSBwYXRoICsgJy8nO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5vcGVuRXJyb3JNb2RhbChyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnN0ZXBUZXh0UGF0dGVybiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKC9eKEdpdmVufFdoZW58VGhlbikgLiskLyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm9wZW5Db25maXJtYXRpb25Nb2RhbCA9IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2Fzc2V0cy9odG1sL2NvbmZpcm1hdGlvbk1vZGFsLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbW9kYWxDdHJsJyxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuY2xhc3NOYW1lUGF0dGVybiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKC9eW2EtekEtWl8kXVthLXpBLVpcXGRfJF0qJC8pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5jc3NDbGFzcyA9IGZ1bmN0aW9uKG5nTW9kZWxDb250cm9sbGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAnaGFzLWVycm9yJzogbmdNb2RlbENvbnRyb2xsZXIuJGludmFsaWQsXHJcbiAgICAgICAgICAgICAgICAnaGFzLXN1Y2Nlc3MnOiBuZ01vZGVsQ29udHJvbGxlci4kdmFsaWQgJiYgbmdNb2RlbENvbnRyb2xsZXIuJGRpcnR5XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICB0aGlzLmRlbGV0ZVN0b3J5ID0gZnVuY3Rpb24ocGF0aCkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0ge3N0YXR1czogJ0RlbGV0ZSBTdG9yeScsIG1lc3NhZ2U6ICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgc3Rvcnk/J307XHJcbiAgICAgICAgICAgIHZhciBva01vZGFsID0gdGhpcy5vcGVuQ29uZmlybWF0aW9uTW9kYWwobWVzc2FnZSk7XHJcbiAgICAgICAgICAgIG9rTW9kYWwucmVzdWx0LnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5kZWxldGUoJy9zdG9yaWVzL3N0b3J5LycgKyBwYXRoKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvcGFnZS9zdG9yaWVzL25ldy8nKTtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCdPSycpO1xyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLm9wZW5FcnJvck1vZGFsKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCgnTk9LJyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoJ05PSycpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldEpzb24gPSBmdW5jdGlvbih1cmwsIGNhY2hlVHlwZSkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQodXJsLCB7Y2FjaGU6IGNhY2hlVHlwZX0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi5vcGVuRXJyb3JNb2RhbChyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm9wZW5FcnJvck1vZGFsID0gZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9lcnJvck1vZGFsLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbW9kYWxDdHJsJyxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc3RhcnRKb3lSaWRlID0gZnVuY3Rpb24oaWQsIHNjb3BlKSB7XHJcbiAgICAgICAgICAgICRodHRwLmdldCgnL2FwaS92MS9kYXRhLycgKyBpZCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgc2NvcGUuY29uZmlnSm95UmlkZSA9IHJlc3BvbnNlLmRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgIHNjb3BlLnRvdXJzID0gW3t9XTtcclxuICAgICAgICAgICAgICAgIHNjb3BlLnN0YXJ0Sm95UmlkZUZsYWcgPSB0cnVlO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHNjb3BlLnN0YXJ0Sm95UmlkZUZsYWcgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm9uRmluaXNoSm95UmlkZSA9IGZ1bmN0aW9uKHNjb3BlKSB7XHJcbiAgICAgICAgICAgIHNjb3BlLnN0YXJ0Sm95UmlkZUZsYWcgPSBmYWxzZTtcclxuICAgICAgICAgICAgc2NvcGUudG91cnMgPSBbXTtcclxuICAgICAgICB9O1xyXG4gICAgfSlcclxuICAgIC5jb250cm9sbGVyKCdtb2RhbEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRtb2RhbEluc3RhbmNlLCBkYXRhKSB7XHJcbiAgICAgICAgJHNjb3BlLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgICRzY29wZS5vayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoJ29rJyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdjb25maWdNb2R1bGUnLCBbXSlcclxuICAgIC5jb25maWcoZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XHJcbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xyXG4gICAgICAgICRyb3V0ZVByb3ZpZGVyXHJcbiAgICAgICAgICAgIC53aGVuKCcvcGFnZS90b3VyLycsIHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2Fzc2V0cy9odG1sL3RvdXIvdG91ci50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3RvdXJDdHJsJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAud2hlbignL3BhZ2Uvc3Rvcmllcy9uZXcvJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvc3Rvcnkvc3RvcnkudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzdG9yeUN0cmwnLFxyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3Rvcnk6IGZ1bmN0aW9uKCRodHRwLCAkbW9kYWwsIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldEpzb24oJy9zdG9yaWVzL3N0b3J5Lmpzb24nLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBzdGVwczogZnVuY3Rpb24oJGh0dHAsICRtb2RhbCwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0SnNvbignL3N0ZXBzL2xpc3QuanNvbicsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZ3Jvb3Z5Q29tcG9zaXRlczogZnVuY3Rpb24oJGh0dHAsICRtb2RhbCwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0SnNvbignL2dyb292eUNvbXBvc2l0ZXMnLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC53aGVuKCcvcGFnZS9zdG9yaWVzL25ldy86cGF0aConLCB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9zdG9yeS9zdG9yeS50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3N0b3J5Q3RybCcsXHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBzdG9yeTogZnVuY3Rpb24oJHJvdXRlLCAkaHR0cCwgJG1vZGFsLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRKc29uKCcvc3Rvcmllcy9zdG9yeS5qc29uP3BhdGg9JyArICRyb3V0ZS5jdXJyZW50LnBhcmFtcy5wYXRoICsgJy5zdG9yeScsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHN0ZXBzOiBmdW5jdGlvbigkaHR0cCwgJG1vZGFsLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRKc29uKCcvc3RlcHMvbGlzdC5qc29uJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBncm9vdnlDb21wb3NpdGVzOiBmdW5jdGlvbigkaHR0cCwgJG1vZGFsLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRKc29uKCcvZ3Jvb3Z5Q29tcG9zaXRlcycsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLndoZW4oJy9wYWdlL3N0b3JpZXMvdmlldy86cGF0aConLCB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9zdG9yeS9zdG9yeS50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3N0b3J5Q3RybCcsXHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBzdG9yeTogZnVuY3Rpb24oJHJvdXRlLCAkaHR0cCwgJG1vZGFsLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRKc29uKCcvc3Rvcmllcy9zdG9yeS5qc29uP3BhdGg9JyArICRyb3V0ZS5jdXJyZW50LnBhcmFtcy5wYXRoICsgJy5zdG9yeScsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHN0ZXBzOiBmdW5jdGlvbigkaHR0cCwgJG1vZGFsLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRKc29uKCcvc3RlcHMvbGlzdC5qc29uJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBncm9vdnlDb21wb3NpdGVzOiBmdW5jdGlvbigkaHR0cCwgJG1vZGFsLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRKc29uKCcvZ3Jvb3Z5Q29tcG9zaXRlcycsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZWxvYWRPblNlYXJjaDogZmFsc2VcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAud2hlbignL3BhZ2UvY29tcG9zaXRlcy86Y2xhc3NOYW1lKicsIHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2Fzc2V0cy9odG1sL2NvbXBvc2l0ZXMvY29tcG9zaXRlcy50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2NvbXBvc2l0ZXNDdHJsJyxcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvc2l0ZXNDbGFzczogZnVuY3Rpb24oJHJvdXRlLCAkaHR0cCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZU5hbWUgPSAkcm91dGUuY3VycmVudC5wYXJhbXMuY2xhc3NOYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gJy9ncm9vdnlDb21wb3NpdGVzLycgKyBmaWxlTmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCh1cmwsIHtjYWNoZTogZmFsc2V9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gZmlsZU5hbWUuc3Vic3RyaW5nKDAsIGZpbGVOYW1lLmxhc3RJbmRleE9mKCcuJykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogY2xhc3NOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBvc2l0ZXM6W3tzdGVwVGV4dDogJycsIGNvbXBvc2l0ZVN0ZXBzOiBbe31dfV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNOZXc6IHRydWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3RlcHM6IGZ1bmN0aW9uKCRodHRwLCAkbW9kYWwsIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldEpzb24oJy9zdGVwcy9saXN0Lmpzb24nLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAud2hlbignL3BhZ2UvcnVubmVyLycsIHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2Fzc2V0cy9odG1sL3J1bm5lci9ydW5uZXIudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdydW5uZXJDdHJsJyxcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uKCRyb3V0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3JlcG9ydHNQYXRoOiAkcm91dGUuY3VycmVudC5wYXJhbXMucGF0aH07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAud2hlbignL3BhZ2UvbG9naW4vJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvbG9naW4vbG9naW4udG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbkN0cmwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC53aGVuKCcvcGFnZS9sb2dpbldlbGNvbWUvJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvbG9naW4vbG9naW5XZWxjb21lLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbG9naW5XZWxjb21lQ3RybCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLm90aGVyd2lzZSh7XHJcbiAgICAgICAgICAgICAgICByZWRpcmVjdFRvOiAnL3BhZ2UvdG91cidcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2JvZHlNb2R1bGUnLCBbJ25nSm95UmlkZSddKVxyXG4gICAgLmNvbnRyb2xsZXIoJ2JvZHlDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsICRtb2RhbCwgJGxvY2F0aW9uLCBUY0JkZFNlcnZpY2UsICRyb290U2NvcGUpIHtcclxuICAgICAgICAkc2NvcGUub25GaW5pc2hKb3lSaWRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIFRjQmRkU2VydmljZS5vbkZpbmlzaEpveVJpZGUoJHNjb3BlKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zdGFydEpveVJpZGUgPSBmdW5jdGlvbihpZCkge1xyXG4gICAgICAgICAgICBUY0JkZFNlcnZpY2Uuc3RhcnRKb3lSaWRlKGlkLCAkc2NvcGUpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnN0YXJ0Sm95UmlkZU9uTG9hZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoJGxvY2F0aW9uLnNlYXJjaCgpLnRvdXIgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0YXJ0Sm95UmlkZSgndG91cl8nICsgJGxvY2F0aW9uLnNlYXJjaCgpLnRvdXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3QgbW9yZSB0aGFuIGNoZWNraW5nIHdoZXRoZXIgJG1vZGFsLm9wZW4gd2FzIGNhbGxlZFxyXG4gICAgICAgICRzY29wZS5vcGVuU3RvcnkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvc3Rvcmllcy50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3N0b3JpZXNDdHJsJyxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZmVhdHVyZXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge2RlbGV0ZVN0b3J5OiAkc2NvcGUuZmVhdHVyZXMuZGVsZXRlU3Rvcnl9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUub3Blbk1vZGFsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICgkbG9jYXRpb24uc2VhcmNoKCkub3Blbk1vZGFsICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtZW51ID0gJGxvY2F0aW9uLnNlYXJjaCgpLm9wZW5Nb2RhbDtcclxuICAgICAgICAgICAgICAgIGlmIChtZW51ID09PSAnb3BlblN0b3J5Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5vcGVuU3RvcnkoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmxvYWRGZWF0dXJlcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvZGF0YS9mZWF0dXJlcycpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5mZWF0dXJlcyA9IHJlc3BvbnNlLmRhdGEuZGF0YTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5vcGVuTW9kYWwoKTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmVhdHVyZXMgPSBbXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUubG9hZEZlYXR1cmVzKCk7XHJcbiAgICAgICAgJHNjb3BlLnN0YXJ0Sm95UmlkZU9uTG9hZCgpO1xyXG4gICAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdjb21wb3NpdGVDbGFzc2VzTW9kdWxlJywgW10pXHJcbiAgICAuY29udHJvbGxlcignY29tcG9zaXRlQ2xhc3Nlc0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbW9kYWxJbnN0YW5jZSwgY29tcG9zaXRlQ2xhc3NlcywgY29tcG9zaXRlU3RlcFRleHQsIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgICRzY29wZS5jb21wb3NpdGVDbGFzc2VzID0gY29tcG9zaXRlQ2xhc3NlcztcclxuICAgICAgICAkc2NvcGUuY29tcG9zaXRlU3RlcFRleHQgPSBjb21wb3NpdGVTdGVwVGV4dDtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jb21wb3NpdGVDbGFzc1VybCA9IGZ1bmN0aW9uKHBhY2thZ2VOYW1lLCBjbGFzc05hbWUpIHtcclxuICAgICAgICAgICAgdmFyIHVybCA9ICcvcGFnZS9jb21wb3NpdGVzLyc7XHJcbiAgICAgICAgICAgIGlmIChwYWNrYWdlTmFtZSAhPT0gdW5kZWZpbmVkICYmIHBhY2thZ2VOYW1lICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgdXJsICs9IHBhY2thZ2VOYW1lICsgJy4nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBjbGFzc05hbWVQYXJ0cztcclxuICAgICAgICAgICAgaWYgKGNsYXNzTmFtZS5pbmRleE9mKCcvJykgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lUGFydHMgPSBjbGFzc05hbWUuc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZVBhcnRzID0gY2xhc3NOYW1lLnNwbGl0KCdcXFxcJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdXJsICs9IGNsYXNzTmFtZVBhcnRzW2NsYXNzTmFtZVBhcnRzLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmNvbXBvc2l0ZVN0ZXBUZXh0ICE9PSB1bmRlZmluZWQgJiYgJHNjb3BlLmNvbXBvc2l0ZVN0ZXBUZXh0ICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgdXJsICs9ICc/c3RlcFRleHQ9JyArICRzY29wZS5jb21wb3NpdGVTdGVwVGV4dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZUNsYXNzVGV4dCA9IGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgY2xhc3NOYW1lUGFydHM7XHJcbiAgICAgICAgICAgIGlmIChjbGFzc05hbWUuaW5kZXhPZignLycpID49IDApIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZVBhcnRzID0gY2xhc3NOYW1lLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWVQYXJ0cyA9IGNsYXNzTmFtZS5zcGxpdCgnXFxcXCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciB0ZXh0ID0gY2xhc3NOYW1lUGFydHNbY2xhc3NOYW1lUGFydHMubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIGlmICh0ZXh0LmluZGV4T2YoJy4nKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5zdWJzdHIoMCwgdGV4dC5sYXN0SW5kZXhPZignLicpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGV4dDtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jbGFzc05hbWVQYXR0ZXJuID0gVGNCZGRTZXJ2aWNlLmNsYXNzTmFtZVBhdHRlcm47XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLmNzc0NsYXNzID0gVGNCZGRTZXJ2aWNlLmNzc0NsYXNzO1xyXG4gICAgICAgICRzY29wZS5kYXRhID0ge2NsYXNzOiAnJ307XHJcbiAgICB9KTsiLCJhbmd1bGFyLm1vZHVsZSgnY29tcG9zaXRlc01vZHVsZScsIFtdKVxyXG4gICAgLmNvbnRyb2xsZXIoJ2NvbXBvc2l0ZXNDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJG1vZGFsLCAkbG9jYXRpb24sICRjb29raWVTdG9yZSwgY29tcG9zaXRlc0NsYXNzLCBzdGVwcywgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHNjb3BlLmFkZE5ld0NvbXBvc2l0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuY29tcG9zaXRlID0ge3N0ZXBUZXh0OiAnJywgY29tcG9zaXRlU3RlcHM6IFt7fV19O1xyXG4gICAgICAgICAgICAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNvbXBvc2l0ZXMucHVzaCgkc2NvcGUuY29tcG9zaXRlKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5hZGRTdGVwVGV4dFBhcmFtID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICgkbG9jYXRpb24uc2VhcmNoKCkuc3RlcFRleHQgIT09IHVuZGVmaW5lZCAmJiAkbG9jYXRpb24uc2VhcmNoKCkuc3RlcFRleHQgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNvbXBvc2l0ZXMucHVzaCh7c3RlcFRleHQ6ICRsb2NhdGlvbi5zZWFyY2goKS5zdGVwVGV4dCwgY29tcG9zaXRlU3RlcHM6IFtdfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5hZGROZXdDb21wb3NpdGVTdGVwID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGUuY29tcG9zaXRlU3RlcHMucHVzaCh7fSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuc2V0TGFzdENvbXBvc2l0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoID0gJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5jb21wb3NpdGVzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGUgPSAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNvbXBvc2l0ZXNbbGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29tcG9zaXRlID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jb21wb3NpdGVzQ2xhc3MgPSBjb21wb3NpdGVzQ2xhc3M7XHJcbiAgICAgICAgJHNjb3BlLmFkZFN0ZXBUZXh0UGFyYW0oKTtcclxuICAgICAgICAkc2NvcGUub3JpZ2luYWxDb21wb3NpdGVzQ2xhc3MgPSBhbmd1bGFyLmNvcHkoY29tcG9zaXRlc0NsYXNzKTtcclxuICAgICAgICAkc2NvcGUuc2V0TGFzdENvbXBvc2l0ZSgpO1xyXG4gICAgICAgICRzY29wZS5zdGVwcyA9IHN0ZXBzO1xyXG4gICAgICAgICRzY29wZS5jbGFzc05hbWVQYXR0ZXJuID0gVGNCZGRTZXJ2aWNlLmNsYXNzTmFtZVBhdHRlcm47XHJcbiAgICAgICAgJHNjb3BlLnN0ZXBUZXh0UGF0dGVybiA9IFRjQmRkU2VydmljZS5zdGVwVGV4dFBhdHRlcm47XHJcbiAgICAgICAgJHNjb3BlLmNzc0NsYXNzID0gVGNCZGRTZXJ2aWNlLmNzc0NsYXNzO1xyXG4gICAgICAgICRzY29wZS5idXR0b25Dc3NDbGFzcyA9IGZ1bmN0aW9uKGNvbXBvc2l0ZUNsYXNzRm9ybSwgY29tcG9zaXRlRm9ybSkge1xyXG4gICAgICAgICAgICBpZiAoIWNvbXBvc2l0ZUNsYXNzRm9ybS4kdmFsaWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuYnV0dG9uQ3NzQ2xhc3MoY29tcG9zaXRlQ2xhc3NGb3JtKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuYnV0dG9uQ3NzQ2xhc3MoY29tcG9zaXRlRm9ybSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5vcGVuQ29tcG9zaXRlID0gZnVuY3Rpb24oY29tcG9zaXRlKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGUgPSBjb21wb3NpdGU7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUubmV3Q29sbGVjdGlvbkl0ZW0gPSBUY0JkZFNlcnZpY2UubmV3Q29sbGVjdGlvbkl0ZW07XHJcbiAgICAgICAgJHNjb3BlLnJlbW92ZUNvbGxlY3Rpb25FbGVtZW50ID0gVGNCZGRTZXJ2aWNlLnJlbW92ZUNvbGxlY3Rpb25FbGVtZW50O1xyXG4gICAgICAgICRzY29wZS5yZXZlcnRDb21wb3NpdGVzQ2xhc3MgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcyA9IGFuZ3VsYXIuY29weSgkc2NvcGUub3JpZ2luYWxDb21wb3NpdGVzQ2xhc3MpO1xyXG4gICAgICAgICAgICAkc2NvcGUuY29tcG9zaXRlID0gJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5jb21wb3NpdGVzWzBdO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhblJldmVydENvbXBvc2l0ZXNDbGFzcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gIWFuZ3VsYXIuZXF1YWxzKCRzY29wZS5jb21wb3NpdGVzQ2xhc3MsICRzY29wZS5vcmlnaW5hbENvbXBvc2l0ZXNDbGFzcyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuU2F2ZUNvbXBvc2l0ZXNDbGFzcyA9IGZ1bmN0aW9uKG5nTW9kZWxDb250cm9sbGVyKSB7XHJcbiAgICAgICAgICAgIHZhciBpc1ZhbGlkID0gbmdNb2RlbENvbnRyb2xsZXIuJHZhbGlkO1xyXG4gICAgICAgICAgICB2YXIgaXNVcGRhdGVkID0gIWFuZ3VsYXIuZXF1YWxzKCRzY29wZS5jb21wb3NpdGVzQ2xhc3MsICRzY29wZS5vcmlnaW5hbENvbXBvc2l0ZXNDbGFzcyk7XHJcbiAgICAgICAgICAgIHZhciBpc05ldyA9ICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuaXNOZXc7XHJcbiAgICAgICAgICAgIHJldHVybiAoaXNOZXcgfHwgaXNVcGRhdGVkKSAmJiBpc1ZhbGlkO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZXNBcmVWYWxpZCA9IGZ1bmN0aW9uKG5nTW9kZWxDb250cm9sbGVyKSB7XHJcbiAgICAgICAgICAgIHZhciBpc1ZhbGlkID0gbmdNb2RlbENvbnRyb2xsZXIuJHZhbGlkO1xyXG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5jb21wb3NpdGVzLCBmdW5jdGlvbihlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5zdGVwVGV4dCA9PT0gdW5kZWZpbmVkIHx8IGVsZW1lbnQuc3RlcFRleHQgPT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNWYWxpZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50LmNvbXBvc2l0ZVN0ZXBzID09PSB1bmRlZmluZWQgfHwgZWxlbWVudC5jb21wb3NpdGVTdGVwcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBpc1ZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gaXNWYWxpZDtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zYXZlQ29tcG9zaXRlc0NsYXNzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRodHRwLnB1dCgnL2dyb292eUNvbXBvc2l0ZXMnLCAkc2NvcGUuY29tcG9zaXRlc0NsYXNzKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRlbGV0ZUNvbXBvc2l0ZXNDbGFzc1dpdGhvdXRDb25maXJtYXRpb24oKTtcclxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvcGFnZS9jb21wb3NpdGVzLycgKyAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNsYXNzICsgJy5ncm9vdnknKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuaXNOZXcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5vcmlnaW5hbENvbXBvc2l0ZXNDbGFzcyA9IGFuZ3VsYXIuY29weSgkc2NvcGUuY29tcG9zaXRlc0NsYXNzKTtcclxuICAgICAgICAgICAgICAgICRjb29raWVTdG9yZS5wdXQoJ2NvbXBvc2l0ZUNsYXNzJywgJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5jbGFzcyk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICBUY0JkZFNlcnZpY2Uub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhbkRlbGV0ZUNvbXBvc2l0ZXNDbGFzcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKCEkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmlzTmV3KTtcclxuXHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUuZGVsZXRlQ29tcG9zaXRlc0NsYXNzV2l0aG91dENvbmZpcm1hdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5jbGFzcztcclxuICAgICAgICAgICAgdmFyIG9yaWdpbmFsQ2xhc3NOYW1lID0gJHNjb3BlLm9yaWdpbmFsQ29tcG9zaXRlc0NsYXNzLmNsYXNzO1xyXG4gICAgICAgICAgICBpZiAoY2xhc3NOYW1lICE9PSBvcmlnaW5hbENsYXNzTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZGVsZXRlKCcvZ3Jvb3Z5Q29tcG9zaXRlcy8nICsgb3JpZ2luYWxDbGFzc05hbWUpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5FcnJvck1vZGFsKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5kZWxldGVDb21wb3NpdGVzQ2xhc3MgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSB7c3RhdHVzOiAnRGVsZXRlIENvbXBvc2l0ZXMgQ2xhc3MnLCBtZXNzYWdlOiAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIGNvbXBvc2l0ZXMgY2xhc3M/J307XHJcbiAgICAgICAgICAgIHZhciBva01vZGFsID0gVGNCZGRTZXJ2aWNlLm9wZW5Db25maXJtYXRpb25Nb2RhbChtZXNzYWdlKTtcclxuICAgICAgICAgICAgb2tNb2RhbC5yZXN1bHQudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLmRlbGV0ZSgnL2dyb292eUNvbXBvc2l0ZXMvJyArICRzY29wZS5vcmlnaW5hbENvbXBvc2l0ZXNDbGFzcy5jbGFzcykudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBUY0JkZFNlcnZpY2Uub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBEbyBub3RoaW5nXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnNhdmVDb21wb3NpdGVzVGV4dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5pc05ldykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdDcmVhdGUgTmV3IENvbXBvc2l0ZXMnO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdVcGRhdGUgQ29tcG9zaXRlcyc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoJ2xvZ2luTW9kdWxlJywgW10pXHJcbiAgICAuY29udHJvbGxlcignbG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkbG9jYXRpb24sIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgICRzY29wZS5pbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUudXNlcnMgPSBbXTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jc3NDbGFzcyA9IFRjQmRkU2VydmljZS5jc3NDbGFzcztcclxuICAgICAgICAkc2NvcGUuYnV0dG9uQ3NzQ2xhc3MgPSBUY0JkZFNlcnZpY2UuYnV0dG9uQ3NzQ2xhc3M7XHJcbiAgICAgICAgJHNjb3BlLmNhbkxvZ2luID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLmxvZ2luRm9ybS4kdmFsaWQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFJlbW92ZSB3aGVuIHRoZSByZWFsIHNvbHV0aW9uIGlzIGRvbmVcclxuICAgICAgICAkc2NvcGUucmVnaXN0ZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnVzZXJzLnB1c2goJHNjb3BlLnVzZXIpO1xyXG4gICAgICAgICAgICAkc2NvcGUudXNlciA9IHt9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gVE9ETyBSZW1vdmUgd2hlbiB0aGUgcmVhbCBzb2x1dGlvbiBpcyBkb25lXHJcbiAgICAgICAgJHNjb3BlLmRlbGV0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLnVzZXJzLCBmdW5jdGlvbih1c2VyLCBpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHVzZXIudXNlcm5hbWUgPT09ICRzY29wZS51c2VyLnVzZXJuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVzZXJzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIgPSB7fTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgLy8gVE9ETyBTd2l0Y2ggdG8gdGhlIHJlYWwgSFRUUCByZXF1ZXN0XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUudXNlcnMsIGZ1bmN0aW9uKHVzZXIsIGluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodXNlci51c2VybmFtZSA9PT0gJHNjb3BlLnVzZXIudXNlcm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3BhZ2UvbG9naW5XZWxjb21lJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAkc2NvcGUudXNlci5ub3RSZWdpc3RlcmVkID0gdHJ1ZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5pbml0KCk7XHJcbiAgICB9KVxyXG4gICAgLmNvbnRyb2xsZXIoJ2xvZ2luV2VsY29tZUN0cmwnLCBmdW5jdGlvbigkc2NvcGUpIHtcclxuICAgIH0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgncnVubmVyTW9kdWxlJywgW10pXHJcbiAgICAuY29udHJvbGxlcigncnVubmVyQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJG1vZGFsLCAkaHR0cCwgJGxvY2F0aW9uLCAkdGltZW91dCwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0IG1vcmUgdGhhbiBjaGVja2luZyB3aGV0aGVyICRtb2RhbC5vcGVuIHdhcyBjYWxsZWRcclxuICAgICAgICAkc2NvcGUub3BlblJ1bm5lclNlbGVjdG9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9ydW5uZXIvcnVubmVyU2VsZWN0b3IudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdydW5uZXJTZWxlY3RvckN0cmwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge307XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5vcGVuUnVubmVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBydW5uZXJTZWxlY3RvciA9ICRzY29wZS5vcGVuUnVubmVyU2VsZWN0b3IoKTtcclxuICAgICAgICAgICAgaWYgKHJ1bm5lclNlbGVjdG9yICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJ1bm5lclNlbGVjdG9yLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3J5UGF0aHMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRpcnMuZm9yRWFjaChmdW5jdGlvbiAoZGlyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3J5UGF0aHMucHVzaCh7cGF0aDogZGlyLnBhdGggKyBcIi8qKi8qLnN0b3J5XCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLnN0b3JpZXMuZm9yRWFjaChmdW5jdGlvbiAoc3RvcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcnlQYXRocy5wdXNoKHtwYXRoOiBzdG9yeS5wYXRofSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5SdW5uZXJQYXJhbWV0ZXJzTW9kYWwodHJ1ZSwgJHNjb3BlKS5yZXN1bHQudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2xhc3NlcyA9IGRhdGEuY2xhc3NlcztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGlvbiA9IGRhdGEuYWN0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9ncm9vdnlDb21wb3NpdGVzJykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBncm9vdnlDb21wb3NpdGVzID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hcGlKc29uID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0b3J5UGF0aHM6IHN0b3J5UGF0aHMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NlczogY2xhc3NlcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBncm9vdnlDb21wb3NpdGVzOiBncm9vdnlDb21wb3NpdGVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ3J1bicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucnVuKCRzY29wZS5hcGlKc29uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0FwaSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd0FwaSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5ydW4gPSBmdW5jdGlvbihqc29uKSB7XHJcbiAgICAgICAgICAgIHZhciByZXBvcnRzUHJlZml4ID0gJy9hcGkvdjEvcmVwb3J0ZXJzL2dldC8nO1xyXG4gICAgICAgICAgICAkc2NvcGUucmVwb3J0c1VybCA9ICcnO1xyXG4gICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJTdWNjZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRzY29wZS5zaG93UnVubmVyUHJvZ3Jlc3MgPSB0cnVlO1xyXG4gICAgICAgICAgICAkaHR0cC5wb3N0KCcvcnVubmVyL3J1bi5qc29uJywganNvbikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gJ09LJykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZXBvcnRzVXJsID0gcmVwb3J0c1ByZWZpeCArIGRhdGEucmVwb3J0c1BhdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFJlcG9ydHMoZGF0YS5pZCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuc3RhdHVzID09PSAnRkFJTEVEJykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZXBvcnRzVXJsID0gcmVwb3J0c1ByZWZpeCArIGRhdGEucmVwb3J0c1BhdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBUY0JkZFNlcnZpY2Uub3BlbkVycm9yTW9kYWwoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5FcnJvck1vZGFsKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRSZXBvcnRzID0gZnVuY3Rpb24ocmVwb3J0c0lkKSB7XHJcbiAgICAgICAgICAgICRodHRwLmdldCgnL2FwaS92MS9yZXBvcnRlcnMvbGlzdC8nICsgcmVwb3J0c0lkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHMgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yZXBvcnRzLnN0YXR1cyAhPT0gJ2ZpbmlzaGVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93UnVubmVyUHJvZ3Jlc3MgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0UmVwb3J0cyhyZXBvcnRzSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIDE1MDAwKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dSdW5uZXJQcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UgPT09ICdJRCBpcyBOT1QgY29ycmVjdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFJlcG9ydHMocmVwb3J0c0lkKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAxNTAwMCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93UnVubmVyUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBUY0JkZFNlcnZpY2Uub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmdldFJ1bm5lclN0YXR1c0NzcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRSdW5uZXJTdGF0dXNDc3MoXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzLFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyxcclxuICAgICAgICAgICAgICAgICgkc2NvcGUucGVuZGluZ1N0ZXBzID4gMClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRTdG9yeVJ1bm5lclN0YXR1c1RleHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1N0b3JpZXMgcnVuIGlzIGluIHByb2dyZXNzJztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnU3RvcmllcyBydW4gaXMgZmluaXNoZWQnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0UnVubmVyUHJvZ3Jlc3NDc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0UnVubmVyUHJvZ3Jlc3NDc3MoJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUub25Mb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAkc2NvcGUuc2hvd1J1bm5lclByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRzY29wZS5wZW5kaW5nU3RlcHMgPSBbXTtcclxuICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHNVcmwgPSAnJztcclxuICAgICAgICAgICAgaWYgKCRsb2NhdGlvbi5zZWFyY2goKS5yZXBvcnRzSWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm9wZW5SdW5uZXIoKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXBvcnRzSWQgPSAkbG9jYXRpb24uc2VhcmNoKCkucmVwb3J0c0lkO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHNVcmwgPSAnL2FwaS92MS9yZXBvcnRlcnMvZ2V0LycgKyByZXBvcnRzSWQgKyAnL3ZpZXcvcmVwb3J0cy5odG1sJztcclxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRSZXBvcnRzKHJlcG9ydHNJZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHNjb3BlLnNob3dBcGkgPSBmYWxzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5hcGlVcmwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRsb2NhdGlvbi5wcm90b2NvbCgpICsgJzovLycgKyAkbG9jYXRpb24uaG9zdCgpICsgJzonICsgJGxvY2F0aW9uLnBvcnQoKSArICcvcnVubmVyL3J1bi5qc29uJztcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5vbkxvYWQoKTtcclxuICAgIH0pXHJcbiAgICAuY29udHJvbGxlcigncnVubmVyU2VsZWN0b3JDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJG1vZGFsLCAkbW9kYWxJbnN0YW5jZSwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHNjb3BlLmZpbGVzID0ge2RpcnM6IFtdLCBzdG9yaWVzOiBbXX07XHJcbiAgICAgICAgVGNCZGRTZXJ2aWNlLmdldFN0b3JpZXMoJHNjb3BlLCAnJyk7XHJcbiAgICAgICAgJHNjb3BlLm9wZW5EaXIgPSBmdW5jdGlvbihwYXRoKSB7XHJcbiAgICAgICAgICAgIFRjQmRkU2VydmljZS5vcGVuRGlyKCRzY29wZSwgcGF0aCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuY2VsUnVubmVyU2VsZWN0b3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLm9rUnVubmVyU2VsZWN0b3IgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkRmlsZXMgPSB7ZGlyczogW10sIHN0b3JpZXM6IFtdfTtcclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRzY29wZS5maWxlcy5kaXJzLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLnNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRGaWxlcy5kaXJzLnB1c2goe3BhdGg6ICRzY29wZS5yb290UGF0aCArIHZhbHVlLm5hbWV9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuZmlsZXMuc3RvcmllcywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5zZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkRmlsZXMuc3Rvcmllcy5wdXNoKHtwYXRoOiAkc2NvcGUucm9vdFBhdGggKyB2YWx1ZS5uYW1lICsgXCIuc3RvcnlcIn0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2Uoc2VsZWN0ZWRGaWxlcyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuYWxsb3dUb1ByZXZEaXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5yb290UGF0aCAhPT0gJyc7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuQ29udGludWUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGhhc1NlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuZmlsZXMuZGlycywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5zZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc1NlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICghaGFzU2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuZmlsZXMuc3RvcmllcywgZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLnNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc1NlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaGFzU2VsZWN0ZWQ7XHJcbiAgICAgICAgfTtcclxuICAgIH0pXHJcbiAgICAuY29udHJvbGxlcigncnVubmVyUGFyYW1zQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbEluc3RhbmNlLCAkY29va2llU3RvcmUsIGRhdGEsIHNob3dHZXRBcGksIFRjQmRkU2VydmljZSwgZmVhdHVyZXMpIHtcclxuICAgICAgICAkc2NvcGUub25Mb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5wYXJhbUFycmF5ID0gW107XHJcbiAgICAgICAgICAgICRzY29wZS5mZWF0dXJlcyA9IGZlYXR1cmVzO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNsYXNzZXMgPSBkYXRhLmNsYXNzZXM7XHJcbiAgICAgICAgJHNjb3BlLnNldFBhcmFtcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuY2xhc3Nlcy5mb3JFYWNoKGZ1bmN0aW9uKGNsYXNzRW50cnkpIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzRW50cnkucGFyYW1zLmZvckVhY2goZnVuY3Rpb24ocGFyYW1FbnRyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbUVudHJ5LnZhbHVlICE9PSB1bmRlZmluZWQgJiYgcGFyYW1FbnRyeS52YWx1ZSAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1FbnRyeS5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1FbnRyeS5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1FbnRyeS52YWx1ZSA9ICRjb29raWVTdG9yZS5nZXQoY2xhc3NFbnRyeS5mdWxsTmFtZSArIFwiLlwiICsgcGFyYW1FbnRyeS5rZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0NvdWxkIG5vdCByZXRyaWV2ZSBjb29raWUgJyArIGNsYXNzRW50cnkuZnVsbE5hbWUgKyBcIi5cIiArIHBhcmFtRW50cnkua2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cdFx0JHNjb3BlLmhhc09wdGlvbnMgPSBmdW5jdGlvbihvcHRpb25zKSB7XHJcblx0XHRcdGlmIChvcHRpb25zKSB7XHJcblx0XHRcdCAgcmV0dXJuIG9wdGlvbnMubGVuZ3RoID4gMDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0ICByZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcbiAgICAgICAgJHNjb3BlLmhhc1BhcmFtcyA9IGZ1bmN0aW9uKGNsYXNzRW50cnkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNsYXNzRW50cnkucGFyYW1zICE9PSB1bmRlZmluZWQgJiYgY2xhc3NFbnRyeS5wYXJhbXMubGVuZ3RoID4gMDtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5vayA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSh7YWN0aW9uOiAncnVuJywgY2xhc3NlczogJHNjb3BlLmNsYXNzZXN9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuZGlzbWlzcygnY2FuY2VsJyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuc2hvd0dldEFwaSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2hvd0dldEFwaTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRBcGkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2Uoe2FjdGlvbjogJ2FwaScsIGNsYXNzZXM6ICRzY29wZS5jbGFzc2VzfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUucGFyYW1FbGVtZW50SWQgPSBmdW5jdGlvbihjbGFzc05hbWUsIHBhcmFtS2V5KSB7XHJcbiAgICAgICAgICAgIHZhciBmb3JtYXR0ZWRDbGFzc05hbWUgPSBjbGFzc05hbWUuY2hhckF0KDApLnRvTG93ZXJDYXNlKCkgKyBjbGFzc05hbWUuc2xpY2UoMSk7XHJcbiAgICAgICAgICAgIHZhciBmb3JtYXR0ZWRQYXJhbUtleSA9IHBhcmFtS2V5LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcGFyYW1LZXkuc2xpY2UoMSk7XHJcbiAgICAgICAgICAgIHJldHVybiBmb3JtYXR0ZWRDbGFzc05hbWUgKyBmb3JtYXR0ZWRQYXJhbUtleTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zZXRQYXJhbXMoKTtcclxuICAgICAgICAkc2NvcGUub25GaW5pc2hKb3lSaWRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIFRjQmRkU2VydmljZS5vbkZpbmlzaEpveVJpZGUoJHNjb3BlKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zdGFydEpveVJpZGUgPSBmdW5jdGlvbihpZCkge1xyXG4gICAgICAgICAgICBUY0JkZFNlcnZpY2Uuc3RhcnRKb3lSaWRlKGlkLCAkc2NvcGUpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLm9uTG9hZCgpO1xyXG4gICAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdzdG9yeU1vZHVsZScsIFtdKVxyXG4gICAgLmNvbnRyb2xsZXIoJ3N0b3J5Q3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRtb2RhbCwgJGxvY2F0aW9uLCAkY29va2llU3RvcmUsICRxLCAkYW5jaG9yU2Nyb2xsLCAkdGltZW91dCwgc3RvcnksIHN0ZXBzLCBncm9vdnlDb21wb3NpdGVzLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAkc2NvcGUub25Mb2FkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5wZW5kaW5nU3RlcHMgPSBbXTtcclxuICAgICAgICAgICAgJHNjb3BlLnN0b3J5ID0gc3Rvcnk7XHJcbiAgICAgICAgICAgICRzY29wZS5zdGVwcyA9IHN0ZXBzO1xyXG4gICAgICAgICAgICAkc2NvcGUuZ3Jvb3Z5Q29tcG9zaXRlcyA9IGdyb292eUNvbXBvc2l0ZXM7XHJcbiAgICAgICAgICAgICRzY29wZS5zdGVwVHlwZXMgPSBbJ0dJVkVOJywgJ1dIRU4nLCAnVEhFTiddO1xyXG4gICAgICAgICAgICAkc2NvcGUuc3RvcnlGb3JtQ2xhc3MgPSAnY29sLW1kLTEyJztcclxuICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclN1Y2Nlc3MgPSB0cnVlO1xyXG4gICAgICAgICAgICAkc2NvcGUuZXhwYW5kUGFuZWxzKCk7XHJcbiAgICAgICAgICAgICRzY29wZS5vcmlnaW5hbFN0b3J5ID0gYW5ndWxhci5jb3B5KHN0b3J5KTtcclxuICAgICAgICAgICAgdmFyIHBhdGhBcnJheSA9ICRzY29wZS5zdG9yeS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgICAgICRzY29wZS5kaXJQYXRoID0gcGF0aEFycmF5LnNsaWNlKDAsIHBhdGhBcnJheS5sZW5ndGggLSAxKS5qb2luKCcvJyk7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuZGlyUGF0aCAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kaXJQYXRoICs9ICcvJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkc2NvcGUuc2V0QWN0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmICgkbG9jYXRpb24uc2VhcmNoKCkucmVwb3J0c0lkICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeUZvcm1DbGFzcyA9ICdjb2wtbWQtNic7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJDbGFzcyA9ICdjb2wtbWQtNic7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJWaXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5nZXRSZXBvcnRzKCRsb2NhdGlvbi5zZWFyY2goKS5yZXBvcnRzSWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkbG9jYXRpb24uc2VhcmNoKCkub3Blbk1vZGFsICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtb2RhbCA9ICRsb2NhdGlvbi5zZWFyY2goKS5vcGVuTW9kYWw7XHJcbiAgICAgICAgICAgICAgICBpZiAobW9kYWwgPT09ICdvcGVuUnVuU3RvcnknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9wZW5SdW5uZXJQYXJhbXMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnNldEFjdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLnN0b3J5Lm5hbWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aW9uID0gJ1BVVCc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aW9uID0gJ1BPU1QnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZXhwYW5kUGFuZWxzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBzY2VuYXJpb3NFeHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUucGFuZWxzRXhwYW5kZWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhbmVsc0V4cGFuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFuZWxzRXhwYW5kZWQgPSAhJHNjb3BlLnBhbmVsc0V4cGFuZGVkO1xyXG4gICAgICAgICAgICAgICAgc2NlbmFyaW9zRXhwYW5kZWQgPSAkc2NvcGUucGFuZWxzRXhwYW5kZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHNjb3BlLnBhbmVscyA9IHtcclxuICAgICAgICAgICAgICAgIHN0b3J5OiAkc2NvcGUucGFuZWxzRXhwYW5kZWQsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJHNjb3BlLnBhbmVsc0V4cGFuZGVkLFxyXG4gICAgICAgICAgICAgICAgbWV0YTogJHNjb3BlLnBhbmVsc0V4cGFuZGVkLFxyXG4gICAgICAgICAgICAgICAgbmFycmF0aXZlOiAkc2NvcGUucGFuZWxzRXhwYW5kZWQsXHJcbiAgICAgICAgICAgICAgICBnaXZlblN0b3JpZXM6ICRzY29wZS5wYW5lbHNFeHBhbmRlZCxcclxuICAgICAgICAgICAgICAgIGxpZmVjeWNsZTogJHNjb3BlLnBhbmVsc0V4cGFuZGVkLFxyXG4gICAgICAgICAgICAgICAgc2NlbmFyaW9zOiBzY2VuYXJpb3NFeHBhbmRlZFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNzc0NsYXNzID0gVGNCZGRTZXJ2aWNlLmNzc0NsYXNzO1xyXG4gICAgICAgICRzY29wZS5idXR0b25Dc3NDbGFzcyA9IFRjQmRkU2VydmljZS5idXR0b25Dc3NDbGFzcztcclxuICAgICAgICAkc2NvcGUuY2FuU2F2ZVN0b3J5ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBpc1ZhbGlkID0gJHNjb3BlLnN0b3J5Rm9ybS4kdmFsaWQ7XHJcbiAgICAgICAgICAgIHZhciBoYXNDaGFuZ2VkID0gIWFuZ3VsYXIuZXF1YWxzKCRzY29wZS5zdG9yeSwgJHNjb3BlLm9yaWdpbmFsU3RvcnkpO1xyXG4gICAgICAgICAgICByZXR1cm4gaXNWYWxpZCAmJiBoYXNDaGFuZ2VkO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnN0ZXBUZXh0UGF0dGVybiA9IFRjQmRkU2VydmljZS5zdGVwVGV4dFBhdHRlcm47XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLnNhdmVTdG9yeSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmNhblNhdmVTdG9yeSgpKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnkucGF0aCA9ICRzY29wZS5kaXJQYXRoICsgJHNjb3BlLnN0b3J5Lm5hbWUgKyBcIi5zdG9yeVwiO1xyXG4gICAgICAgICAgICAgICAgaWYgKCdQT1NUJyA9PT0gJHNjb3BlLmFjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdHJpcHBlZFBhdGhBcnJheSA9ICRzY29wZS5kaXJQYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmlwcGVkUGF0aCA9IHN0cmlwcGVkUGF0aEFycmF5LnNsaWNlKDAsIHN0cmlwcGVkUGF0aEFycmF5Lmxlbmd0aCAtIDEpLmpvaW4oJy8nKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RyaXBwZWRQYXRoICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpcHBlZFBhdGggKz0gJy8nO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KCcvc3Rvcmllcy9zdG9yeS5qc29uJywgJHNjb3BlLnN0b3J5KS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9wYWdlL3N0b3JpZXMvdmlldy8nICsgc3RyaXBwZWRQYXRoICsgJHNjb3BlLnN0b3J5Lm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3JpZ2luYWxTdG9yeSA9IGFuZ3VsYXIuY29weSgkc2NvcGUuc3RvcnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc3RvcnkubmFtZSAhPT0gJHNjb3BlLm9yaWdpbmFsU3RvcnkubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3Rvcnkub3JpZ2luYWxQYXRoID0gJHNjb3BlLm9yaWdpbmFsU3RvcnkucGF0aDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAucHV0KCcvc3Rvcmllcy9zdG9yeS5qc29uJywgJHNjb3BlLnN0b3J5KS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9yaWdpbmFsU3RvcnkgPSBhbmd1bGFyLmNvcHkoJHNjb3BlLnN0b3J5KTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9wZW5FcnJvck1vZGFsKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuUnVuU3RvcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUuc3RvcnlGb3JtLiR2YWxpZCAmJiAhJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcztcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5ydW5TdG9yeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCRzY29wZS5jYW5SdW5TdG9yeSgpKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2F2ZVN0b3J5KCk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUub3BlblJ1bm5lclBhcmFtcygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUub3BlblJ1bm5lclBhcmFtcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUub3BlblJ1bm5lck1vZGFsKCkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciBjbGFzc2VzID0gZGF0YS5jbGFzc2VzO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5Rm9ybUNsYXNzID0gJ2NvbC1tZC02JztcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckNsYXNzID0gJ2NvbC1tZC02JztcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBjbGFzc2VzLmZvckVhY2goZnVuY3Rpb24gKGNsYXNzRW50cnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc0VudHJ5LnBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uIChwYXJhbUVudHJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRjb29raWVTdG9yZS5wdXQoY2xhc3NFbnRyeS5mdWxsTmFtZSArIFwiLlwiICsgcGFyYW1FbnRyeS5rZXksIHBhcmFtRW50cnkudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB2YXIganNvbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICBzdG9yeVBhdGhzOiBbe3BhdGg6ICRzY29wZS5zdG9yeS5wYXRofV0sXHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NlczogY2xhc3NlcyxcclxuICAgICAgICAgICAgICAgICAgICBncm9vdnlDb21wb3NpdGVzOiAkc2NvcGUuZ3Jvb3Z5Q29tcG9zaXRlc1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICRodHRwLnBvc3QoJy9ydW5uZXIvcnVuLmpzb24nLCBqc29uKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRSZXBvcnRzKHJlc3BvbnNlLmRhdGEuaWQpO1xyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5vcGVuRXJyb3JNb2RhbChyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0UmVwb3J0cyA9IGZ1bmN0aW9uKHJlcG9ydHNJZCkge1xyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvcmVwb3J0ZXJzL2xpc3QvJyArIHJlcG9ydHNJZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcG9ydHNJZCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1cyAhPT0gJ2ZpbmlzaGVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCcxMTEnKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFJlcG9ydHMocmVwb3J0c0lkKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCA1MDAwKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJzIyMicpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXBvcnRzID0gcmVzcG9uc2UuZGF0YS5yZXBvcnRzO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZXBvcnRzID0gcmVwb3J0cztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVwb3J0cy5pZCA9IHJlcG9ydHNJZDtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2V0UGVuZGluZ1N0ZXBzKHJlcG9ydHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJTdWNjZXNzID0gJHNjb3BlLmlzU3RvcnlSdW5uZXJTdWNjZXNzKHJlcG9ydHMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLm1lc3NhZ2UgPT09ICdJRCBpcyBOT1QgY29ycmVjdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFJlcG9ydHMocmVwb3J0c0lkKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCA1MDAwKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIFRjQmRkU2VydmljZS5vcGVuRXJyb3JNb2RhbChyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuaXNTdG9yeVJ1bm5lclN1Y2Nlc3MgPSBmdW5jdGlvbihyZXBvcnRzKSB7XHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXBvcnRzLmZvckVhY2goZnVuY3Rpb24ocmVwb3J0KSB7XHJcbiAgICAgICAgICAgICAgICByZXBvcnQuc3RlcHMuZm9yRWFjaChmdW5jdGlvbihzdGVwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0ZXAuc3RhdHVzICE9PSAnc3VjY2Vzc2Z1bCcgJiYgc3RlcC5zdGF0dXMgIT09ICdwZW5kaW5nJyAmJiBzdGVwLnN0YXR1cyAhPT0gJ25vdFBlcmZvcm1lZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmdldFJlcG9ydFVybCA9IGZ1bmN0aW9uKHJlcG9ydHNJZCwgcmVwb3J0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnL2FwaS92MS9yZXBvcnRlcnMvZ2V0LycgKyByZXBvcnRzSWQgKyAnLycgKyByZXBvcnQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUub3BlblJ1bm5lck1vZGFsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2Uub3BlblJ1bm5lclBhcmFtZXRlcnNNb2RhbChmYWxzZSwgJHNjb3BlKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRSdW5uZXJQcm9ncmVzc0NzcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRSdW5uZXJQcm9ncmVzc0Nzcygkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRSdW5uZXJTdGF0dXNDc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0UnVubmVyU3RhdHVzQ3NzKFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyxcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclN1Y2Nlc3MsXHJcbiAgICAgICAgICAgICAgICAoJHNjb3BlLnBlbmRpbmdTdGVwcyA+IDApXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuc2V0UGVuZGluZ1N0ZXBzID0gZnVuY3Rpb24ocmVwb3J0cykge1xyXG4gICAgICAgICAgICAkc2NvcGUucGVuZGluZ1N0ZXBzID0gW107XHJcbiAgICAgICAgICAgIHJlcG9ydHMuZm9yRWFjaChmdW5jdGlvbihyZXBvcnQpIHtcclxuICAgICAgICAgICAgICAgIHJlcG9ydC5zdGVwcy5mb3JFYWNoKGZ1bmN0aW9uKHN0ZXApIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RlcC5zdGF0dXMgPT09ICdwZW5kaW5nJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUucGVuZGluZ1N0ZXBzLnB1c2goe3RleHQ6IHN0ZXAudGV4dH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5oYXNQZW5kaW5nU3RlcHMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5wZW5kaW5nU3RlcHMgIT09IHVuZGVmaW5lZCAmJiAkc2NvcGUucGVuZGluZ1N0ZXBzLmxlbmd0aCA+IDA7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0U3RvcnlSdW5uZXJTdGF0dXNUZXh0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldFN0b3J5UnVubmVyU3RhdHVzVGV4dChcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MsXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJTdWNjZXNzLFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBlbmRpbmdTdGVwcy5sZW5ndGhcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5yZW1vdmVDb2xsZWN0aW9uRWxlbWVudCA9IFRjQmRkU2VydmljZS5yZW1vdmVDb2xsZWN0aW9uRWxlbWVudDtcclxuICAgICAgICAkc2NvcGUuYWRkRWxlbWVudCA9IGZ1bmN0aW9uIChjb2xsZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGNvbGxlY3Rpb24ucHVzaCh7fSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuYWRkU2NlbmFyaW9FbGVtZW50ID0gZnVuY3Rpb24gKGNvbGxlY3Rpb24pIHtcclxuICAgICAgICAgICAgY29sbGVjdGlvbi5wdXNoKHt0aXRsZTogJycsIG1ldGE6IFtdLCBzdGVwczogW10sIGV4YW1wbGVzVGFibGU6ICcnfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUucmV2ZXJ0U3RvcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5zdG9yeSA9IGFuZ3VsYXIuY29weSgkc2NvcGUub3JpZ2luYWxTdG9yeSk7XHJcbiAgICAgICAgICAgICRzY29wZS5zdG9yeUZvcm0uJHNldFByaXN0aW5lKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuUmV2ZXJ0U3RvcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhYW5ndWxhci5lcXVhbHMoJHNjb3BlLnN0b3J5LCAkc2NvcGUub3JpZ2luYWxTdG9yeSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuRGVsZXRlU3RvcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUuYWN0aW9uID09PSAnUFVUJyAmJiAhJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5kZWxldGVTdG9yeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSAkc2NvcGUuZGlyUGF0aCArICRzY29wZS5zdG9yeS5uYW1lICsgJy5zdG9yeSc7XHJcbiAgICAgICAgICAgIFRjQmRkU2VydmljZS5kZWxldGVTdG9yeShwYXRoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zdGVwRW50ZXJLZXkgPSBUY0JkZFNlcnZpY2UubmV3Q29sbGVjdGlvbkl0ZW07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLmNsaWNrUGVuZGluZ1N0ZXAgPSBmdW5jdGlvbihzdGVwVGV4dCkge1xyXG4gICAgICAgICAgICB2YXIgY29tcG9zaXRlQ2xhc3MgPSAkY29va2llU3RvcmUuZ2V0KFwiY29tcG9zaXRlQ2xhc3NcIik7XHJcbiAgICAgICAgICAgIGlmIChjb21wb3NpdGVDbGFzcyA9PT0gdW5kZWZpbmVkIHx8IGNvbXBvc2l0ZUNsYXNzID09PSAnJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5vcGVuQ29tcG9zaXRlQ2xhc3Moc3RlcFRleHQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRsb2NhdGlvbi5zZWFyY2goJ3N0ZXBUZXh0Jywgc3RlcFRleHQpLnBhdGgoJy9wYWdlL2NvbXBvc2l0ZXMvJyArIGNvbXBvc2l0ZUNsYXNzICsgJy5ncm9vdnknKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLm9wZW5FcnJvck1vZGFsID0gVGNCZGRTZXJ2aWNlLm9wZW5FcnJvck1vZGFsO1xyXG4gICAgICAgICRzY29wZS5vbkxvYWQoKTtcclxuICAgIH0pXHJcbiAgICAuY29udHJvbGxlcignc3Rvcmllc0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbW9kYWwsICRtb2RhbEluc3RhbmNlLCAkbG9jYXRpb24sICRxLCBUY0JkZFNlcnZpY2UsIGZlYXR1cmVzKSB7XHJcbiAgICAgICAgVGNCZGRTZXJ2aWNlLmdldFN0b3JpZXMoJHNjb3BlLCAnJyk7XHJcbiAgICAgICAgJHNjb3BlLmZlYXR1cmVzID0gZmVhdHVyZXM7XHJcbiAgICAgICAgJHNjb3BlLm9wZW5EaXIgPSBmdW5jdGlvbihwYXRoKSB7XHJcbiAgICAgICAgICAgIFRjQmRkU2VydmljZS5vcGVuRGlyKCRzY29wZSwgcGF0aCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5vcGVuU3RvcnkgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5vbkZpbmlzaEpveVJpZGUoKTtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoKTtcclxuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9wYWdlL3N0b3JpZXMvdmlldy8nICsgJHNjb3BlLnJvb3RQYXRoICsgbmFtZSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuYWxsb3dUb1ByZXZEaXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5yb290UGF0aCAhPT0gJyc7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUuZGVsZXRlU3RvcnkgPSBmdW5jdGlvbihuYW1lLCBpbmRleCkge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9ICRzY29wZS5yb290UGF0aCArIG5hbWUgKyAnLnN0b3J5JztcclxuICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLmRlbGV0ZVN0b3J5KHBhdGgpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsZXMuc3Rvcmllcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5jcmVhdGVEaXJlY3RvcnkgPSBmdW5jdGlvbihwYXRoKSB7XHJcbiAgICAgICAgICAgIHZhciBqc29uID0gJ3tcInBhdGhcIjogXCInICsgJHNjb3BlLnJvb3RQYXRoICsgcGF0aCArICdcIn0nO1xyXG4gICAgICAgICAgICAkaHR0cC5wb3N0KCcvc3Rvcmllcy9kaXIuanNvbicsIGpzb24pLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsZXMuZGlycy5wdXNoKHtuYW1lOiBwYXRofSk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICBUY0JkZFNlcnZpY2Uub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLm9uRmluaXNoSm95UmlkZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBUY0JkZFNlcnZpY2Uub25GaW5pc2hKb3lSaWRlKCRzY29wZSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuc3RhcnRKb3lSaWRlID0gZnVuY3Rpb24oaWQpIHtcclxuICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLnN0YXJ0Sm95UmlkZShpZCwgJHNjb3BlKTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoJ3RvcE1lbnVNb2R1bGUnLCBbXSlcclxuICAgIC5jb250cm9sbGVyKCd0b3BNZW51Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAkc2NvcGUub3BlbkNvbXBvc2l0ZUNsYXNzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIFRjQmRkU2VydmljZS5vcGVuQ29tcG9zaXRlQ2xhc3MoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRUaXRsZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9ICRsb2NhdGlvbi5wYXRoKCk7XHJcbiAgICAgICAgICAgIGlmIChwYXRoLmluZGV4T2YoJy9wYWdlL3N0b3JpZXMvdmlldy8nKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdWaWV3IFN0b3J5JztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXRoLmluZGV4T2YoJy9wYWdlL3N0b3JpZXMvbmV3LycpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ05ldyBTdG9yeSc7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGF0aC5pbmRleE9mKCcvcGFnZS9jb21wb3NpdGVzLycpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0NvbXBvc2l0ZXMnO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdGguaW5kZXhPZignL3BhZ2UvcmVwb3J0cy8nKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdSZXBvcnRzJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXRoLmluZGV4T2YoJy9wYWdlL2xvZ2luLycpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0xvZ2luJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXRoLmluZGV4T2YoJy9wYWdlL2xvZ2luV2VsY29tZS8nKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdXZWxjb21lJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXRoLmluZGV4T2YoJy9wYWdlL3RvdXIvJykgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnSG9tZSc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCd0b3VyTW9kdWxlJywgW10pXHJcbiAgICAuY29udHJvbGxlcigndG91ckN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbG9jYXRpb24pIHtcclxuICAgIH0pO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=