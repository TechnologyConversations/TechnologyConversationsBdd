angular.module("storiesModule",["ngRoute","ngCookies","ui.bootstrap","ui.sortable","configModule","bodyModule","topMenuModule","storyModule","compositesModule","runnerModule","loginModule","tourModule"]).service("TcBddService",["$modal","$http","$location","$q",function(o,e,t,s){this.openCompositeClass=function(e){var t=this;o.open({templateUrl:"/assets/html/composites/compositeClasses.tmpl.html",controller:"compositeClassesCtrl",resolve:{compositeClasses:["$route","$http","$modal",function(){return t.getJson("/groovyComposites",!1)}],compositeStepText:function(){return e}}})},this.newCollectionItem=function(o,e){13===o.which&&e.push({})},this.removeCollectionElement=function(o,e){o.splice(e,1)},this.buttonCssClass=function(o){return{"btn-success":o.$valid,"btn-danger":o.$invalid}},this.getRunnerProgressCss=function(o){return{"progress progress-striped active":o,progress:!o}},this.getStoryRunnerStatusText=function(o,e,t){return o?"Story run is in progress":e?t>0?"Story run was successful with "+t+" pending steps":"Story run was successful":"Story run failed"},this.getRunnerStatusCss=function(o,e,t){return{"progress-bar progress-bar-info":o,"progress-bar progress-bar-warning":!o&&e&&t,"progress-bar progress-bar-success":!o&&e&&!t,"progress-bar progress-bar-danger":!o&&!e}},this.openRunnerParametersModal=function(e,t){var s=this;return o.open({templateUrl:"/assets/html/runner/runnerParams.tmpl.html",controller:"runnerParamsCtrl",resolve:{data:["$route","$http","$modal",function(){return s.getJson("/steps/classes.json",!0)}],showGetApi:function(){return e},features:function(){return{runStory:t.features.runStory}}}})},this.openDir=function(o,e){if(".."===e){var t=o.rootPath.split("/");o.rootPath=t.slice(0,t.length-2).join("/"),""!==o.rootPath&&(o.rootPath+="/"),this.getStories(o,"")}else this.getStories(o,e)},this.getStories=function(o,t){var s=this;void 0===o.rootPath&&(o.rootPath=""),e.get("/stories/list.json?path="+o.rootPath+t).then(function(e){o.files=e.data,""!==t&&(o.rootPath+=t+"/")},function(o){s.openErrorModal(o.data)})},this.stepTextPattern=function(){return/^(Given|When|Then) .+$/},this.openConfirmationModal=function(e){return o.open({templateUrl:"/assets/html/confirmationModal.tmpl.html",controller:"modalCtrl",resolve:{data:function(){return e}}})},this.classNamePattern=function(){return/^[a-zA-Z_$][a-zA-Z\d_$]*$/},this.cssClass=function(o){return{"has-error":o.$invalid,"has-success":o.$valid&&o.$dirty}},this.deleteStory=function(o){var n=this,r=s.defer(),a={status:"Delete Story",message:"Are you sure you want to delete this story?"},i=this.openConfirmationModal(a);return i.result.then(function(){e.delete("/stories/story/"+o).then(function(){t.path("/page/stories/new/"),r.resolve("OK")},function(o){n.openErrorModal(o.data.meta),r.reject("NOK")})},function(){r.reject("NOK")}),r.promise},this.getJson=function(o,t){var s=this;return e.get(o,{cache:t}).then(function(o){return o.data},function(o){s.openErrorModal(o.data)})},this.openErrorModal=function(e){o.open({templateUrl:"/assets/html/errorModal.tmpl.html",controller:"modalCtrl",resolve:{data:function(){return e}}})},this.startJoyRide=function(o,t){e.get("/api/v1/data/"+o).then(function(o){t.configJoyRide=o.data.data,t.tours=[{}],t.startJoyRideFlag=!0},function(){t.startJoyRideFlag=!1})},this.onFinishJoyRide=function(o){o.startJoyRideFlag=!1,o.tours=[]},this.startJoyRideOnLoad=function(o,e){void 0!==o.search().tour&&(this.startJoyRide("tour_"+o.search().tour,e),o.search("tour",void 0))}}]).controller("modalCtrl",["$scope","$modalInstance","data",function(o,e,t){o.data=t,o.ok=function(){e.close("ok")},o.cancel=function(){e.dismiss("cancel")}}]),angular.module("configModule",[]).config(["$routeProvider","$locationProvider",function(o,e){e.html5Mode(!0),o.when("/page/tour/",{templateUrl:"/assets/html/tour/tour.tmpl.html",controller:"tourCtrl",reloadOnSearch:!1}).when("/page/stories/new/",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",reloadOnSearch:!1,resolve:{story:["$http","$modal","TcBddService",function(o,e,t){return t.getJson("/stories/story.json",!1)}],steps:["$http","$modal","TcBddService",function(o,e,t){return t.getJson("/steps/list.json",!0)}],groovyComposites:["$http","$modal","TcBddService",function(o,e,t){return t.getJson("/groovyComposites",!0)}]}}).when("/page/stories/new/:path*",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",reloadOnSearch:!1,resolve:{story:["$route","$http","$modal","TcBddService",function(o,e,t,s){return s.getJson("/stories/story.json?path="+o.current.params.path+".story",!1)}],steps:["$http","$modal","TcBddService",function(o,e,t){return t.getJson("/steps/list.json",!0)}],groovyComposites:["$http","$modal","TcBddService",function(o,e,t){return t.getJson("/groovyComposites",!0)}]}}).when("/page/stories/view/:path*",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",reloadOnSearch:!1,resolve:{story:["$route","$http","$modal","TcBddService",function(o,e,t,s){return s.getJson("/stories/story.json?path="+o.current.params.path+".story",!1)}],steps:["$http","$modal","TcBddService",function(o,e,t){return t.getJson("/steps/list.json",!0)}],groovyComposites:["$http","$modal","TcBddService",function(o,e,t){return t.getJson("/groovyComposites",!0)}]}}).when("/page/composites/:className*",{templateUrl:"/assets/html/composites/composites.tmpl.html",controller:"compositesCtrl",reloadOnSearch:!1,resolve:{compositesClass:["$route","$http",function(o,e){var t=o.current.params.className,s="/groovyComposites/"+t;return e.get(s,{cache:!1}).then(function(o){return o.data},function(){var o=t.substring(0,t.lastIndexOf("."));return{"class":o,composites:[{stepText:"",compositeSteps:[{}]}],isNew:!0}})}],steps:["$http","$modal","TcBddService",function(o,e,t){return t.getJson("/steps/list.json",!1)}]}}).when("/page/runner/",{templateUrl:"/assets/html/runner/runner.tmpl.html",controller:"runnerCtrl",reloadOnSearch:!1,resolve:{data:["$route",function(o){return{reportsPath:o.current.params.path}}]}}).when("/page/login/",{templateUrl:"/assets/html/login/login.tmpl.html",controller:"loginCtrl",reloadOnSearch:!1}).when("/page/loginWelcome/",{templateUrl:"/assets/html/login/loginWelcome.tmpl.html",controller:"loginWelcomeCtrl",reloadOnSearch:!1}).otherwise({redirectTo:"/page/tour"})}]),angular.module("bodyModule",["ngJoyRide"]).controller("bodyCtrl",["$scope","$http","$modal","$location","TcBddService","$rootScope",function(o,e,t,s,n){o.openStory=function(){t.open({templateUrl:"/assets/html/stories.tmpl.html",controller:"storiesCtrl",resolve:{data:function(){return{}},features:function(){return{deleteStory:o.features.deleteStory}}}})},o.openCompositeClass=function(){n.openCompositeClass()},o.openModal=function(){if(void 0!==s.search().openModal){var e=s.search().openModal;"openStory"===e?o.openStory():"openCompositeClass"===e&&o.openCompositeClass()}},o.loadFeatures=function(){e.get("/api/v1/data/features").then(function(e){o.features=e.data.data,o.openModal()},function(){o.features=[]})},o.loadFeatures()}]),angular.module("compositesModule",[]).controller("compositesCtrl",["$scope","$http","$modal","$location","$cookieStore","compositesClass","steps","TcBddService",function(o,e,t,s,n,r,a,i){o.onLoad=function(){o.compositesClass=r,o.addStepTextParam(),o.originalCompositesClass=angular.copy(r),o.setLastComposite(),o.steps=a,o.stepTextPattern=i.stepTextPattern,o.cssClass=i.cssClass,i.startJoyRideOnLoad(s,o)},o.classNamePattern=function(){return i.classNamePattern()},o.addNewComposite=function(){o.composite={stepText:"",compositeSteps:[{}]},o.compositesClass.composites.push(o.composite)},o.addStepTextParam=function(){void 0!==s.search().stepText&&""!==s.search().stepText&&o.compositesClass.composites.push({stepText:s.search().stepText,compositeSteps:[]})},o.addNewCompositeStep=function(){o.composite.compositeSteps.push({})},o.setLastComposite=function(){if(void 0!==o.compositesClass){var e=o.compositesClass.composites.length;o.composite=o.compositesClass.composites[e-1]}else o.composite={}},o.buttonCssClass=function(o,e){return o.$valid?i.buttonCssClass(e):i.buttonCssClass(o)},o.openComposite=function(e){o.composite=e},o.newCollectionItem=i.newCollectionItem,o.removeCollectionElement=i.removeCollectionElement,o.revertCompositesClass=function(){o.compositesClass=angular.copy(o.originalCompositesClass),o.composite=o.compositesClass.composites[0]},o.canRevertCompositesClass=function(){return!angular.equals(o.compositesClass,o.originalCompositesClass)},o.canSaveCompositesClass=function(e){var t=e.$valid,s=!angular.equals(o.compositesClass,o.originalCompositesClass),n=o.compositesClass.isNew;return(n||s)&&t},o.compositesAreValid=function(e){var t=e.$valid;return angular.forEach(o.compositesClass.composites,function(o){void 0===o.stepText||""===o.stepText?t=!1:(void 0===o.compositeSteps||0===o.compositeSteps.length)&&(t=!1)}),t},o.saveCompositesClass=function(){e.put("/groovyComposites",o.compositesClass).then(function(){o.deleteCompositesClassWithoutConfirmation(),s.path("/page/composites/"+o.compositesClass.class+".groovy"),o.compositesClass.isNew=!1,o.originalCompositesClass=angular.copy(o.compositesClass),n.put("compositeClass",o.compositesClass.class)},function(o){i.openErrorModal(o.data)})},o.canDeleteCompositesClass=function(){return!o.compositesClass.isNew},o.deleteCompositesClassWithoutConfirmation=function(){var t=o.compositesClass.class,s=o.originalCompositesClass.class;t!==s&&e.delete("/groovyComposites/"+s).then(function(){},function(o){i.openErrorModal(o.data)})},o.deleteCompositesClass=function(){var t={status:"Delete Composites Class",message:"Are you sure you want to delete this composites class?"},n=i.openConfirmationModal(t);n.result.then(function(){e.delete("/groovyComposites/"+o.originalCompositesClass.class).then(function(){s.path("/")},function(o){i.openErrorModal(o.data)})},function(){})},o.saveCompositesText=function(){return o.compositesClass.isNew?"Create New Composites":"Update Composites"},o.onFinishJoyRide=function(){i.onFinishJoyRide(o)},o.startJoyRide=function(e){i.startJoyRide(e,o)},o.onLoad()}]).controller("compositeClassesCtrl",["$scope","$http","$modalInstance","$location","compositeClasses","compositeStepText","TcBddService",function(o,e,t,s,n,r,a){o.onLoad=function(){o.compositeClasses=n,o.compositeStepText=r,o.data={"class":""},a.startJoyRideOnLoad(s,o)},o.close=function(){t.close()},o.compositeClassUrl=function(e,t){var s="/page/composites/";void 0!==e&&""!==e&&(s+=e+".");var n;return n=t.indexOf("/")>=0?t.split("/"):t.split("\\"),s+=n[n.length-1],void 0!==o.compositeStepText&&""!==o.compositeStepText&&(s+="?stepText="+o.compositeStepText),s},o.compositeClassText=function(o){var e;e=o.indexOf("/")>=0?o.split("/"):o.split("\\");var t=e[e.length-1];return t.indexOf(".")>=0&&(t=t.substr(0,t.lastIndexOf("."))),t},o.classNamePattern=function(){return a.classNamePattern()},o.cssClass=a.cssClass,o.onFinishJoyRide=function(){a.onFinishJoyRide(o)},o.startJoyRide=function(e){a.startJoyRide(e,o)},o.onLoad()}]),angular.module("loginModule",[]).controller("loginCtrl",["$scope","$location","TcBddService",function(o,e,t){o.init=function(){o.users=[]},o.cssClass=t.cssClass,o.buttonCssClass=t.buttonCssClass,o.canLogin=function(){return o.loginForm.$valid},o.register=function(){o.users.push(o.user),o.user={}},o.delete=function(){angular.forEach(o.users,function(e,t){e.username===o.user.username&&(o.users.splice(t,1),o.user={})})},o.login=function(){angular.forEach(o.users,function(t){t.username===o.user.username&&e.path("/page/loginWelcome")}),o.user.notRegistered=!0},o.init()}]).controller("loginWelcomeCtrl",["$scope",function(){}]),angular.module("runnerModule",[]).controller("runnerCtrl",["$scope","$modal","$http","$location","$timeout","TcBddService",function(o,e,t,s,n,r){o.openRunnerSelector=function(){return e.open({templateUrl:"/assets/html/runner/runnerSelector.tmpl.html",controller:"runnerSelectorCtrl",resolve:{data:function(){return{}}}})},o.openRunner=function(){var e=o.openRunnerSelector();void 0!==e&&e.result.then(function(e){var s=[];e.dirs.forEach(function(o){s.push({path:o.path+"/**/*.story"})}),e.stories.forEach(function(o){s.push({path:o.path})}),r.openRunnerParametersModal(!0,o).result.then(function(e){var n=e.classes,r=e.action;t.get("/groovyComposites").then(function(e){var t=e.data;o.apiJson={storyPaths:s,classes:n,groovyComposites:t},"run"===r?(o.run(o.apiJson),o.showApi=!1):o.showApi=!0})})})},o.run=function(e){var s="/api/v1/reporters/get/";o.reportsUrl="",o.storyRunnerSuccess=!1,o.showRunnerProgress=!0,t.post("/runner/run.json",e).then(function(e){var t=e.data;"OK"===t.status?(o.reportsUrl=s+t.reportsPath,o.storyRunnerInProgress=!0,o.getReports(t.id)):"FAILED"===t.status?(o.reportsUrl=s+t.reportsPath,o.storyRunnerInProgress=!1):r.openErrorModal(t)},function(e){o.storyRunnerInProgress=!1,o.storyRunnerSuccess=!1,r.openErrorModal(e.data)})},o.getReports=function(e){t.get("/api/v1/reporters/list/"+e).then(function(t){o.reports=t.data,"finished"!==o.reports.status?(o.showRunnerProgress=!0,n(function(){o.getReports(e)},15e3)):o.showRunnerProgress=!1},function(t){void 0!==t.data.meta&&"ID is NOT correct"===t.data.meta.message?n(function(){o.getReports(e)},15e3):(o.showRunnerProgress=!1,r.openErrorModal(t.data))})},o.getRunnerStatusCss=function(){return r.getRunnerStatusCss(o.storyRunnerInProgress,o.storyRunnerSuccess,o.pendingSteps>0)},o.getStoryRunnerStatusText=function(){return o.storyRunnerInProgress?"Stories run is in progress":"Stories run is finished"},o.getRunnerProgressCss=function(){return r.getRunnerProgressCss(o.storyRunnerInProgress)},o.onLoad=function(){if(o.storyRunnerInProgress=!1,o.storyRunnerSuccess=!1,o.showRunnerProgress=!1,o.pendingSteps=[],o.reportsUrl="",void 0===s.search().reportsId)o.openRunner();else{var e=s.search().reportsId;o.reportsUrl="/api/v1/reporters/get/"+e+"/view/reports.html",o.getReports(e)}o.showApi=!1},o.apiUrl=function(){return s.protocol()+"://"+s.host()+":"+s.port()+"/runner/run.json"},o.onLoad()}]).controller("runnerSelectorCtrl",["$scope","$http","$modal","$modalInstance","$location","TcBddService",function(o,e,t,s,n,r){o.onLoad=function(){o.files={dirs:[],stories:[]},r.startJoyRideOnLoad(n,o)},r.getStories(o,""),o.openDir=function(e){r.openDir(o,e)},o.cancelRunnerSelector=function(){s.dismiss("cancel")},o.okRunnerSelector=function(){var e={dirs:[],stories:[]};angular.forEach(o.files.dirs,function(t){t.selected&&e.dirs.push({path:o.rootPath+t.name})}),angular.forEach(o.files.stories,function(t){t.selected&&e.stories.push({path:o.rootPath+t.name+".story"})}),s.close(e)},o.allowToPrevDir=function(){return""!==o.rootPath},o.canContinue=function(){var e=!1;return angular.forEach(o.files.dirs,function(o){o.selected&&(e=!0)}),e||angular.forEach(o.files.stories,function(o){o.selected&&(e=!0)}),e},o.onFinishJoyRide=function(){r.onFinishJoyRide(o)},o.startJoyRide=function(e){r.startJoyRide(e,o)},o.onLoad()}]).controller("runnerParamsCtrl",["$scope","$modalInstance","$cookieStore","$location","data","showGetApi","TcBddService","features",function(o,e,t,s,n,r,a,i){o.onLoad=function(){o.paramArray=[],o.features=i,a.startJoyRideOnLoad(s,o)},o.classes=n.classes,o.setParams=function(){o.classes.forEach(function(o){o.params.forEach(function(e){if(void 0!==e.value&&""!==e.value)e.disabled=!0;else{e.disabled=!1;try{e.value=t.get(o.fullName+"."+e.key)}catch(s){console.log("Could not retrieve cookie "+o.fullName+"."+e.key),console.log(s.message)}}})})},o.hasOptions=function(o){return o?o.length>0:!1},o.hasParams=function(o){return void 0!==o.params&&o.params.length>0},o.ok=function(){e.close({action:"run",classes:o.classes})},o.cancel=function(){e.dismiss("cancel")},o.showGetApi=function(){return r},o.getApi=function(){e.close({action:"api",classes:o.classes})},o.paramElementId=function(o,e){var t=o.charAt(0).toLowerCase()+o.slice(1),s=e.charAt(0).toUpperCase()+e.slice(1);return t+s},o.setParams(),o.onFinishJoyRide=function(){a.onFinishJoyRide(o)},o.startJoyRide=function(e){a.startJoyRide(e,o)},o.onLoad()}]),angular.module("storyModule",[]).controller("storyCtrl",["$scope","$http","$modal","$location","$cookieStore","$q","$anchorScroll","$timeout","story","steps","groovyComposites","TcBddService",function(o,e,t,s,n,r,a,i,l,c,u,p){o.onLoad=function(){if(o.pendingSteps=[],o.story=l,o.steps=c,o.groovyComposites=u,o.stepTypes=["GIVEN","WHEN","THEN"],o.storyFormClass="col-md-12",o.storyRunnerVisible=!1,o.storyRunnerInProgress=!1,o.storyRunnerSuccess=!0,o.expandPanels(),o.originalStory=angular.copy(l),o.scenarioToggles=[],o.setAction(),void 0!==s.search().reportsId&&(o.storyFormClass="col-md-6",o.storyRunnerClass="col-md-6",o.storyRunnerVisible=!0,o.getReports(s.search().reportsId)),void 0!==s.search().openModal){var e=s.search().openModal;"openRunStory"===e&&o.openRunnerParams()}p.startJoyRideOnLoad(s,o)},o.setAction=function(){o.action=""!==o.story.name?"PUT":"POST"},o.expandPanels=function(){var e=!0;void 0===o.panelsExpanded?o.panelsExpanded=!1:(o.panelsExpanded=!o.panelsExpanded,e=o.panelsExpanded),o.panels={story:o.panelsExpanded,description:o.panelsExpanded,meta:o.panelsExpanded,narrative:o.panelsExpanded,givenStories:o.panelsExpanded,lifecycle:o.panelsExpanded,scenarios:e}},o.cssClass=p.cssClass,o.buttonCssClass=p.buttonCssClass,o.canSaveStory=function(){var e=o.storyForm.$valid,t=!angular.equals(o.story,o.originalStory);return e&&t},o.stepTextPattern=p.stepTextPattern,o.saveStory=function(){if(o.canSaveStory())if(o.story.path=o.story.dirPath+o.story.name+".story","POST"===o.action){var t=o.story.dirPath.split("/"),n=t.slice(0,t.length-1).join("/");""!==n&&(n+="/"),e.post("/stories/story.json",o.story).then(function(){s.path("/page/stories/view/"+n+o.story.name),o.originalStory=angular.copy(o.story)},function(e){o.openErrorModal(e.data)})}else o.story.name!==o.originalStory.name&&(o.story.originalPath=o.originalStory.path),e.put("/stories/story.json",o.story).then(function(){o.originalStory=angular.copy(o.story)},function(e){o.openErrorModal(e.data)})},o.canRunStory=function(){return o.storyForm.$valid&&!o.storyRunnerInProgress},o.runStory=function(){o.canRunStory()&&(o.saveStory(),o.openRunnerParams())},o.openRunnerParams=function(){o.openRunnerModal().result.then(function(t){var s=t.classes;o.storyFormClass="col-md-6",o.storyRunnerClass="col-md-6",o.storyRunnerVisible=!0,o.storyRunnerInProgress=!0,s.forEach(function(o){o.params.forEach(function(e){n.put(o.fullName+"."+e.key,e.value)})});var r={storyPaths:[{path:o.story.path}],classes:s,groovyComposites:o.groovyComposites};e.post("/runner/run.json",r).then(function(e){o.getReports(e.data.id)},function(e){o.storyRunnerSuccess=!1,o.storyRunnerInProgress=!1,o.openErrorModal(e.data)})},function(e){o.openErrorModal(e.data)})},o.getReports=function(t){e.get("/api/v1/reporters/list/"+t).then(function(e){if("finished"!==e.data.status)o.storyRunnerInProgress=!0,i(function(){o.getReports(t)},5e3);else{var s=e.data.reports;o.reports=s,o.reports.id=t,o.setPendingSteps(s),o.storyRunnerInProgress=!1,o.storyRunnerSuccess=o.isStoryRunnerSuccess(s)}},function(e){void 0!==e.data.meta&&"ID is NOT correct"===e.data.meta.message?i(function(){o.getReports(t)},5e3):(o.storyRunnerInProgress=!1,p.openErrorModal(e.data))})},o.isStoryRunnerSuccess=function(o){var e=!0;return o.forEach(function(o){o.steps.forEach(function(o){"successful"!==o.status&&"pending"!==o.status&&"notPerformed"!==o.status&&(e=!1)})}),e},o.getReportUrl=function(o,e){return"/api/v1/reporters/get/"+o+"/"+e},o.openRunnerModal=function(){return p.openRunnerParametersModal(!1,o)},o.getRunnerProgressCss=function(){return p.getRunnerProgressCss(o.storyRunnerInProgress)},o.getRunnerStatusCss=function(){return p.getRunnerStatusCss(o.storyRunnerInProgress,o.storyRunnerSuccess,o.pendingSteps>0)},o.setPendingSteps=function(e){o.pendingSteps=[],e.forEach(function(e){e.steps.forEach(function(e){"pending"===e.status&&o.pendingSteps.push({text:e.text})})})},o.hasPendingSteps=function(){return void 0!==o.pendingSteps&&o.pendingSteps.length>0},o.getStoryRunnerStatusText=function(){return p.getStoryRunnerStatusText(o.storyRunnerInProgress,o.storyRunnerSuccess,o.pendingSteps.length)},o.removeCollectionElement=p.removeCollectionElement,o.addElement=function(o){o.push({})},o.addScenarioElement=function(o){o.push({title:"",meta:[],steps:[],examplesTable:""})},o.revertStory=function(){o.story=angular.copy(o.originalStory),o.storyForm.$setPristine()},o.canRevertStory=function(){return!angular.equals(o.story,o.originalStory)},o.canDeleteStory=function(){return"PUT"===o.action&&!o.storyRunnerInProgress},o.deleteStory=function(){var e=o.story.dirPath+o.story.name+".story";p.deleteStory(e)},o.stepEnterKey=p.newCollectionItem,o.clickPendingStep=function(o){var e=n.get("compositeClass");return void 0===e||""===e?p.openCompositeClass(o):s.search("stepText",o).path("/page/composites/"+e+".groovy")},o.openErrorModal=function(){p.openErrorModal()},o.changeScenarioToggle=function(e,t){var s=!1;o.scenarioToggles.forEach(function(o){o.scenario===e&&(o.expanded=void 0===t?!o.expanded:t,s=!0)}),s||o.scenarioToggles.push({scenario:e,expanded:!0})},o.getScenarioToggle=function(e){var t=!1;return o.scenarioToggles.forEach(function(o){o.scenario===e&&(t=o.expanded)}),t},o.onFinishJoyRide=function(){p.onFinishJoyRide(o)},o.startJoyRide=function(e){p.startJoyRide(e,o)},o.expandPanelsTour=function(){o.expandPanels()},o.changeScenarioToggleTour=function(){o.changeScenarioToggle(3)},o.onLoad()}]).controller("storiesCtrl",["$scope","$http","$modal","$modalInstance","$location","$q","TcBddService","features",function(o,e,t,s,n,r,a,i){o.onLoad=function(){o.features=i,a.getStories(o,""),a.startJoyRideOnLoad(n,o)},o.openDir=function(e){a.openDir(o,e)},o.close=function(){s.close()},o.openStory=function(e){o.onFinishJoyRide(),s.close(),n.path("/page/stories/view/"+o.rootPath+e)},o.allowToPrevDir=function(){return""!==o.rootPath},o.deleteStory=function(e,t){var s=o.rootPath+e+".story";a.deleteStory(s).then(function(){o.files.stories.splice(t,1)})},o.createDirectory=function(t){var s='{"path": "'+o.rootPath+t+'"}';e.post("/stories/dir.json",s).then(function(){o.files.dirs.push({name:t})},function(o){a.openErrorModal(o.data)})},o.onFinishJoyRide=function(){a.onFinishJoyRide(o)},o.startJoyRide=function(e){a.startJoyRide(e,o)},o.openDirsTour=function(){o.openDir("tcbdd/login")},o.onLoad()}]),angular.module("topMenuModule",[]).controller("topMenuController",["$scope","$location",function(o,e){o.getTitle=function(){var o=e.path();return 0===o.indexOf("/page/stories/view/")?"View Story":0===o.indexOf("/page/stories/new/")?"New Story":0===o.indexOf("/page/composites/")?"Composites":0===o.indexOf("/page/reports/")?"Reports":0===o.indexOf("/page/login/")?"Login":0===o.indexOf("/page/loginWelcome/")?"Welcome":0===o.indexOf("/page/tour/")?"Home":""}}]),angular.module("tourModule",[]).controller("tourCtrl",["$scope","$location","TcBddService",function(o,e,t){o.onLoad=function(){t.startJoyRideOnLoad(e,o)},o.onFinishJoyRide=function(){t.onFinishJoyRide(o)},o.startJoyRide=function(e){t.startJoyRide(e,o)},o.onLoad()}]);