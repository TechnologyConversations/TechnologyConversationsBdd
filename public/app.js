function getJson(t,e,o,s){return t.get(o,{cache:s}).then(function(t){return t.data},function(t){openErrorModal(e,t.data)})}function openErrorModal(t,e){t.open({templateUrl:"/assets/html/errorModal.tmpl.html",controller:"modalCtrl",resolve:{data:function(){return e}}})}function getViewStoryUrl(){return"/page/stories/view/"}function getNewStoryUrl(){return"/page/stories/new/"}function getCompositesUrl(){return"/page/composites/"}function deleteStory(t,e,o,s,n){var r=s.defer(),a={status:"Delete Story",message:"Are you sure you want to delete this story?"},i=openConfirmationModal(t,a);return i.result.then(function(){e.delete("/stories/story/"+n).then(function(){o.path(getNewStoryUrl()),r.resolve("OK")},function(e){openErrorModal(t,e.data),r.reject("NOK")})},function(){r.reject("NOK")}),r.promise}function cssClass(t){return{"has-error":t.$invalid,"has-success":t.$valid&&t.$dirty}}function classNamePattern(){return/^[a-zA-Z_$][a-zA-Z\d_$]*$/}function openConfirmationModal(t,e){return t.open({templateUrl:"/assets/html/confirmationModal.tmpl.html",controller:"modalCtrl",resolve:{data:function(){return e}}})}function getCompositesJson(t,e){var o="/groovyComposites/"+e;return t.get(o,{cache:!1}).then(function(t){return t.data},function(){var t=e.substring(0,e.lastIndexOf("."));return{"class":t,composites:[{stepText:"",compositeSteps:[{}]}],isNew:!0}})}function stepTextPattern(){return/^(Given|When|Then) .+$/}function getStories(t,e,o,s){void 0===t.rootPath&&(t.rootPath=""),e.get("/stories/list.json?path="+t.rootPath+s).then(function(e){t.files=e.data,""!==s&&(t.rootPath+=s+"/")},function(t){openErrorModal(o,t.data)})}function openDir(t,e,o,s){if(".."===s){var n=t.rootPath.split("/");t.rootPath=n.slice(0,n.length-2).join("/"),""!==t.rootPath&&(t.rootPath+="/"),getStories(t,e,o,"")}else getStories(t,e,o,s)}function openRunnerParametersModal(t,e){return t.open({templateUrl:"/assets/html/runner/runnerParams.tmpl.html",controller:"runnerParamsCtrl",resolve:{data:function(t,e,o){return getJson(e,o,"/steps/classes.json",!0)},showGetApi:function(){return e}}})}function getRunnerStatusCss(t,e,o){return{"progress-bar progress-bar-info":t,"progress-bar progress-bar-warning":!t&&e&&o,"progress-bar progress-bar-success":!t&&e&&!o,"progress-bar progress-bar-danger":!t&&!e}}function getStoryRunnerStatusText(t,e,o){return t?"Story run is in progress":e?o>0?"Story run was successful with "+o+" pending steps":"Story run was successful":"Story run failed"}angular.module("storiesModule",["ngRoute","ngCookies","ui.bootstrap","ui.sortable","configModule","bodyModule","topMenuModule","storyModule","compositeClassesModule","compositesModule","runnerModule"]).service("TcBddService",["$modal",function(t){this.openCompositeClass=function(e){t.open({templateUrl:"/assets/html/compositeClasses/compositeClasses.tmpl.html",controller:"compositeClassesCtrl",resolve:{compositeClasses:["$route","$http","$modal",function(t,e,o){return getJson(e,o,"/groovyComposites",!1)}],compositeStepText:function(){return e}}})},this.newCollectionItem=function(t,e){13===t.which&&e.push({})},this.removeCollectionElement=function(t,e){t.splice(e,1)},this.buttonCssClass=function(t){return{"btn-success":t.$valid,"btn-danger":t.$invalid}},this.getRunnerProgressCss=function(t){return{"progress progress-striped active":t,progress:!t}}}]).controller("modalCtrl",["$scope","$modalInstance","data",function(t,e,o){t.data=o,t.ok=function(){e.close("ok")},t.cancel=function(){e.dismiss("cancel")}}]).controller("storiesCtrl",["$scope","$http","$modal","$modalInstance","$location","$q",function(t,e,o,s,n,r){getStories(t,e,o,""),t.openDir=function(s){openDir(t,e,o,s)},t.close=function(){s.close()},t.viewStoryUrl=function(e){return getViewStoryUrl()+t.rootPath+e},t.allowToPrevDir=function(){return""!==t.rootPath},t.deleteStory=function(s,a){var i=t.rootPath+s+".story";deleteStory(o,e,n,r,i).then(function(){t.files.stories.splice(a,1)})},t.createDirectory=function(s){var n='{"path": "'+t.rootPath+s+'"}';e.post("/stories/dir.json",n).then(function(){t.files.dirs.push({name:s})},function(t){openErrorModal(o,t.data)})},t.getNewStoryUrl=function(){return getNewStoryUrl()}}]),angular.module("configModule",[]).config(["$routeProvider","$locationProvider",function(t,e){e.html5Mode(!0),t.when(getNewStoryUrl(),{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",resolve:{story:["$http","$modal",function(t,e){return getJson(t,e,"/stories/story.json",!1)}],steps:["$http","$modal",function(t,e){return getJson(t,e,"/steps/list.json",!0)}],groovyComposites:["$http","$modal",function(t,e){return getJson(t,e,"/groovyComposites",!0)}]}}).when(getNewStoryUrl()+":path*",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",resolve:{story:["$route","$http","$modal",function(t,e,o){return getJson(e,o,"/stories/story.json?path="+t.current.params.path+".story",!1)}],steps:["$http","$modal",function(t,e){return getJson(t,e,"/steps/list.json",!0)}],groovyComposites:["$http","$modal",function(t,e){return getJson(t,e,"/groovyComposites",!0)}]}}).when(getViewStoryUrl()+":path*",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",resolve:{story:["$route","$http","$modal",function(t,e,o){return getJson(e,o,"/stories/story.json?path="+t.current.params.path+".story",!1)}],steps:["$http","$modal",function(t,e){return getJson(t,e,"/steps/list.json",!0)}],groovyComposites:["$http","$modal",function(t,e){return getJson(t,e,"/groovyComposites",!0)}]},reloadOnSearch:!1}).when(getCompositesUrl()+":className*",{templateUrl:"/assets/html/composites/composites.tmpl.html",controller:"compositesCtrl",resolve:{compositesClass:["$route","$http",function(t,e){return getCompositesJson(e,t.current.params.className)}],steps:["$http","$modal",function(t,e){return getJson(t,e,"/steps/list.json",!1)}]}}).when("/page/runner/",{templateUrl:"/assets/html/runner/runner.tmpl.html",controller:"runnerCtrl",resolve:{data:["$route",function(t){return{reportsPath:t.current.params.path}}]}}).otherwise({redirectTo:"/page/stories/new"})}]),angular.module("bodyModule",[]).controller("bodyCtrl",["$scope","$cookieStore","$location","TcBddService",function(t,e,o,s){t.history=e.get("history"),void 0===t.history&&(t.history=[]),t.addHistoryItem=function(s){for(angular.forEach(t.history,function(e,o){e.text===s&&t.removeHistoryItem(o)});t.history.length>=10;)t.removeHistoryItem(t.history.length-1);t.history.splice(0,0,{text:s,url:o.path()}),e.put("history",t.history)},t.removeHistoryItem=function(o){s.removeCollectionElement(t.history,o),e.put("history",t.history)}}]),angular.module("compositeClassesModule",[]).controller("compositeClassesCtrl",["$scope","$http","$modalInstance","compositeClasses","compositeStepText",function(t,e,o,s,n){t.compositeClasses=s,t.compositeStepText=n,t.close=function(){o.close()},t.compositeClassUrl=function(e,o){var s="/page/composites/";void 0!==e&&""!==e&&(s+=e+".");var n;return n=o.split(o.indexOf("/")>=0?"/":"\\"),s+=n[n.length-1],void 0!==t.compositeStepText&&""!==t.compositeStepText&&(s+="?stepText="+t.compositeStepText),s},t.compositeClassText=function(t){var e;e=t.split(t.indexOf("/")>=0?"/":"\\");var o=e[e.length-1];return o.indexOf(".")>=0&&(o=o.substr(0,o.lastIndexOf("."))),o},t.classNamePattern=classNamePattern,t.cssClass=cssClass,t.data={"class":""}}]),angular.module("compositesModule",[]).controller("compositesCtrl",["$scope","$http","$modal","$location","$cookieStore","compositesClass","steps","TcBddService",function(t,e,o,s,n,r,a,i){t.addCompositesTab=function(){t.compositesClass.isNew||t.addHistoryItem(t.compositesClass.class+" composites")},t.addNewComposite=function(){t.composite={stepText:"",compositeSteps:[{}]},t.compositesClass.composites.push(t.composite)},t.addStepTextParam=function(){void 0!==s.search().stepText&&""!==s.search().stepText&&t.compositesClass.composites.push({stepText:s.search().stepText,compositeSteps:[]})},t.addNewCompositeStep=function(){t.composite.compositeSteps.push({})},t.setLastComposite=function(){if(void 0!==t.compositesClass){var e=t.compositesClass.composites.length;t.composite=t.compositesClass.composites[e-1]}else t.composite={}},t.compositesClass=r,t.addStepTextParam(),t.originalCompositesClass=angular.copy(r),t.setLastComposite(),t.steps=a,t.classNamePattern=classNamePattern,t.stepTextPattern=stepTextPattern,t.cssClass=cssClass,t.buttonCssClass=function(t,e){return i.buttonCssClass(t.$valid?e:t)},t.openComposite=function(e){t.composite=e},t.newCollectionItem=i.newCollectionItem,t.removeCollectionElement=i.removeCollectionElement,t.revertCompositesClass=function(){t.compositesClass=angular.copy(t.originalCompositesClass),t.composite=t.compositesClass.composites[0]},t.canRevertCompositesClass=function(){return!angular.equals(t.compositesClass,t.originalCompositesClass)},t.canSaveCompositesClass=function(e){var o=e.$valid,s=!angular.equals(t.compositesClass,t.originalCompositesClass),n=t.compositesClass.isNew;return(n||s)&&o},t.compositesAreValid=function(e){var o=e.$valid;return angular.forEach(t.compositesClass.composites,function(t){void 0===t.stepText||""===t.stepText?o=!1:(void 0===t.compositeSteps||0===t.compositeSteps.length)&&(o=!1)}),o},t.saveCompositesClass=function(){e.put("/groovyComposites",t.compositesClass).then(function(){t.deleteCompositesClassWithoutConfirmation(),s.path("/page/composites/"+t.compositesClass.class+".groovy"),t.compositesClass.isNew=!1,t.originalCompositesClass=angular.copy(t.compositesClass),n.put("compositeClass",t.compositesClass.class),t.addCompositesTab()},function(t){openErrorModal(o,t.data)})},t.canDeleteCompositesClass=function(){return!t.compositesClass.isNew},t.deleteCompositesClassWithoutConfirmation=function(){var s=t.compositesClass.class,n=t.originalCompositesClass.class;s!==n&&e.delete("/groovyComposites/"+n).then(function(){},function(t){openErrorModal(o,t.data)})},t.deleteCompositesClass=function(){var n={status:"Delete Composites Class",message:"Are you sure you want to delete this composites class?"},r=openConfirmationModal(o,n);r.result.then(function(){e.delete("/groovyComposites/"+t.originalCompositesClass.class).then(function(){s.path("/")},function(t){openErrorModal(o,t.data)})},function(){})},t.saveCompositesText=function(){return t.compositesClass.isNew?"Create New Composites":"Update Composites"},t.addCompositesTab()}]),angular.module("runnerModule",[]).controller("runnerCtrl",["$scope","$modal","$http","$location","TcBddService",function(t,e,o,s,n){t.openRunnerSelector=function(){return e.open({templateUrl:"/assets/html/runner/runnerSelector.tmpl.html",controller:"runnerSelectorCtrl",resolve:{data:function(){return{}}}})},t.openRunner=function(){var s=t.openRunnerSelector();void 0!==s&&s.result.then(function(s){var n=[];s.dirs.forEach(function(t){n.push({path:t.path+"/**/*.story"})}),s.stories.forEach(function(t){n.push({path:t.path})}),openRunnerParametersModal(e,!0).result.then(function(e){var s=e.classes,r=e.action;o.get("/groovyComposites").then(function(e){var o=e.data;t.apiJson={storyPaths:n,classes:s,groovyComposites:o},"run"===r?(t.run(t.apiJson),t.showApi=!1):t.showApi=!0})})})},t.run=function(s){t.storyRunnerInProgress=!0,t.showRunnerProgress=!0,t.reportsUrl="",o.post("/runner/run.json",s).then(function(o){var s=o.data;"OK"===s.status?(t.reportsUrl=s.reportsPath.replace("public/","/assets/"),t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!0):"FAILED"===s.status?(t.reportsUrl=s.reportsPath.replace("public/","/assets/"),t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!1):openErrorModal(e,s),t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!0},function(o){t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!1,openErrorModal(e,o.data)})},t.getRunnerStatusCss=function(){return getRunnerStatusCss(t.storyRunnerInProgress,t.storyRunnerSuccess,t.pendingSteps>0)},t.getStoryRunnerStatusText=function(){return getStoryRunnerStatusText(t.storyRunnerInProgress,t.storyRunnerSuccess,t.pendingSteps.length)},t.getRunnerProgressCss=function(){return n.getRunnerProgressCss(t.storyRunnerInProgress)},t.init=function(){t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!1,t.showRunnerProgress=!1,t.pendingSteps=[],t.reportsUrl="",t.openRunner(),t.showApi=!1},t.apiUrl=function(){return s.protocol()+"://"+s.host()+":"+s.port()+"/runner/run.json"},t.init()}]).controller("runnerSelectorCtrl",["$scope","$http","$modal","$modalInstance",function(t,e,o,s){t.files={dirs:[],stories:[]},getStories(t,e,o,""),t.openDir=function(s){openDir(t,e,o,s)},t.cancelRunnerSelector=function(){s.dismiss("cancel")},t.okRunnerSelector=function(){var e={dirs:[],stories:[]};angular.forEach(t.files.dirs,function(o){o.selected&&e.dirs.push({path:t.rootPath+o.name})}),angular.forEach(t.files.stories,function(o){o.selected&&e.stories.push({path:t.rootPath+o.name+".story"})}),s.close(e)},t.allowToPrevDir=function(){return""!==t.rootPath},t.canContinue=function(){var e=!1;return angular.forEach(t.files.dirs,function(t){t.selected&&(e=!0)}),e||angular.forEach(t.files.stories,function(t){t.selected&&(e=!0)}),e}}]).controller("runnerParamsCtrl",["$scope","$modalInstance","$cookieStore","data","showGetApi",function(t,e,o,s,n){t.classes=s.classes,t.classes.forEach(function(t){t.params.forEach(function(e){try{e.value=o.get(t.fullName+"."+e.key)}catch(s){console.log("Could not retrieve cookie "+t.fullName+"."+e.key),console.log(s.message)}})}),t.hasParams=function(t){return void 0!==t.params&&t.params.length>0},t.ok=function(){e.close({action:"run",classes:t.classes})},t.cancel=function(){e.dismiss("cancel")},t.showGetApi=function(){return n},t.getApi=function(){e.close({action:"api",classes:t.classes})},t.paramElementId=function(t,e){var o=t.charAt(0).toLowerCase()+t.slice(1),s=e.charAt(0).toUpperCase()+e.slice(1);return o+s}}]),angular.module("storyModule",[]).controller("storyCtrl",["$scope","$http","$modal","$location","$cookieStore","$q","$anchorScroll","story","steps","groovyComposites","TcBddService",function(t,e,o,s,n,r,a,i,l,c,u){t.pendingSteps=[],t.setAction=function(){""!==t.story.name?(t.action="PUT",t.addHistoryItem(t.story.name+" story")):t.action="POST"},t.expandPanels=function(){var e=!0;void 0===t.panelsExpanded?t.panelsExpanded=!1:(t.panelsExpanded=!t.panelsExpanded,e=t.panelsExpanded),t.panels={story:t.panelsExpanded,description:t.panelsExpanded,meta:t.panelsExpanded,narrative:t.panelsExpanded,givenStories:t.panelsExpanded,lifecycle:t.panelsExpanded,scenarios:e}},t.story=i,t.steps=l,t.groovyComposites=c,t.stepTypes=["GIVEN","WHEN","THEN"],t.storyFormClass="col-md-12",t.storyRunnerVisible=!1,t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!0,t.expandPanels(),t.originalStory=angular.copy(i);var p=t.story.path.split("/");t.dirPath=p.slice(0,p.length-1).join("/"),""!==t.dirPath&&(t.dirPath+="/"),t.setAction(),t.cssClass=cssClass,t.buttonCssClass=u.buttonCssClass,t.canSaveStory=function(){var e=t.storyForm.$valid,o=!angular.equals(t.story,t.originalStory);return e&&o},t.stepTextPattern=stepTextPattern,t.saveStory=function(){if(t.canSaveStory())if(t.story.path=t.dirPath+t.story.name+".story","POST"===t.action){var n=t.dirPath.split("/"),r=n.slice(0,n.length-1).join("/");""!==r&&(r+="/"),e.post("/stories/story.json",t.story).then(function(){s.path(getViewStoryUrl()+r+t.story.name),t.originalStory=angular.copy(t.story)},function(e){t.openErrorModal(o,e.data)})}else t.story.name!==t.originalStory.name&&(t.story.originalPath=t.originalStory.path),e.put("/stories/story.json",t.story).then(function(){t.originalStory=angular.copy(t.story)},function(e){t.openErrorModal(o,e.data)})},t.canRunStory=function(){return t.storyForm.$valid&&!t.storyRunnerInProgress},t.runStory=function(){t.canRunStory()&&(t.saveStory(),t.openRunnerModal().result.then(function(s){var r=s.classes;t.storyFormClass="col-md-6",t.storyRunnerClass="col-md-6",t.storyRunnerVisible=!0,t.storyRunnerInProgress=!0,r.forEach(function(t){t.params.forEach(function(e){n.put(t.fullName+"."+e.key,e.value)})});var a={storyPaths:[{path:t.story.path}],classes:r,groovyComposites:t.groovyComposites};e.post("/runner/run.json",a).then(function(e){t.storyRunnerSuccess="OK"===e.data.status,t.storyRunnerInProgress=!1,t.getReports(e.data.id)},function(e){t.storyRunnerSuccess=!1,t.storyRunnerInProgress=!1,t.openErrorModal(o,e.data)})},function(e){t.openErrorModal(o,e.data)}))},t.getReports=function(s){e.get("/api/v1/reporters/list/"+s).then(function(e){t.reports=e.data,t.reports.id=s,t.setPendingSteps(t.reports)},function(e){t.openErrorModal(o,e.data)})},t.getReportUrl=function(t,e){return"/api/v1/reporters/get/"+t+"/"+e},t.openRunnerModal=function(){return openRunnerParametersModal(o,!1)},t.getRunnerProgressCss=function(){return u.getRunnerProgressCss(t.storyRunnerInProgress)},t.getRunnerStatusCss=function(){return getRunnerStatusCss(t.storyRunnerInProgress,t.storyRunnerSuccess,t.pendingSteps>0)},t.setPendingSteps=function(e){t.pendingSteps=[],e.forEach(function(e){e.steps.forEach(function(e){"pending"===e.status&&t.pendingSteps.push({text:e.text})})})},t.hasPendingSteps=function(){return void 0!==t.pendingSteps&&t.pendingSteps.length>0},t.getStoryRunnerStatusText=function(){return getStoryRunnerStatusText(t.storyRunnerInProgress,t.storyRunnerSuccess,t.pendingSteps.length)},t.removeCollectionElement=u.removeCollectionElement,t.addElement=function(t){t.push({})},t.addScenarioElement=function(t){t.push({title:"",meta:[],steps:[],examplesTable:""})},t.revertStory=function(){t.story=angular.copy(t.originalStory),t.storyForm.$setPristine()},t.canRevertStory=function(){return!angular.equals(t.story,t.originalStory)},t.canDeleteStory=function(){return"PUT"===t.action&&!t.storyRunnerInProgress},t.deleteStory=function(){var n=t.dirPath+t.story.name+".story";deleteStory(o,e,s,r,n)},t.stepEnterKey=u.newCollectionItem,t.clickPendingStep=function(t){var e=n.get("compositeClass");return void 0===e||""===e?u.openCompositeClass(t):s.search("stepText",t).path("/page/composites/composites.com.technologyconversations.bdd.steps."+e)},t.openErrorModal=openErrorModal}]),angular.module("topMenuModule",[]).controller("topMenuController",["$scope","$modal","$location","TcBddService",function(t,e,o,s){t.openStory=function(){e.open({templateUrl:"/assets/html/stories.tmpl.html",controller:"storiesCtrl",resolve:{data:function(){return{}}}})},t.openCompositeClass=function(){s.openCompositeClass(e)},t.getTitle=function(){var t=o.path();return 0===t.indexOf(getViewStoryUrl())?"View Story":0===t.indexOf(getNewStoryUrl())?"New Story":0===t.indexOf(getCompositesUrl())?"Composites":0===t.indexOf("/page/reports/")?"Reports":""}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlcyI6WyJpbmRleC5qcyIsImNvbmZpZy5qcyIsImNvbW1vblxcYm9keS5jdHJsLmpzIiwiY29tbW9uXFx1dGlsLmpzIiwiY29tcG9zaXRlQ2xhc3Nlc1xcY29tcG9zaXRlQ2xhc3Nlcy5jdHJsLmpzIiwiY29tcG9zaXRlc1xcY29tcG9zaXRlcy5jdHJsLmpzIiwicnVubmVyXFxydW5uZXIuY3RybC5qcyIsInN0b3J5XFxzdG9yeS5jdHJsLmpzIiwidG9wTWVudVxcdG9wTWVudS5jdHJsLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQStGQSxRQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxNQUFBLEdBQUEsSUFBQSxHQUFBLE1BQUEsSUFBQSxLQUFBLFNBQUEsR0FDQSxNQUFBLEdBQUEsTUFDQSxTQUFBLEdBQ0EsZUFBQSxFQUFBLEVBQUEsUUFLQSxRQUFBLGdCQUFBLEVBQUEsR0FDQSxFQUFBLE1BQ0EsWUFBQSxvQ0FDQSxXQUFBLFlBQ0EsU0FDQSxLQUFBLFdBQ0EsTUFBQSxPQU1BLFFBQUEsbUJBQ0EsTUFBQSxzQkFHQSxRQUFBLGtCQUNBLE1BQUEscUJBR0EsUUFBQSxvQkFDQSxNQUFBLG9CQUlBLFFBQUEsYUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsUUFDQSxHQUFBLE9BQUEsZUFBQSxRQUFBLCtDQUNBLEVBQUEsc0JBQUEsRUFBQSxFQVlBLE9BWEEsR0FBQSxPQUFBLEtBQUEsV0FDQSxFQUFBLE9BQUEsa0JBQUEsR0FBQSxLQUFBLFdBQ0EsRUFBQSxLQUFBLGtCQUNBLEVBQUEsUUFBQSxPQUNBLFNBQUEsR0FDQSxlQUFBLEVBQUEsRUFBQSxNQUNBLEVBQUEsT0FBQSxVQUVBLFdBQ0EsRUFBQSxPQUFBLFNBRUEsRUFBQSxRQUlBLFFBQUEsVUFBQSxHQUNBLE9BQ0EsWUFBQSxFQUFBLFNBQ0EsY0FBQSxFQUFBLFFBQUEsRUFBQSxRQUlBLFFBQUEsb0JBQ0EsTUFBQSw0QkMzSkEsUUFBQSx1QkFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLE1BQ0EsWUFBQSwyQ0FDQSxXQUFBLFlBQ0EsU0FDQSxLQUFBLFdBQ0EsTUFBQSxPQU9BLFFBQUEsbUJBQUEsRUFBQSxHQUNBLEdBQUEsR0FBQSxxQkFBQSxDQUNBLE9BQUEsR0FBQSxJQUFBLEdBQUEsT0FBQSxJQUFBLEtBQUEsU0FBQSxHQUNBLE1BQUEsR0FBQSxNQUNBLFdBQ0EsR0FBQSxHQUFBLEVBQUEsVUFBQSxFQUFBLEVBQUEsWUFBQSxLQUNBLFFBQ0EsUUFBQSxFQUNBLGFBQUEsU0FBQSxHQUFBLHNCQUNBLE9BQUEsS0FLQSxRQUFBLG1CQUNBLE1BQUEseUJBR0EsUUFBQSxZQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsU0FBQSxFQUFBLFdBQ0EsRUFBQSxTQUFBLElBRUEsRUFBQSxJQUFBLDJCQUFBLEVBQUEsU0FBQSxHQUFBLEtBQUEsU0FBQSxHQUNBLEVBQUEsTUFBQSxFQUFBLEtBQ0EsS0FBQSxJQUNBLEVBQUEsVUFBQSxFQUFBLE1BRUEsU0FBQSxHQUNBLGVBQUEsRUFBQSxFQUFBLFFBSUEsUUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsR0FBQSxPQUFBLEVBQUEsQ0FDQSxHQUFBLEdBQUEsRUFBQSxTQUFBLE1BQUEsSUFDQSxHQUFBLFNBQUEsRUFBQSxNQUFBLEVBQUEsRUFBQSxPQUFBLEdBQUEsS0FBQSxLQUNBLEtBQUEsRUFBQSxXQUNBLEVBQUEsVUFBQSxLQUVBLFdBQUEsRUFBQSxFQUFBLEVBQUEsUUFFQSxZQUFBLEVBQUEsRUFBQSxFQUFBLEdBS0EsUUFBQSwyQkFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLE1BQ0EsWUFBQSw2Q0FDQSxXQUFBLG1CQUNBLFNBQ0EsS0FBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsU0FBQSxFQUFBLEVBQUEsdUJBQUEsSUFFQSxXQUFBLFdBQ0EsTUFBQSxPQU1BLFFBQUEsb0JBQUEsRUFBQSxFQUFBLEdBQ0EsT0FDQSxpQ0FBQSxFQUNBLHFDQUFBLEdBQUEsR0FBQSxFQUNBLHFDQUFBLEdBQUEsSUFBQSxFQUNBLG9DQUFBLElBQUEsR0FJQSxRQUFBLDBCQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsR0FDQSwyQkFDQSxFQUNBLEVBQUEsRUFDQSxpQ0FBQSxFQUFBLGlCQUVBLDJCQUdBLG1CRDlGQSxRQUFBLE9BQUEsaUJBQ0EsVUFDQSxZQUNBLGVBQ0EsY0FDQSxlQUNBLGFBQ0EsZ0JBQ0EsY0FDQSx5QkFDQSxtQkFDQSxpQkFFQSxRQUFBLGdCQUFBLFNBQUEsU0FBQSxHQUNBLEtBQUEsbUJBQUEsU0FBQSxHQUNBLEVBQUEsTUFDQSxZQUFBLDJEQUNBLFdBQUEsdUJBQ0EsU0FDQSxrQkFBQSxTQUFBLFFBQUEsU0FBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsU0FBQSxFQUFBLEVBQUEscUJBQUEsS0FFQSxrQkFBQSxXQUNBLE1BQUEsUUFLQSxLQUFBLGtCQUFBLFNBQUEsRUFBQSxHQUNBLEtBQUEsRUFBQSxPQUNBLEVBQUEsVUFHQSxLQUFBLHdCQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsT0FBQSxFQUFBLElBRUEsS0FBQSxlQUFBLFNBQUEsR0FDQSxPQUNBLGNBQUEsRUFBQSxPQUNBLGFBQUEsRUFBQSxXQUdBLEtBQUEscUJBQUEsU0FBQSxHQUNBLE9BQ0EsbUNBQUEsRUFDQSxVQUFBLE9BSUEsV0FBQSxhQUFBLFNBQUEsaUJBQUEsT0FBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsS0FBQSxFQUNBLEVBQUEsR0FBQSxXQUNBLEVBQUEsTUFBQSxPQUVBLEVBQUEsT0FBQSxXQUNBLEVBQUEsUUFBQSxjQUdBLFdBQUEsZUFBQSxTQUFBLFFBQUEsU0FBQSxpQkFBQSxZQUFBLEtBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxXQUFBLEVBQUEsRUFBQSxFQUFBLElBQ0EsRUFBQSxRQUFBLFNBQUEsR0FDQSxRQUFBLEVBQUEsRUFBQSxFQUFBLElBRUEsRUFBQSxNQUFBLFdBQ0EsRUFBQSxTQUVBLEVBQUEsYUFBQSxTQUFBLEdBQ0EsTUFBQSxtQkFBQSxFQUFBLFNBQUEsR0FFQSxFQUFBLGVBQUEsV0FDQSxNQUFBLEtBQUEsRUFBQSxVQUdBLEVBQUEsWUFBQSxTQUFBLEVBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxTQUFBLEVBQUEsUUFDQSxhQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxLQUFBLFdBQ0EsRUFBQSxNQUFBLFFBQUEsT0FBQSxFQUFBLE1BSUEsRUFBQSxnQkFBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLGFBQUEsRUFBQSxTQUFBLEVBQUEsSUFDQSxHQUFBLEtBQUEsb0JBQUEsR0FBQSxLQUFBLFdBQ0EsRUFBQSxNQUFBLEtBQUEsTUFBQSxLQUFBLEtBQ0EsU0FBQSxHQUNBLGVBQUEsRUFBQSxFQUFBLFNBSUEsRUFBQSxlQUFBLFdBQ0EsTUFBQSxzQkUxRkEsUUFBQSxPQUFBLG1CQUNBLFFBQUEsaUJBQUEsb0JBQUEsU0FBQSxFQUFBLEdBQ0EsRUFBQSxXQUFBLEdBQ0EsRUFFQSxLQUFBLGtCQUNBLFlBQUEscUNBQ0EsV0FBQSxZQUVBLFNBQ0EsT0FBQSxRQUFBLFNBQUEsU0FBQSxFQUFBLEdBQ0EsTUFBQSxTQUFBLEVBQUEsRUFBQSx1QkFBQSxLQUVBLE9BQUEsUUFBQSxTQUFBLFNBQUEsRUFBQSxHQUNBLE1BQUEsU0FBQSxFQUFBLEVBQUEsb0JBQUEsS0FFQSxrQkFBQSxRQUFBLFNBQUEsU0FBQSxFQUFBLEdBQ0EsTUFBQSxTQUFBLEVBQUEsRUFBQSxxQkFBQSxRQUlBLEtBQUEsaUJBQUEsVUFDQSxZQUFBLHFDQUNBLFdBQUEsWUFFQSxTQUNBLE9BQUEsU0FBQSxRQUFBLFNBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxNQUFBLFNBQUEsRUFBQSxFQUFBLDRCQUFBLEVBQUEsUUFBQSxPQUFBLEtBQUEsVUFBQSxLQUVBLE9BQUEsUUFBQSxTQUFBLFNBQUEsRUFBQSxHQUNBLE1BQUEsU0FBQSxFQUFBLEVBQUEsb0JBQUEsS0FFQSxrQkFBQSxRQUFBLFNBQUEsU0FBQSxFQUFBLEdBQ0EsTUFBQSxTQUFBLEVBQUEsRUFBQSxxQkFBQSxRQUlBLEtBQUEsa0JBQUEsVUFDQSxZQUFBLHFDQUNBLFdBQUEsWUFFQSxTQUNBLE9BQUEsU0FBQSxRQUFBLFNBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxNQUFBLFNBQUEsRUFBQSxFQUFBLDRCQUFBLEVBQUEsUUFBQSxPQUFBLEtBQUEsVUFBQSxLQUVBLE9BQUEsUUFBQSxTQUFBLFNBQUEsRUFBQSxHQUNBLE1BQUEsU0FBQSxFQUFBLEVBQUEsb0JBQUEsS0FFQSxrQkFBQSxRQUFBLFNBQUEsU0FBQSxFQUFBLEdBQ0EsTUFBQSxTQUFBLEVBQUEsRUFBQSxxQkFBQSxNQUdBLGdCQUFBLElBRUEsS0FBQSxtQkFBQSxlQUNBLFlBQUEsK0NBQ0EsV0FBQSxpQkFFQSxTQUNBLGlCQUFBLFNBQUEsUUFBQSxTQUFBLEVBQUEsR0FDQSxNQUFBLG1CQUFBLEVBQUEsRUFBQSxRQUFBLE9BQUEsYUFFQSxPQUFBLFFBQUEsU0FBQSxTQUFBLEVBQUEsR0FDQSxNQUFBLFNBQUEsRUFBQSxFQUFBLG9CQUFBLFFBSUEsS0FBQSxpQkFDQSxZQUFBLHVDQUNBLFdBQUEsYUFFQSxTQUNBLE1BQUEsU0FBQSxTQUFBLEdBQ0EsT0FBQSxZQUFBLEVBQUEsUUFBQSxPQUFBLFdBS0EsV0FDQSxXQUFBLHlCQy9FQSxRQUFBLE9BQUEsaUJBQ0EsV0FBQSxZQUFBLFNBQUEsZUFBQSxZQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsUUFBQSxFQUFBLElBQUEsV0FDQSxTQUFBLEVBQUEsVUFDQSxFQUFBLFlBRUEsRUFBQSxlQUFBLFNBQUEsR0FNQSxJQUxBLFFBQUEsUUFBQSxFQUFBLFFBQUEsU0FBQSxFQUFBLEdBQ0EsRUFBQSxPQUFBLEdBQ0EsRUFBQSxrQkFBQSxLQUdBLEVBQUEsUUFBQSxRQUFBLElBQ0EsRUFBQSxrQkFBQSxFQUFBLFFBQUEsT0FBQSxFQUVBLEdBQUEsUUFBQSxPQUFBLEVBQUEsR0FBQSxLQUFBLEVBQUEsSUFBQSxFQUFBLFNBQ0EsRUFBQSxJQUFBLFVBQUEsRUFBQSxVQUVBLEVBQUEsa0JBQUEsU0FBQSxHQUNBLEVBQUEsd0JBQUEsRUFBQSxRQUFBLEdBQ0EsRUFBQSxJQUFBLFVBQUEsRUFBQSxhQ3BCQSxRQUFBLE9BQUEsNkJBQ0EsV0FBQSx3QkFBQSxTQUFBLFFBQUEsaUJBQUEsbUJBQUEsb0JBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxpQkFBQSxFQUNBLEVBQUEsa0JBQUEsRUFFQSxFQUFBLE1BQUEsV0FDQSxFQUFBLFNBRUEsRUFBQSxrQkFBQSxTQUFBLEVBQUEsR0FDQSxHQUFBLEdBQUEsbUJBQ0EsVUFBQSxHQUFBLEtBQUEsSUFDQSxHQUFBLEVBQUEsSUFFQSxJQUFBLEVBVUEsT0FSQSxHQUFBLEVBQUEsTUFEQSxFQUFBLFFBQUEsTUFBQSxFQUNBLElBRUEsTUFFQSxHQUFBLEVBQUEsRUFBQSxPQUFBLEdBQ0EsU0FBQSxFQUFBLG1CQUFBLEtBQUEsRUFBQSxvQkFDQSxHQUFBLGFBQUEsRUFBQSxtQkFFQSxHQUVBLEVBQUEsbUJBQUEsU0FBQSxHQUNBLEdBQUEsRUFFQSxHQUFBLEVBQUEsTUFEQSxFQUFBLFFBQUEsTUFBQSxFQUNBLElBRUEsS0FFQSxJQUFBLEdBQUEsRUFBQSxFQUFBLE9BQUEsRUFJQSxPQUhBLEdBQUEsUUFBQSxNQUFBLElBQ0EsRUFBQSxFQUFBLE9BQUEsRUFBQSxFQUFBLFlBQUEsT0FFQSxHQUVBLEVBQUEsaUJBQUEsaUJBRUEsRUFBQSxTQUFBLFNBQ0EsRUFBQSxNQUFBLFFBQUEsT0N6Q0EsUUFBQSxPQUFBLHVCQUNBLFdBQUEsa0JBQUEsU0FBQSxRQUFBLFNBQUEsWUFBQSxlQUFBLGtCQUFBLFFBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLGlCQUFBLFdBQ0EsRUFBQSxnQkFBQSxPQUNBLEVBQUEsZUFBQSxFQUFBLGdCQUFBLE1BQUEsZ0JBR0EsRUFBQSxnQkFBQSxXQUNBLEVBQUEsV0FBQSxTQUFBLEdBQUEscUJBQ0EsRUFBQSxnQkFBQSxXQUFBLEtBQUEsRUFBQSxZQUVBLEVBQUEsaUJBQUEsV0FDQSxTQUFBLEVBQUEsU0FBQSxVQUFBLEtBQUEsRUFBQSxTQUFBLFVBQ0EsRUFBQSxnQkFBQSxXQUFBLE1BQUEsU0FBQSxFQUFBLFNBQUEsU0FBQSxxQkFHQSxFQUFBLG9CQUFBLFdBQ0EsRUFBQSxVQUFBLGVBQUEsVUFFQSxFQUFBLGlCQUFBLFdBQ0EsR0FBQSxTQUFBLEVBQUEsZ0JBQUEsQ0FDQSxHQUFBLEdBQUEsRUFBQSxnQkFBQSxXQUFBLE1BQ0EsR0FBQSxVQUFBLEVBQUEsZ0JBQUEsV0FBQSxFQUFBLE9BRUEsR0FBQSxjQUdBLEVBQUEsZ0JBQUEsRUFDQSxFQUFBLG1CQUNBLEVBQUEsd0JBQUEsUUFBQSxLQUFBLEdBQ0EsRUFBQSxtQkFDQSxFQUFBLE1BQUEsRUFDQSxFQUFBLGlCQUFBLGlCQUNBLEVBQUEsZ0JBQUEsZ0JBQ0EsRUFBQSxTQUFBLFNBQ0EsRUFBQSxlQUFBLFNBQUEsRUFBQSxHQUNBLE1BR0EsR0FBQSxlQUhBLEVBQUEsT0FHQSxFQUZBLElBS0EsRUFBQSxjQUFBLFNBQUEsR0FDQSxFQUFBLFVBQUEsR0FFQSxFQUFBLGtCQUFBLEVBQUEsa0JBQ0EsRUFBQSx3QkFBQSxFQUFBLHdCQUNBLEVBQUEsc0JBQUEsV0FDQSxFQUFBLGdCQUFBLFFBQUEsS0FBQSxFQUFBLHlCQUNBLEVBQUEsVUFBQSxFQUFBLGdCQUFBLFdBQUEsSUFFQSxFQUFBLHlCQUFBLFdBQ0EsT0FBQSxRQUFBLE9BQUEsRUFBQSxnQkFBQSxFQUFBLDBCQUVBLEVBQUEsdUJBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLE9BQ0EsR0FBQSxRQUFBLE9BQUEsRUFBQSxnQkFBQSxFQUFBLHlCQUNBLEVBQUEsRUFBQSxnQkFBQSxLQUNBLFFBQUEsR0FBQSxJQUFBLEdBRUEsRUFBQSxtQkFBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsTUFRQSxPQVBBLFNBQUEsUUFBQSxFQUFBLGdCQUFBLFdBQUEsU0FBQSxHQUNBLFNBQUEsRUFBQSxVQUFBLEtBQUEsRUFBQSxTQUNBLEdBQUEsR0FDQSxTQUFBLEVBQUEsZ0JBQUEsSUFBQSxFQUFBLGVBQUEsVUFDQSxHQUFBLEtBR0EsR0FFQSxFQUFBLG9CQUFBLFdBQ0EsRUFBQSxJQUFBLG9CQUFBLEVBQUEsaUJBQUEsS0FBQSxXQUNBLEVBQUEsMkNBQ0EsRUFBQSxLQUFBLG9CQUFBLEVBQUEsZ0JBQUEsTUFBQSxXQUNBLEVBQUEsZ0JBQUEsT0FBQSxFQUNBLEVBQUEsd0JBQUEsUUFBQSxLQUFBLEVBQUEsaUJBQ0EsRUFBQSxJQUFBLGlCQUFBLEVBQUEsZ0JBQUEsT0FDQSxFQUFBLG9CQUNBLFNBQUEsR0FDQSxlQUFBLEVBQUEsRUFBQSxTQUdBLEVBQUEseUJBQUEsV0FDQSxPQUFBLEVBQUEsZ0JBQUEsT0FHQSxFQUFBLHlDQUFBLFdBQ0EsR0FBQSxHQUFBLEVBQUEsZ0JBQUEsTUFDQSxFQUFBLEVBQUEsd0JBQUEsS0FDQSxLQUFBLEdBQ0EsRUFBQSxPQUFBLHFCQUFBLEdBQUEsS0FBQSxhQUNBLFNBQUEsR0FDQSxlQUFBLEVBQUEsRUFBQSxTQUlBLEVBQUEsc0JBQUEsV0FDQSxHQUFBLElBQUEsT0FBQSwwQkFBQSxRQUFBLDBEQUNBLEVBQUEsc0JBQUEsRUFBQSxFQUNBLEdBQUEsT0FBQSxLQUFBLFdBQ0EsRUFBQSxPQUFBLHFCQUFBLEVBQUEsd0JBQUEsT0FBQSxLQUFBLFdBQ0EsRUFBQSxLQUFBLE1BQ0EsU0FBQSxHQUNBLGVBQUEsRUFBQSxFQUFBLFNBRUEsZUFJQSxFQUFBLG1CQUFBLFdBQ0EsTUFBQSxHQUFBLGdCQUFBLE1BQ0Esd0JBRUEscUJBSUEsRUFBQSxzQkN0SEEsUUFBQSxPQUFBLG1CQUNBLFdBQUEsY0FBQSxTQUFBLFNBQUEsUUFBQSxZQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsRUFBQSxtQkFBQSxXQUNBLE1BQUEsR0FBQSxNQUNBLFlBQUEsK0NBQ0EsV0FBQSxxQkFDQSxTQUNBLEtBQUEsV0FDQSxjQU1BLEVBQUEsV0FBQSxXQUNBLEdBQUEsR0FBQSxFQUFBLG9CQUNBLFVBQUEsR0FDQSxFQUFBLE9BQUEsS0FBQSxTQUFBLEdBQ0EsR0FBQSxLQUNBLEdBQUEsS0FBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsS0FBQSxFQUFBLEtBQUEsa0JBRUEsRUFBQSxRQUFBLFFBQUEsU0FBQSxHQUNBLEVBQUEsTUFBQSxLQUFBLEVBQUEsU0FFQSwwQkFBQSxHQUFBLEdBQUEsT0FBQSxLQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxRQUNBLEVBQUEsRUFBQSxNQUNBLEdBQUEsSUFBQSxxQkFBQSxLQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxJQUNBLEdBQUEsU0FDQSxXQUFBLEVBQ0EsUUFBQSxFQUNBLGlCQUFBLEdBRUEsUUFBQSxHQUNBLEVBQUEsSUFBQSxFQUFBLFNBQ0EsRUFBQSxTQUFBLEdBRUEsRUFBQSxTQUFBLFNBT0EsRUFBQSxJQUFBLFNBQUEsR0FDQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxvQkFBQSxFQUNBLEVBQUEsV0FBQSxHQUNBLEVBQUEsS0FBQSxtQkFBQSxHQUFBLEtBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLElBQ0EsUUFBQSxFQUFBLFFBQ0EsRUFBQSxXQUFBLEVBQUEsWUFBQSxRQUFBLFVBQUEsWUFDQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxvQkFBQSxHQUNBLFdBQUEsRUFBQSxRQUNBLEVBQUEsV0FBQSxFQUFBLFlBQUEsUUFBQSxVQUFBLFlBQ0EsRUFBQSx1QkFBQSxFQUNBLEVBQUEsb0JBQUEsR0FHQSxlQUFBLEVBQUEsR0FFQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxvQkFBQSxHQUNBLFNBQUEsR0FDQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxvQkFBQSxFQUNBLGVBQUEsRUFBQSxFQUFBLFNBR0EsRUFBQSxtQkFBQSxXQUNBLE1BQUEsb0JBQ0EsRUFBQSxzQkFDQSxFQUFBLG1CQUNBLEVBQUEsYUFBQSxJQUdBLEVBQUEseUJBQUEsV0FDQSxNQUFBLDBCQUNBLEVBQUEsc0JBQ0EsRUFBQSxtQkFDQSxFQUFBLGFBQUEsU0FHQSxFQUFBLHFCQUFBLFdBQ0EsTUFBQSxHQUFBLHFCQUFBLEVBQUEsd0JBRUEsRUFBQSxLQUFBLFdBQ0EsRUFBQSx1QkFBQSxFQUNBLEVBQUEsb0JBQUEsRUFDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSxnQkFDQSxFQUFBLFdBQUEsR0FDQSxFQUFBLGFBQ0EsRUFBQSxTQUFBLEdBRUEsRUFBQSxPQUFBLFdBQ0EsTUFBQSxHQUFBLFdBQUEsTUFBQSxFQUFBLE9BQUEsSUFBQSxFQUFBLE9BQUEsb0JBRUEsRUFBQSxVQUVBLFdBQUEsc0JBQUEsU0FBQSxRQUFBLFNBQUEsaUJBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsT0FBQSxRQUFBLFlBQ0EsV0FBQSxFQUFBLEVBQUEsRUFBQSxJQUNBLEVBQUEsUUFBQSxTQUFBLEdBQ0EsUUFBQSxFQUFBLEVBQUEsRUFBQSxJQUVBLEVBQUEscUJBQUEsV0FDQSxFQUFBLFFBQUEsV0FFQSxFQUFBLGlCQUFBLFdBQ0EsR0FBQSxJQUFBLFFBQUEsV0FDQSxTQUFBLFFBQUEsRUFBQSxNQUFBLEtBQUEsU0FBQSxHQUNBLEVBQUEsVUFDQSxFQUFBLEtBQUEsTUFBQSxLQUFBLEVBQUEsU0FBQSxFQUFBLFNBR0EsUUFBQSxRQUFBLEVBQUEsTUFBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLFVBQ0EsRUFBQSxRQUFBLE1BQUEsS0FBQSxFQUFBLFNBQUEsRUFBQSxLQUFBLGFBR0EsRUFBQSxNQUFBLElBRUEsRUFBQSxlQUFBLFdBQ0EsTUFBQSxLQUFBLEVBQUEsVUFFQSxFQUFBLFlBQUEsV0FDQSxHQUFBLElBQUEsQ0FhQSxPQVpBLFNBQUEsUUFBQSxFQUFBLE1BQUEsS0FBQSxTQUFBLEdBQ0EsRUFBQSxXQUNBLEdBQUEsS0FHQSxHQUNBLFFBQUEsUUFBQSxFQUFBLE1BQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxXQUNBLEdBQUEsS0FJQSxNQUdBLFdBQUEsb0JBQUEsU0FBQSxpQkFBQSxlQUFBLE9BQUEsYUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLFFBQUEsRUFBQSxRQUNBLEVBQUEsUUFBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLE9BQUEsUUFBQSxTQUFBLEdBQ0EsSUFDQSxFQUFBLE1BQUEsRUFBQSxJQUFBLEVBQUEsU0FBQSxJQUFBLEVBQUEsS0FDQSxNQUFBLEdBQ0EsUUFBQSxJQUFBLDZCQUFBLEVBQUEsU0FBQSxJQUFBLEVBQUEsS0FDQSxRQUFBLElBQUEsRUFBQSxjQUlBLEVBQUEsVUFBQSxTQUFBLEdBQ0EsTUFBQSxVQUFBLEVBQUEsUUFBQSxFQUFBLE9BQUEsT0FBQSxHQUVBLEVBQUEsR0FBQSxXQUNBLEVBQUEsT0FBQSxPQUFBLE1BQUEsUUFBQSxFQUFBLFdBRUEsRUFBQSxPQUFBLFdBQ0EsRUFBQSxRQUFBLFdBRUEsRUFBQSxXQUFBLFdBQ0EsTUFBQSxJQUVBLEVBQUEsT0FBQSxXQUNBLEVBQUEsT0FBQSxPQUFBLE1BQUEsUUFBQSxFQUFBLFdBRUEsRUFBQSxlQUFBLFNBQUEsRUFBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLE9BQUEsR0FBQSxjQUFBLEVBQUEsTUFBQSxHQUNBLEVBQUEsRUFBQSxPQUFBLEdBQUEsY0FBQSxFQUFBLE1BQUEsRUFDQSxPQUFBLEdBQUEsTUNqTEEsUUFBQSxPQUFBLGtCQUNBLFdBQUEsYUFBQSxTQUFBLFFBQUEsU0FBQSxZQUFBLGVBQUEsS0FBQSxnQkFBQSxRQUFBLFFBQUEsbUJBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLGdCQUNBLEVBQUEsVUFBQSxXQUNBLEtBQUEsRUFBQSxNQUFBLE1BQ0EsRUFBQSxPQUFBLE1BQ0EsRUFBQSxlQUFBLEVBQUEsTUFBQSxLQUFBLFdBRUEsRUFBQSxPQUFBLFFBR0EsRUFBQSxhQUFBLFdBQ0EsR0FBQSxJQUFBLENBQ0EsVUFBQSxFQUFBLGVBQ0EsRUFBQSxnQkFBQSxHQUVBLEVBQUEsZ0JBQUEsRUFBQSxlQUNBLEVBQUEsRUFBQSxnQkFFQSxFQUFBLFFBQ0EsTUFBQSxFQUFBLGVBQ0EsWUFBQSxFQUFBLGVBQ0EsS0FBQSxFQUFBLGVBQ0EsVUFBQSxFQUFBLGVBQ0EsYUFBQSxFQUFBLGVBQ0EsVUFBQSxFQUFBLGVBQ0EsVUFBQSxJQUdBLEVBQUEsTUFBQSxFQUNBLEVBQUEsTUFBQSxFQUNBLEVBQUEsaUJBQUEsRUFDQSxFQUFBLFdBQUEsUUFBQSxPQUFBLFFBQ0EsRUFBQSxlQUFBLFlBQ0EsRUFBQSxvQkFBQSxFQUNBLEVBQUEsdUJBQUEsRUFDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSxlQUNBLEVBQUEsY0FBQSxRQUFBLEtBQUEsRUFDQSxJQUFBLEdBQUEsRUFBQSxNQUFBLEtBQUEsTUFBQSxJQUNBLEdBQUEsUUFBQSxFQUFBLE1BQUEsRUFBQSxFQUFBLE9BQUEsR0FBQSxLQUFBLEtBQ0EsS0FBQSxFQUFBLFVBQ0EsRUFBQSxTQUFBLEtBRUEsRUFBQSxZQUNBLEVBQUEsU0FBQSxTQUNBLEVBQUEsZUFBQSxFQUFBLGVBQ0EsRUFBQSxhQUFBLFdBQ0EsR0FBQSxHQUFBLEVBQUEsVUFBQSxPQUNBLEdBQUEsUUFBQSxPQUFBLEVBQUEsTUFBQSxFQUFBLGNBQ0EsT0FBQSxJQUFBLEdBRUEsRUFBQSxnQkFBQSxnQkFFQSxFQUFBLFVBQUEsV0FDQSxHQUFBLEVBQUEsZUFFQSxHQURBLEVBQUEsTUFBQSxLQUFBLEVBQUEsUUFBQSxFQUFBLE1BQUEsS0FBQSxTQUNBLFNBQUEsRUFBQSxPQUFBLENBQ0EsR0FBQSxHQUFBLEVBQUEsUUFBQSxNQUFBLEtBQ0EsRUFBQSxFQUFBLE1BQUEsRUFBQSxFQUFBLE9BQUEsR0FBQSxLQUFBLElBQ0EsTUFBQSxJQUNBLEdBQUEsS0FFQSxFQUFBLEtBQUEsc0JBQUEsRUFBQSxPQUFBLEtBQUEsV0FDQSxFQUFBLEtBQUEsa0JBQUEsRUFBQSxFQUFBLE1BQUEsTUFDQSxFQUFBLGNBQUEsUUFBQSxLQUFBLEVBQUEsUUFDQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEVBQUEsRUFBQSxZQUdBLEdBQUEsTUFBQSxPQUFBLEVBQUEsY0FBQSxPQUNBLEVBQUEsTUFBQSxhQUFBLEVBQUEsY0FBQSxNQUVBLEVBQUEsSUFBQSxzQkFBQSxFQUFBLE9BQUEsS0FBQSxXQUNBLEVBQUEsY0FBQSxRQUFBLEtBQUEsRUFBQSxRQUNBLFNBQUEsR0FDQSxFQUFBLGVBQUEsRUFBQSxFQUFBLFNBS0EsRUFBQSxZQUFBLFdBQ0EsTUFBQSxHQUFBLFVBQUEsU0FBQSxFQUFBLHVCQUdBLEVBQUEsU0FBQSxXQUNBLEVBQUEsZ0JBQ0EsRUFBQSxZQUNBLEVBQUEsa0JBQUEsT0FBQSxLQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxPQUNBLEdBQUEsZUFBQSxXQUNBLEVBQUEsaUJBQUEsV0FDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSx1QkFBQSxFQUNBLEVBQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxPQUFBLFFBQUEsU0FBQSxHQUNBLEVBQUEsSUFBQSxFQUFBLFNBQUEsSUFBQSxFQUFBLElBQUEsRUFBQSxVQUdBLElBQUEsSUFDQSxhQUFBLEtBQUEsRUFBQSxNQUFBLE9BQ0EsUUFBQSxFQUNBLGlCQUFBLEVBQUEsaUJBRUEsR0FBQSxLQUFBLG1CQUFBLEdBQUEsS0FBQSxTQUFBLEdBQ0EsRUFBQSxtQkFBQSxPQUFBLEVBQUEsS0FBQSxPQUNBLEVBQUEsdUJBQUEsRUFDQSxFQUFBLFdBQUEsRUFBQSxLQUFBLEtBQ0EsU0FBQSxHQUNBLEVBQUEsb0JBQUEsRUFDQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxlQUFBLEVBQUEsRUFBQSxTQUVBLFNBQUEsR0FDQSxFQUFBLGVBQUEsRUFBQSxFQUFBLFVBSUEsRUFBQSxXQUFBLFNBQUEsR0FDQSxFQUFBLElBQUEsMEJBQUEsR0FBQSxLQUFBLFNBQUEsR0FDQSxFQUFBLFFBQUEsRUFBQSxLQUNBLEVBQUEsUUFBQSxHQUFBLEVBQ0EsRUFBQSxnQkFBQSxFQUFBLFVBQ0EsU0FBQSxHQUVBLEVBQUEsZUFBQSxFQUFBLEVBQUEsU0FHQSxFQUFBLGFBQUEsU0FBQSxFQUFBLEdBQ0EsTUFBQSx5QkFBQSxFQUFBLElBQUEsR0FHQSxFQUFBLGdCQUFBLFdBQ0EsTUFBQSwyQkFBQSxHQUFBLElBRUEsRUFBQSxxQkFBQSxXQUNBLE1BQUEsR0FBQSxxQkFBQSxFQUFBLHdCQUVBLEVBQUEsbUJBQUEsV0FDQSxNQUFBLG9CQUNBLEVBQUEsc0JBQ0EsRUFBQSxtQkFDQSxFQUFBLGFBQUEsSUFHQSxFQUFBLGdCQUFBLFNBQUEsR0FDQSxFQUFBLGdCQUNBLEVBQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxNQUFBLFFBQUEsU0FBQSxHQUNBLFlBQUEsRUFBQSxRQUNBLEVBQUEsYUFBQSxNQUFBLEtBQUEsRUFBQSxZQUtBLEVBQUEsZ0JBQUEsV0FDQSxNQUFBLFVBQUEsRUFBQSxjQUFBLEVBQUEsYUFBQSxPQUFBLEdBRUEsRUFBQSx5QkFBQSxXQUNBLE1BQUEsMEJBQ0EsRUFBQSxzQkFDQSxFQUFBLG1CQUNBLEVBQUEsYUFBQSxTQUdBLEVBQUEsd0JBQUEsRUFBQSx3QkFDQSxFQUFBLFdBQUEsU0FBQSxHQUNBLEVBQUEsVUFFQSxFQUFBLG1CQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsTUFBQSxHQUFBLFFBQUEsU0FBQSxjQUFBLE1BRUEsRUFBQSxZQUFBLFdBQ0EsRUFBQSxNQUFBLFFBQUEsS0FBQSxFQUFBLGVBQ0EsRUFBQSxVQUFBLGdCQUVBLEVBQUEsZUFBQSxXQUNBLE9BQUEsUUFBQSxPQUFBLEVBQUEsTUFBQSxFQUFBLGdCQUVBLEVBQUEsZUFBQSxXQUNBLE1BQUEsUUFBQSxFQUFBLFNBQUEsRUFBQSx1QkFHQSxFQUFBLFlBQUEsV0FDQSxHQUFBLEdBQUEsRUFBQSxRQUFBLEVBQUEsTUFBQSxLQUFBLFFBQ0EsYUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLElBRUEsRUFBQSxhQUFBLEVBQUEsa0JBRUEsRUFBQSxpQkFBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsSUFBQSxpQkFDQSxPQUFBLFVBQUEsR0FBQSxLQUFBLEVBQ0EsRUFBQSxtQkFBQSxHQUVBLEVBQUEsT0FBQSxXQUFBLEdBQUEsS0FBQSxxRUFBQSxJQUlBLEVBQUEsZUFBQSxrQkN0TUEsUUFBQSxPQUFBLG9CQUNBLFdBQUEscUJBQUEsU0FBQSxTQUFBLFlBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsRUFBQSxVQUFBLFdBQ0EsRUFBQSxNQUNBLFlBQUEsaUNBQ0EsV0FBQSxjQUNBLFNBQ0EsS0FBQSxXQUNBLGNBS0EsRUFBQSxtQkFBQSxXQUNBLEVBQUEsbUJBQUEsSUFFQSxFQUFBLFNBQUEsV0FDQSxHQUFBLEdBQUEsRUFBQSxNQUNBLE9BQUEsS0FBQSxFQUFBLFFBQUEsbUJBQ0EsYUFDQSxJQUFBLEVBQUEsUUFBQSxrQkFDQSxZQUNBLElBQUEsRUFBQSxRQUFBLG9CQUNBLGFBQ0EsSUFBQSxFQUFBLFFBQUEsa0JBQ0EsVUFFQSIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdzdG9yaWVzTW9kdWxlJywgW1xyXG4gICAgJ25nUm91dGUnLFxyXG4gICAgJ25nQ29va2llcycsXHJcbiAgICAndWkuYm9vdHN0cmFwJyxcclxuICAgICd1aS5zb3J0YWJsZScsXHJcbiAgICAnY29uZmlnTW9kdWxlJyxcclxuICAgICdib2R5TW9kdWxlJyxcclxuICAgICd0b3BNZW51TW9kdWxlJyxcclxuICAgICdzdG9yeU1vZHVsZScsXHJcbiAgICAnY29tcG9zaXRlQ2xhc3Nlc01vZHVsZScsXHJcbiAgICAnY29tcG9zaXRlc01vZHVsZScsXHJcbiAgICAncnVubmVyTW9kdWxlJ1xyXG5dKVxyXG4gICAgLnNlcnZpY2UoJ1RjQmRkU2VydmljZScsIGZ1bmN0aW9uKCRtb2RhbCkge1xyXG4gICAgICAgIHRoaXMub3BlbkNvbXBvc2l0ZUNsYXNzID0gZnVuY3Rpb24oY29tcG9zaXRlU3RlcFRleHQpIHtcclxuICAgICAgICAgICAgJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvY29tcG9zaXRlQ2xhc3Nlcy9jb21wb3NpdGVDbGFzc2VzLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnY29tcG9zaXRlQ2xhc3Nlc0N0cmwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvc2l0ZUNsYXNzZXM6IGZ1bmN0aW9uKCRyb3V0ZSwgJGh0dHAsICRtb2RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0SnNvbigkaHR0cCwgJG1vZGFsLCAnL2dyb292eUNvbXBvc2l0ZXMnLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBjb21wb3NpdGVTdGVwVGV4dDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb3NpdGVTdGVwVGV4dDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5uZXdDb2xsZWN0aW9uSXRlbSA9IGZ1bmN0aW9uKGV2ZW50LCBjb2xsZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGlmIChldmVudC53aGljaCA9PT0gMTMpIHtcclxuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24ucHVzaCh7fSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMucmVtb3ZlQ29sbGVjdGlvbkVsZW1lbnQgPSBmdW5jdGlvbihjb2xsZWN0aW9uLCBpbmRleCkge1xyXG4gICAgICAgICAgICBjb2xsZWN0aW9uLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmJ1dHRvbkNzc0NsYXNzID0gZnVuY3Rpb24obmdNb2RlbENvbnRyb2xsZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICdidG4tc3VjY2Vzcyc6IG5nTW9kZWxDb250cm9sbGVyLiR2YWxpZCxcclxuICAgICAgICAgICAgICAgICdidG4tZGFuZ2VyJzogbmdNb2RlbENvbnRyb2xsZXIuJGludmFsaWRcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0UnVubmVyUHJvZ3Jlc3NDc3MgPSBmdW5jdGlvbihpblByb2dyZXNzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAncHJvZ3Jlc3MgcHJvZ3Jlc3Mtc3RyaXBlZCBhY3RpdmUnOiBpblByb2dyZXNzLFxyXG4gICAgICAgICAgICAgICAgJ3Byb2dyZXNzJzogIWluUHJvZ3Jlc3NcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9O1xyXG4gICAgfSlcclxuICAgIC5jb250cm9sbGVyKCdtb2RhbEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRtb2RhbEluc3RhbmNlLCBkYXRhKSB7XHJcbiAgICAgICAgJHNjb3BlLmRhdGEgPSBkYXRhO1xyXG4gICAgICAgICRzY29wZS5vayA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoJ29rJyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcclxuICAgICAgICB9O1xyXG4gICAgfSlcclxuICAgIC5jb250cm9sbGVyKCdzdG9yaWVzQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRtb2RhbCwgJG1vZGFsSW5zdGFuY2UsICRsb2NhdGlvbiwgJHEpIHtcclxuICAgICAgICBnZXRTdG9yaWVzKCRzY29wZSwgJGh0dHAsICRtb2RhbCwgJycpO1xyXG4gICAgICAgICRzY29wZS5vcGVuRGlyID0gZnVuY3Rpb24ocGF0aCkge1xyXG4gICAgICAgICAgICBvcGVuRGlyKCRzY29wZSwgJGh0dHAsICRtb2RhbCwgcGF0aCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS52aWV3U3RvcnlVcmwgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRWaWV3U3RvcnlVcmwoKSArICRzY29wZS5yb290UGF0aCArIG5hbWU7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuYWxsb3dUb1ByZXZEaXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5yb290UGF0aCAhPT0gJyc7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUuZGVsZXRlU3RvcnkgPSBmdW5jdGlvbihuYW1lLCBpbmRleCkge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9ICRzY29wZS5yb290UGF0aCArIG5hbWUgKyAnLnN0b3J5JztcclxuICAgICAgICAgICAgZGVsZXRlU3RvcnkoJG1vZGFsLCAkaHR0cCwgJGxvY2F0aW9uLCAkcSwgcGF0aCkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5maWxlcy5zdG9yaWVzLnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLmNyZWF0ZURpcmVjdG9yeSA9IGZ1bmN0aW9uKHBhdGgpIHtcclxuICAgICAgICAgICAgdmFyIGpzb24gPSAne1wicGF0aFwiOiBcIicgKyAkc2NvcGUucm9vdFBhdGggKyBwYXRoICsgJ1wifSc7XHJcbiAgICAgICAgICAgICRodHRwLnBvc3QoJy9zdG9yaWVzL2Rpci5qc29uJywganNvbikudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5maWxlcy5kaXJzLnB1c2goe25hbWU6IHBhdGh9KTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIG9wZW5FcnJvck1vZGFsKCRtb2RhbCwgcmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLmdldE5ld1N0b3J5VXJsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXROZXdTdG9yeVVybCgpO1xyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxuXHJcbi8vIFRPRE8gVGVzdFxyXG5mdW5jdGlvbiBnZXRKc29uKCRodHRwLCAkbW9kYWwsIHVybCwgY2FjaGVUeXBlKSB7XHJcbiAgICByZXR1cm4gJGh0dHAuZ2V0KHVybCwge2NhY2hlOiBjYWNoZVR5cGV9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XHJcbiAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIG9wZW5FcnJvck1vZGFsKCRtb2RhbCwgcmVzcG9uc2UuZGF0YSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy8gVE9ETyBUZXN0XHJcbmZ1bmN0aW9uIG9wZW5FcnJvck1vZGFsKCRtb2RhbCwgZGF0YSkge1xyXG4gICAgJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL2Fzc2V0cy9odG1sL2Vycm9yTW9kYWwudG1wbC5odG1sJyxcclxuICAgICAgICBjb250cm9sbGVyOiAnbW9kYWxDdHJsJyxcclxuICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0Vmlld1N0b3J5VXJsKCkge1xyXG4gICAgcmV0dXJuICcvcGFnZS9zdG9yaWVzL3ZpZXcvJztcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0TmV3U3RvcnlVcmwoKSB7XHJcbiAgICByZXR1cm4gJy9wYWdlL3N0b3JpZXMvbmV3Lyc7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldENvbXBvc2l0ZXNVcmwoKSB7XHJcbiAgICByZXR1cm4gJy9wYWdlL2NvbXBvc2l0ZXMvJztcclxufVxyXG5cclxuLy8gVE9ETyBUZXN0XHJcbmZ1bmN0aW9uIGRlbGV0ZVN0b3J5KCRtb2RhbCwgJGh0dHAsICRsb2NhdGlvbiwgJHEsIHBhdGgpIHtcclxuICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcbiAgICB2YXIgbWVzc2FnZSA9IHtzdGF0dXM6ICdEZWxldGUgU3RvcnknLCBtZXNzYWdlOiAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIHN0b3J5Pyd9O1xyXG4gICAgdmFyIG9rTW9kYWwgPSBvcGVuQ29uZmlybWF0aW9uTW9kYWwoJG1vZGFsLCBtZXNzYWdlKTtcclxuICAgIG9rTW9kYWwucmVzdWx0LnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgJGh0dHAuZGVsZXRlKCcvc3Rvcmllcy9zdG9yeS8nICsgcGF0aCkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoZ2V0TmV3U3RvcnlVcmwoKSk7XHJcbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoJ09LJyk7XHJcbiAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgb3BlbkVycm9yTW9kYWwoJG1vZGFsLCByZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCdOT0snKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGRlZmVycmVkLnJlamVjdCgnTk9LJyk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG59XHJcblxyXG4vLyBUT0RPIFRlc3RcclxuZnVuY3Rpb24gY3NzQ2xhc3MobmdNb2RlbENvbnRyb2xsZXIpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgJ2hhcy1lcnJvcic6IG5nTW9kZWxDb250cm9sbGVyLiRpbnZhbGlkLFxyXG4gICAgICAgICdoYXMtc3VjY2Vzcyc6IG5nTW9kZWxDb250cm9sbGVyLiR2YWxpZCAmJiBuZ01vZGVsQ29udHJvbGxlci4kZGlydHlcclxuICAgIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsYXNzTmFtZVBhdHRlcm4oKSB7XHJcbiAgICByZXR1cm4gKC9eW2EtekEtWl8kXVthLXpBLVpcXGRfJF0qJC8pO1xyXG59IiwiYW5ndWxhci5tb2R1bGUoJ2NvbmZpZ01vZHVsZScsIFtdKVxyXG4gICAgLmNvbmZpZyhmdW5jdGlvbigkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcclxuICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XHJcbiAgICAgICAgJHJvdXRlUHJvdmlkZXJcclxuICAgICAgICAgICAgLy8gVE9ETyBSZW1vdmUgZHVwbGljYXRpb24gaW4gcmVzb2x2ZVxyXG4gICAgICAgICAgICAud2hlbihnZXROZXdTdG9yeVVybCgpLCB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9zdG9yeS9zdG9yeS50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3N0b3J5Q3RybCcsXHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBzdG9yeTogZnVuY3Rpb24oJGh0dHAsICRtb2RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0SnNvbigkaHR0cCwgJG1vZGFsLCAnL3N0b3JpZXMvc3RvcnkuanNvbicsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHN0ZXBzOiBmdW5jdGlvbigkaHR0cCwgJG1vZGFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRKc29uKCRodHRwLCAkbW9kYWwsICcvc3RlcHMvbGlzdC5qc29uJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBncm9vdnlDb21wb3NpdGVzOiBmdW5jdGlvbigkaHR0cCwgJG1vZGFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRKc29uKCRodHRwLCAkbW9kYWwsICcvZ3Jvb3Z5Q29tcG9zaXRlcycsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLndoZW4oZ2V0TmV3U3RvcnlVcmwoKSArICc6cGF0aConLCB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9zdG9yeS9zdG9yeS50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3N0b3J5Q3RybCcsXHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBzdG9yeTogZnVuY3Rpb24oJHJvdXRlLCAkaHR0cCwgJG1vZGFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRKc29uKCRodHRwLCAkbW9kYWwsICcvc3Rvcmllcy9zdG9yeS5qc29uP3BhdGg9JyArICRyb3V0ZS5jdXJyZW50LnBhcmFtcy5wYXRoICsgJy5zdG9yeScsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHN0ZXBzOiBmdW5jdGlvbigkaHR0cCwgJG1vZGFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRKc29uKCRodHRwLCAkbW9kYWwsICcvc3RlcHMvbGlzdC5qc29uJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBncm9vdnlDb21wb3NpdGVzOiBmdW5jdGlvbigkaHR0cCwgJG1vZGFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnZXRKc29uKCRodHRwLCAkbW9kYWwsICcvZ3Jvb3Z5Q29tcG9zaXRlcycsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLndoZW4oZ2V0Vmlld1N0b3J5VXJsKCkgKyAnOnBhdGgqJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvc3Rvcnkvc3RvcnkudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzdG9yeUN0cmwnLFxyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3Rvcnk6IGZ1bmN0aW9uKCRyb3V0ZSwgJGh0dHAsICRtb2RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0SnNvbigkaHR0cCwgJG1vZGFsLCAnL3N0b3JpZXMvc3RvcnkuanNvbj9wYXRoPScgKyAkcm91dGUuY3VycmVudC5wYXJhbXMucGF0aCArICcuc3RvcnknLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBzdGVwczogZnVuY3Rpb24oJGh0dHAsICRtb2RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0SnNvbigkaHR0cCwgJG1vZGFsLCAnL3N0ZXBzL2xpc3QuanNvbicsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZ3Jvb3Z5Q29tcG9zaXRlczogZnVuY3Rpb24oJGh0dHAsICRtb2RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0SnNvbigkaHR0cCwgJG1vZGFsLCAnL2dyb292eUNvbXBvc2l0ZXMnLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVsb2FkT25TZWFyY2g6IGZhbHNlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC53aGVuKGdldENvbXBvc2l0ZXNVcmwoKSArICc6Y2xhc3NOYW1lKicsIHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2Fzc2V0cy9odG1sL2NvbXBvc2l0ZXMvY29tcG9zaXRlcy50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2NvbXBvc2l0ZXNDdHJsJyxcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvc2l0ZXNDbGFzczogZnVuY3Rpb24oJHJvdXRlLCAkaHR0cCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q29tcG9zaXRlc0pzb24oJGh0dHAsICRyb3V0ZS5jdXJyZW50LnBhcmFtcy5jbGFzc05hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3RlcHM6IGZ1bmN0aW9uKCRodHRwLCAkbW9kYWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGdldEpzb24oJGh0dHAsICRtb2RhbCwgJy9zdGVwcy9saXN0Lmpzb24nLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAud2hlbignL3BhZ2UvcnVubmVyLycsIHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2Fzc2V0cy9odG1sL3J1bm5lci9ydW5uZXIudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdydW5uZXJDdHJsJyxcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uKCRyb3V0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge3JlcG9ydHNQYXRoOiAkcm91dGUuY3VycmVudC5wYXJhbXMucGF0aH07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAgICAgLm90aGVyd2lzZSh7XHJcbiAgICAgICAgICAgICAgICByZWRpcmVjdFRvOiAnL3BhZ2Uvc3Rvcmllcy9uZXcnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdib2R5TW9kdWxlJywgW10pXHJcbiAgICAuY29udHJvbGxlcignYm9keUN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkY29va2llU3RvcmUsICRsb2NhdGlvbiwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHNjb3BlLmhpc3RvcnkgPSAkY29va2llU3RvcmUuZ2V0KCdoaXN0b3J5Jyk7XHJcbiAgICAgICAgaWYgKCRzY29wZS5oaXN0b3J5ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmhpc3RvcnkgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgJHNjb3BlLmFkZEhpc3RvcnlJdGVtID0gZnVuY3Rpb24odGV4dCkge1xyXG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLmhpc3RvcnksIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS50ZXh0ID09PSB0ZXh0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlbW92ZUhpc3RvcnlJdGVtKGtleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB3aGlsZSgkc2NvcGUuaGlzdG9yeS5sZW5ndGggPj0gMTApIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZW1vdmVIaXN0b3J5SXRlbSgkc2NvcGUuaGlzdG9yeS5sZW5ndGggLSAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkc2NvcGUuaGlzdG9yeS5zcGxpY2UoMCwgMCwge3RleHQ6IHRleHQsIHVybDogJGxvY2F0aW9uLnBhdGgoKX0pO1xyXG4gICAgICAgICAgICAkY29va2llU3RvcmUucHV0KCdoaXN0b3J5JywgJHNjb3BlLmhpc3RvcnkpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnJlbW92ZUhpc3RvcnlJdGVtID0gZnVuY3Rpb24oaW5kZXgpIHtcclxuICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLnJlbW92ZUNvbGxlY3Rpb25FbGVtZW50KCRzY29wZS5oaXN0b3J5LCBpbmRleCk7XHJcbiAgICAgICAgICAgICRjb29raWVTdG9yZS5wdXQoJ2hpc3RvcnknLCAkc2NvcGUuaGlzdG9yeSk7XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG4iLCIvLyBUT0RPIFRlc3RcclxuZnVuY3Rpb24gb3BlbkNvbmZpcm1hdGlvbk1vZGFsKCRtb2RhbCwgZGF0YSkge1xyXG4gICAgcmV0dXJuICRtb2RhbC5vcGVuKHtcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9jb25maXJtYXRpb25Nb2RhbC50bXBsLmh0bWwnLFxyXG4gICAgICAgIGNvbnRyb2xsZXI6ICdtb2RhbEN0cmwnLFxyXG4gICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBUT0RPIFRlc3RcclxuZnVuY3Rpb24gZ2V0Q29tcG9zaXRlc0pzb24oaHR0cCwgZmlsZU5hbWUpIHtcclxuICAgIHZhciB1cmwgPSAnL2dyb292eUNvbXBvc2l0ZXMvJyArIGZpbGVOYW1lO1xyXG4gICAgcmV0dXJuIGh0dHAuZ2V0KHVybCwge2NhY2hlOiBmYWxzZX0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcclxuICAgIH0sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBjbGFzc05hbWUgPSBmaWxlTmFtZS5zdWJzdHJpbmcoMCwgZmlsZU5hbWUubGFzdEluZGV4T2YoJy4nKSk7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY2xhc3M6IGNsYXNzTmFtZSxcclxuICAgICAgICAgICAgY29tcG9zaXRlczpbe3N0ZXBUZXh0OiAnJywgY29tcG9zaXRlU3RlcHM6IFt7fV19XSxcclxuICAgICAgICAgICAgaXNOZXc6IHRydWVcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN0ZXBUZXh0UGF0dGVybigpIHtcclxuICAgIHJldHVybiAoL14oR2l2ZW58V2hlbnxUaGVuKSAuKyQvKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0U3Rvcmllcygkc2NvcGUsICRodHRwLCAkbW9kYWwsIHBhdGgpIHtcclxuICAgIGlmICgkc2NvcGUucm9vdFBhdGggPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICRzY29wZS5yb290UGF0aCA9ICcnO1xyXG4gICAgfVxyXG4gICAgJGh0dHAuZ2V0KCcvc3Rvcmllcy9saXN0Lmpzb24/cGF0aD0nICsgJHNjb3BlLnJvb3RQYXRoICsgcGF0aCkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICRzY29wZS5maWxlcyA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgaWYgKHBhdGggIT09ICcnKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5yb290UGF0aCArPSBwYXRoICsgJy8nO1xyXG4gICAgICAgIH1cclxuICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgb3BlbkVycm9yTW9kYWwoJG1vZGFsLCByZXNwb25zZS5kYXRhKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuRGlyKCRzY29wZSwgJGh0dHAsICRtb2RhbCwgcGF0aCkge1xyXG4gICAgaWYgKHBhdGggPT09ICcuLicpIHtcclxuICAgICAgICB2YXIgZGlycyA9ICRzY29wZS5yb290UGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgICRzY29wZS5yb290UGF0aCA9IGRpcnMuc2xpY2UoMCwgZGlycy5sZW5ndGggLSAyKS5qb2luKCcvJyk7XHJcbiAgICAgICAgaWYgKCRzY29wZS5yb290UGF0aCAhPT0gJycpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnJvb3RQYXRoICs9ICcvJztcclxuICAgICAgICB9XHJcbiAgICAgICAgZ2V0U3Rvcmllcygkc2NvcGUsICRodHRwLCAkbW9kYWwsICcnKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZ2V0U3Rvcmllcygkc2NvcGUsICRodHRwLCAkbW9kYWwsIHBhdGgpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBUT0RPIFRlc3RcclxuZnVuY3Rpb24gb3BlblJ1bm5lclBhcmFtZXRlcnNNb2RhbCgkbW9kYWwsIHNob3dHZXRBcGkpIHtcclxuICAgIHJldHVybiAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvcnVubmVyL3J1bm5lclBhcmFtcy50bXBsLmh0bWwnLFxyXG4gICAgICAgIGNvbnRyb2xsZXI6ICdydW5uZXJQYXJhbXNDdHJsJyxcclxuICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uKCRyb3V0ZSwgJGh0dHAsICRtb2RhbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldEpzb24oJGh0dHAsICRtb2RhbCwgJy9zdGVwcy9jbGFzc2VzLmpzb24nLCB0cnVlKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc2hvd0dldEFwaTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2hvd0dldEFwaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRSdW5uZXJTdGF0dXNDc3MoaW5Qcm9ncmVzcywgc3VjY2VzcywgcGVuZGluZ1N0ZXBzKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgICdwcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyLWluZm8nOiBpblByb2dyZXNzLFxyXG4gICAgICAgICdwcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyLXdhcm5pbmcnOiAhaW5Qcm9ncmVzcyAmJiBzdWNjZXNzICYmIHBlbmRpbmdTdGVwcyxcclxuICAgICAgICAncHJvZ3Jlc3MtYmFyIHByb2dyZXNzLWJhci1zdWNjZXNzJzogIWluUHJvZ3Jlc3MgJiYgc3VjY2VzcyAmJiAhcGVuZGluZ1N0ZXBzLFxyXG4gICAgICAgICdwcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyLWRhbmdlcic6ICFpblByb2dyZXNzICYmICFzdWNjZXNzXHJcbiAgICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRTdG9yeVJ1bm5lclN0YXR1c1RleHQoaW5Qcm9ncmVzcywgc3VjY2VzcywgcGVuZGluZ1N0ZXBzTGVuZ3RoKSB7XHJcbiAgICBpZiAoaW5Qcm9ncmVzcykge1xyXG4gICAgICAgIHJldHVybiAnU3RvcnkgcnVuIGlzIGluIHByb2dyZXNzJztcclxuICAgIH0gZWxzZSBpZiAoc3VjY2Vzcykge1xyXG4gICAgICAgIGlmIChwZW5kaW5nU3RlcHNMZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnU3RvcnkgcnVuIHdhcyBzdWNjZXNzZnVsIHdpdGggJyArIHBlbmRpbmdTdGVwc0xlbmd0aCArICcgcGVuZGluZyBzdGVwcyc7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuICdTdG9yeSBydW4gd2FzIHN1Y2Nlc3NmdWwnO1xyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuICdTdG9yeSBydW4gZmFpbGVkJztcclxuICAgIH1cclxufVxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnY29tcG9zaXRlQ2xhc3Nlc01vZHVsZScsIFtdKVxyXG4gICAgLmNvbnRyb2xsZXIoJ2NvbXBvc2l0ZUNsYXNzZXNDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJG1vZGFsSW5zdGFuY2UsIGNvbXBvc2l0ZUNsYXNzZXMsIGNvbXBvc2l0ZVN0ZXBUZXh0KSB7XHJcbiAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZUNsYXNzZXMgPSBjb21wb3NpdGVDbGFzc2VzO1xyXG4gICAgICAgICRzY29wZS5jb21wb3NpdGVTdGVwVGV4dCA9IGNvbXBvc2l0ZVN0ZXBUZXh0O1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZUNsYXNzVXJsID0gZnVuY3Rpb24ocGFja2FnZU5hbWUsIGNsYXNzTmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgdXJsID0gJy9wYWdlL2NvbXBvc2l0ZXMvJztcclxuICAgICAgICAgICAgaWYgKHBhY2thZ2VOYW1lICE9PSB1bmRlZmluZWQgJiYgcGFja2FnZU5hbWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICB1cmwgKz0gcGFja2FnZU5hbWUgKyAnLic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGNsYXNzTmFtZVBhcnRzO1xyXG4gICAgICAgICAgICBpZiAoY2xhc3NOYW1lLmluZGV4T2YoJy8nKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWVQYXJ0cyA9IGNsYXNzTmFtZS5zcGxpdCgnLycpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lUGFydHMgPSBjbGFzc05hbWUuc3BsaXQoJ1xcXFwnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB1cmwgKz0gY2xhc3NOYW1lUGFydHNbY2xhc3NOYW1lUGFydHMubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY29tcG9zaXRlU3RlcFRleHQgIT09IHVuZGVmaW5lZCAmJiAkc2NvcGUuY29tcG9zaXRlU3RlcFRleHQgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICB1cmwgKz0gJz9zdGVwVGV4dD0nICsgJHNjb3BlLmNvbXBvc2l0ZVN0ZXBUZXh0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB1cmw7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY29tcG9zaXRlQ2xhc3NUZXh0ID0gZnVuY3Rpb24oY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgICAgIHZhciBjbGFzc05hbWVQYXJ0cztcclxuICAgICAgICAgICAgaWYgKGNsYXNzTmFtZS5pbmRleE9mKCcvJykgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lUGFydHMgPSBjbGFzc05hbWUuc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZVBhcnRzID0gY2xhc3NOYW1lLnNwbGl0KCdcXFxcJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHRleHQgPSBjbGFzc05hbWVQYXJ0c1tjbGFzc05hbWVQYXJ0cy5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgaWYgKHRleHQuaW5kZXhPZignLicpID49IDApIHtcclxuICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnN1YnN0cigwLCB0ZXh0Lmxhc3RJbmRleE9mKCcuJykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0ZXh0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNsYXNzTmFtZVBhdHRlcm4gPSBjbGFzc05hbWVQYXR0ZXJuO1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5jc3NDbGFzcyA9IGNzc0NsYXNzO1xyXG4gICAgICAgICRzY29wZS5kYXRhID0ge2NsYXNzOiAnJ307XHJcbiAgICB9KTsiLCJhbmd1bGFyLm1vZHVsZSgnY29tcG9zaXRlc01vZHVsZScsIFtdKVxyXG4gICAgLmNvbnRyb2xsZXIoJ2NvbXBvc2l0ZXNDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJG1vZGFsLCAkbG9jYXRpb24sICRjb29raWVTdG9yZSwgY29tcG9zaXRlc0NsYXNzLCBzdGVwcywgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHNjb3BlLmFkZENvbXBvc2l0ZXNUYWIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCEkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmlzTmV3KSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWRkSGlzdG9yeUl0ZW0oJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5jbGFzcyArICcgY29tcG9zaXRlcycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuYWRkTmV3Q29tcG9zaXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGUgPSB7c3RlcFRleHQ6ICcnLCBjb21wb3NpdGVTdGVwczogW3t9XX07XHJcbiAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuY29tcG9zaXRlcy5wdXNoKCRzY29wZS5jb21wb3NpdGUpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmFkZFN0ZXBUZXh0UGFyYW0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCRsb2NhdGlvbi5zZWFyY2goKS5zdGVwVGV4dCAhPT0gdW5kZWZpbmVkICYmICRsb2NhdGlvbi5zZWFyY2goKS5zdGVwVGV4dCAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuY29tcG9zaXRlcy5wdXNoKHtzdGVwVGV4dDogJGxvY2F0aW9uLnNlYXJjaCgpLnN0ZXBUZXh0LCBjb21wb3NpdGVTdGVwczogW119KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmFkZE5ld0NvbXBvc2l0ZVN0ZXAgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZS5jb21wb3NpdGVTdGVwcy5wdXNoKHt9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zZXRMYXN0Q29tcG9zaXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY29tcG9zaXRlc0NsYXNzICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNvbXBvc2l0ZXMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZSA9ICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuY29tcG9zaXRlc1tsZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGUgPSB7fTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcyA9IGNvbXBvc2l0ZXNDbGFzcztcclxuICAgICAgICAkc2NvcGUuYWRkU3RlcFRleHRQYXJhbSgpO1xyXG4gICAgICAgICRzY29wZS5vcmlnaW5hbENvbXBvc2l0ZXNDbGFzcyA9IGFuZ3VsYXIuY29weShjb21wb3NpdGVzQ2xhc3MpO1xyXG4gICAgICAgICRzY29wZS5zZXRMYXN0Q29tcG9zaXRlKCk7XHJcbiAgICAgICAgJHNjb3BlLnN0ZXBzID0gc3RlcHM7XHJcbiAgICAgICAgJHNjb3BlLmNsYXNzTmFtZVBhdHRlcm4gPSBjbGFzc05hbWVQYXR0ZXJuO1xyXG4gICAgICAgICRzY29wZS5zdGVwVGV4dFBhdHRlcm4gPSBzdGVwVGV4dFBhdHRlcm47XHJcbiAgICAgICAgJHNjb3BlLmNzc0NsYXNzID0gY3NzQ2xhc3M7XHJcbiAgICAgICAgJHNjb3BlLmJ1dHRvbkNzc0NsYXNzID0gZnVuY3Rpb24oY29tcG9zaXRlQ2xhc3NGb3JtLCBjb21wb3NpdGVGb3JtKSB7XHJcbiAgICAgICAgICAgIGlmICghY29tcG9zaXRlQ2xhc3NGb3JtLiR2YWxpZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5idXR0b25Dc3NDbGFzcyhjb21wb3NpdGVDbGFzc0Zvcm0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5idXR0b25Dc3NDbGFzcyhjb21wb3NpdGVGb3JtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLm9wZW5Db21wb3NpdGUgPSBmdW5jdGlvbihjb21wb3NpdGUpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZSA9IGNvbXBvc2l0ZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5uZXdDb2xsZWN0aW9uSXRlbSA9IFRjQmRkU2VydmljZS5uZXdDb2xsZWN0aW9uSXRlbTtcclxuICAgICAgICAkc2NvcGUucmVtb3ZlQ29sbGVjdGlvbkVsZW1lbnQgPSBUY0JkZFNlcnZpY2UucmVtb3ZlQ29sbGVjdGlvbkVsZW1lbnQ7XHJcbiAgICAgICAgJHNjb3BlLnJldmVydENvbXBvc2l0ZXNDbGFzcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuY29tcG9zaXRlc0NsYXNzID0gYW5ndWxhci5jb3B5KCRzY29wZS5vcmlnaW5hbENvbXBvc2l0ZXNDbGFzcyk7XHJcbiAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGUgPSAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNvbXBvc2l0ZXNbMF07XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuUmV2ZXJ0Q29tcG9zaXRlc0NsYXNzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhYW5ndWxhci5lcXVhbHMoJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcywgJHNjb3BlLm9yaWdpbmFsQ29tcG9zaXRlc0NsYXNzKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jYW5TYXZlQ29tcG9zaXRlc0NsYXNzID0gZnVuY3Rpb24obmdNb2RlbENvbnRyb2xsZXIpIHtcclxuICAgICAgICAgICAgdmFyIGlzVmFsaWQgPSBuZ01vZGVsQ29udHJvbGxlci4kdmFsaWQ7XHJcbiAgICAgICAgICAgIHZhciBpc1VwZGF0ZWQgPSAhYW5ndWxhci5lcXVhbHMoJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcywgJHNjb3BlLm9yaWdpbmFsQ29tcG9zaXRlc0NsYXNzKTtcclxuICAgICAgICAgICAgdmFyIGlzTmV3ID0gJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5pc05ldztcclxuICAgICAgICAgICAgcmV0dXJuIChpc05ldyB8fCBpc1VwZGF0ZWQpICYmIGlzVmFsaWQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY29tcG9zaXRlc0FyZVZhbGlkID0gZnVuY3Rpb24obmdNb2RlbENvbnRyb2xsZXIpIHtcclxuICAgICAgICAgICAgdmFyIGlzVmFsaWQgPSBuZ01vZGVsQ29udHJvbGxlci4kdmFsaWQ7XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNvbXBvc2l0ZXMsIGZ1bmN0aW9uKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnN0ZXBUZXh0ID09PSB1bmRlZmluZWQgfHwgZWxlbWVudC5zdGVwVGV4dCA9PT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICBpc1ZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuY29tcG9zaXRlU3RlcHMgPT09IHVuZGVmaW5lZCB8fCBlbGVtZW50LmNvbXBvc2l0ZVN0ZXBzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzVmFsaWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBpc1ZhbGlkO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnNhdmVDb21wb3NpdGVzQ2xhc3MgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJGh0dHAucHV0KCcvZ3Jvb3Z5Q29tcG9zaXRlcycsICRzY29wZS5jb21wb3NpdGVzQ2xhc3MpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsZXRlQ29tcG9zaXRlc0NsYXNzV2l0aG91dENvbmZpcm1hdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9wYWdlL2NvbXBvc2l0ZXMvJyArICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuY2xhc3MgKyAnLmdyb292eScpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5pc05ldyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm9yaWdpbmFsQ29tcG9zaXRlc0NsYXNzID0gYW5ndWxhci5jb3B5KCRzY29wZS5jb21wb3NpdGVzQ2xhc3MpO1xyXG4gICAgICAgICAgICAgICAgJGNvb2tpZVN0b3JlLnB1dCgnY29tcG9zaXRlQ2xhc3MnLCAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNsYXNzKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hZGRDb21wb3NpdGVzVGFiKCk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICBvcGVuRXJyb3JNb2RhbCgkbW9kYWwsIHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jYW5EZWxldGVDb21wb3NpdGVzQ2xhc3MgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICghJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5pc05ldyk7XHJcblxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmRlbGV0ZUNvbXBvc2l0ZXNDbGFzc1dpdGhvdXRDb25maXJtYXRpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGNsYXNzTmFtZSA9ICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuY2xhc3M7XHJcbiAgICAgICAgICAgIHZhciBvcmlnaW5hbENsYXNzTmFtZSA9ICRzY29wZS5vcmlnaW5hbENvbXBvc2l0ZXNDbGFzcy5jbGFzcztcclxuICAgICAgICAgICAgaWYgKGNsYXNzTmFtZSAhPT0gb3JpZ2luYWxDbGFzc05hbWUpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLmRlbGV0ZSgnL2dyb292eUNvbXBvc2l0ZXMvJyArIG9yaWdpbmFsQ2xhc3NOYW1lKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wZW5FcnJvck1vZGFsKCRtb2RhbCwgcmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmRlbGV0ZUNvbXBvc2l0ZXNDbGFzcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9IHtzdGF0dXM6ICdEZWxldGUgQ29tcG9zaXRlcyBDbGFzcycsIG1lc3NhZ2U6ICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgY29tcG9zaXRlcyBjbGFzcz8nfTtcclxuICAgICAgICAgICAgdmFyIG9rTW9kYWwgPSBvcGVuQ29uZmlybWF0aW9uTW9kYWwoJG1vZGFsLCBtZXNzYWdlKTtcclxuICAgICAgICAgICAgb2tNb2RhbC5yZXN1bHQudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLmRlbGV0ZSgnL2dyb292eUNvbXBvc2l0ZXMvJyArICRzY29wZS5vcmlnaW5hbENvbXBvc2l0ZXNDbGFzcy5jbGFzcykudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBvcGVuRXJyb3JNb2RhbCgkbW9kYWwsIHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRG8gbm90aGluZ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zYXZlQ29tcG9zaXRlc1RleHQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCRzY29wZS5jb21wb3NpdGVzQ2xhc3MuaXNOZXcpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnQ3JlYXRlIE5ldyBDb21wb3NpdGVzJztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnVXBkYXRlIENvbXBvc2l0ZXMnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBJbml0aWFsaXphdGlvblxyXG4gICAgICAgICRzY29wZS5hZGRDb21wb3NpdGVzVGFiKCk7XHJcbiAgICB9KTsiLCJhbmd1bGFyLm1vZHVsZSgncnVubmVyTW9kdWxlJywgW10pXHJcbiAgICAuY29udHJvbGxlcigncnVubmVyQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJG1vZGFsLCAkaHR0cCwgJGxvY2F0aW9uLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAvLyBUT0RPIFRlc3QgbW9yZSB0aGFuIGNoZWNraW5nIHdoZXRoZXIgJG1vZGFsLm9wZW4gd2FzIGNhbGxlZFxyXG4gICAgICAgICRzY29wZS5vcGVuUnVubmVyU2VsZWN0b3IgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2Fzc2V0cy9odG1sL3J1bm5lci9ydW5uZXJTZWxlY3Rvci50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3J1bm5lclNlbGVjdG9yQ3RybCcsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7fTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLm9wZW5SdW5uZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHJ1bm5lclNlbGVjdG9yID0gJHNjb3BlLm9wZW5SdW5uZXJTZWxlY3RvcigpO1xyXG4gICAgICAgICAgICBpZiAocnVubmVyU2VsZWN0b3IgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcnVubmVyU2VsZWN0b3IucmVzdWx0LnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RvcnlQYXRocyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuZGlycy5mb3JFYWNoKGZ1bmN0aW9uIChkaXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcnlQYXRocy5wdXNoKHtwYXRoOiBkaXIucGF0aCArIFwiLyoqLyouc3RvcnlcIn0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuc3Rvcmllcy5mb3JFYWNoKGZ1bmN0aW9uIChzdG9yeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9yeVBhdGhzLnB1c2goe3BhdGg6IHN0b3J5LnBhdGh9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBvcGVuUnVubmVyUGFyYW1ldGVyc01vZGFsKCRtb2RhbCwgdHJ1ZSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNsYXNzZXMgPSBkYXRhLmNsYXNzZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSBkYXRhLmFjdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCcvZ3Jvb3Z5Q29tcG9zaXRlcycpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3Jvb3Z5Q29tcG9zaXRlcyA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBpSnNvbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdG9yeVBhdGhzOiBzdG9yeVBhdGhzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6IGNsYXNzZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3Jvb3Z5Q29tcG9zaXRlczogZ3Jvb3Z5Q29tcG9zaXRlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdydW4nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJ1bigkc2NvcGUuYXBpSnNvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dBcGkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dBcGkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUucnVuID0gZnVuY3Rpb24oanNvbikge1xyXG4gICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgJHNjb3BlLnNob3dSdW5uZXJQcm9ncmVzcyA9IHRydWU7XHJcbiAgICAgICAgICAgICRzY29wZS5yZXBvcnRzVXJsID0gJyc7XHJcbiAgICAgICAgICAgICRodHRwLnBvc3QoJy9ydW5uZXIvcnVuLmpzb24nLCBqc29uKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09PSAnT0snKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHNVcmwgPSBkYXRhLnJlcG9ydHNQYXRoLnJlcGxhY2UoJ3B1YmxpYy8nLCAnL2Fzc2V0cy8nKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGEuc3RhdHVzID09PSAnRkFJTEVEJykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZXBvcnRzVXJsID0gZGF0YS5yZXBvcnRzUGF0aC5yZXBsYWNlKCdwdWJsaWMvJywgJy9hc3NldHMvJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclN1Y2Nlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wZW5FcnJvck1vZGFsKCRtb2RhbCwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJTdWNjZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJTdWNjZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBvcGVuRXJyb3JNb2RhbCgkbW9kYWwsIHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRSdW5uZXJTdGF0dXNDc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRSdW5uZXJTdGF0dXNDc3MoXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzLFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyxcclxuICAgICAgICAgICAgICAgICgkc2NvcGUucGVuZGluZ1N0ZXBzID4gMClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRTdG9yeVJ1bm5lclN0YXR1c1RleHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRTdG9yeVJ1bm5lclN0YXR1c1RleHQoXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzLFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyxcclxuICAgICAgICAgICAgICAgICRzY29wZS5wZW5kaW5nU3RlcHMubGVuZ3RoXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0UnVubmVyUHJvZ3Jlc3NDc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0UnVubmVyUHJvZ3Jlc3NDc3MoJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclN1Y2Nlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgJHNjb3BlLnNob3dSdW5uZXJQcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAkc2NvcGUucGVuZGluZ1N0ZXBzID0gW107XHJcbiAgICAgICAgICAgICRzY29wZS5yZXBvcnRzVXJsID0gJyc7XHJcbiAgICAgICAgICAgICRzY29wZS5vcGVuUnVubmVyKCk7XHJcbiAgICAgICAgICAgICRzY29wZS5zaG93QXBpID0gZmFsc2U7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuYXBpVXJsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkbG9jYXRpb24ucHJvdG9jb2woKSArICc6Ly8nICsgJGxvY2F0aW9uLmhvc3QoKSArICc6JyArICRsb2NhdGlvbi5wb3J0KCkgKyAnL3J1bm5lci9ydW4uanNvbic7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuaW5pdCgpO1xyXG4gICAgfSlcclxuICAgIC5jb250cm9sbGVyKCdydW5uZXJTZWxlY3RvckN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbW9kYWwsICRtb2RhbEluc3RhbmNlKSB7XHJcbiAgICAgICAgJHNjb3BlLmZpbGVzID0ge2RpcnM6IFtdLCBzdG9yaWVzOiBbXX07XHJcbiAgICAgICAgZ2V0U3Rvcmllcygkc2NvcGUsICRodHRwLCAkbW9kYWwsICcnKTtcclxuICAgICAgICAkc2NvcGUub3BlbkRpciA9IGZ1bmN0aW9uKHBhdGgpIHtcclxuICAgICAgICAgICAgb3BlbkRpcigkc2NvcGUsICRodHRwLCAkbW9kYWwsIHBhdGgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhbmNlbFJ1bm5lclNlbGVjdG9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5va1J1bm5lclNlbGVjdG9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZEZpbGVzID0ge2RpcnM6IFtdLCBzdG9yaWVzOiBbXX07XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuZmlsZXMuZGlycywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5zZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkRmlsZXMuZGlycy5wdXNoKHtwYXRoOiAkc2NvcGUucm9vdFBhdGggKyB2YWx1ZS5uYW1lfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLmZpbGVzLnN0b3JpZXMsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUuc2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEZpbGVzLnN0b3JpZXMucHVzaCh7cGF0aDogJHNjb3BlLnJvb3RQYXRoICsgdmFsdWUubmFtZSArIFwiLnN0b3J5XCJ9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKHNlbGVjdGVkRmlsZXMpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmFsbG93VG9QcmV2RGlyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUucm9vdFBhdGggIT09ICcnO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhbkNvbnRpbnVlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBoYXNTZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLmZpbGVzLmRpcnMsIGZ1bmN0aW9uKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUuc2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBoYXNTZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoIWhhc1NlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goJHNjb3BlLmZpbGVzLnN0b3JpZXMsIGZ1bmN0aW9uICh2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5zZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNTZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGhhc1NlbGVjdGVkO1xyXG4gICAgICAgIH07XHJcbiAgICB9KVxyXG4gICAgLmNvbnRyb2xsZXIoJ3J1bm5lclBhcmFtc0N0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSwgJGNvb2tpZVN0b3JlLCBkYXRhLCBzaG93R2V0QXBpKSB7XHJcbiAgICAgICAgJHNjb3BlLmNsYXNzZXMgPSBkYXRhLmNsYXNzZXM7XHJcbiAgICAgICAgJHNjb3BlLmNsYXNzZXMuZm9yRWFjaChmdW5jdGlvbihjbGFzc0VudHJ5KSB7XHJcbiAgICAgICAgICAgIGNsYXNzRW50cnkucGFyYW1zLmZvckVhY2goZnVuY3Rpb24ocGFyYW1FbnRyeSkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBwYXJhbUVudHJ5LnZhbHVlID0gJGNvb2tpZVN0b3JlLmdldChjbGFzc0VudHJ5LmZ1bGxOYW1lICsgXCIuXCIgKyBwYXJhbUVudHJ5LmtleSk7XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDb3VsZCBub3QgcmV0cmlldmUgY29va2llICcgKyBjbGFzc0VudHJ5LmZ1bGxOYW1lICsgXCIuXCIgKyBwYXJhbUVudHJ5LmtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkc2NvcGUuaGFzUGFyYW1zID0gZnVuY3Rpb24oY2xhc3NFbnRyeSkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2xhc3NFbnRyeS5wYXJhbXMgIT09IHVuZGVmaW5lZCAmJiBjbGFzc0VudHJ5LnBhcmFtcy5sZW5ndGggPiAwO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLm9rID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKHthY3Rpb246ICdydW4nLCBjbGFzc2VzOiAkc2NvcGUuY2xhc3Nlc30pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zaG93R2V0QXBpID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzaG93R2V0QXBpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmdldEFwaSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSh7YWN0aW9uOiAnYXBpJywgY2xhc3NlczogJHNjb3BlLmNsYXNzZXN9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5wYXJhbUVsZW1lbnRJZCA9IGZ1bmN0aW9uKGNsYXNzTmFtZSwgcGFyYW1LZXkpIHtcclxuICAgICAgICAgICAgdmFyIGZvcm1hdHRlZENsYXNzTmFtZSA9IGNsYXNzTmFtZS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIGNsYXNzTmFtZS5zbGljZSgxKTtcclxuICAgICAgICAgICAgdmFyIGZvcm1hdHRlZFBhcmFtS2V5ID0gcGFyYW1LZXkuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBwYXJhbUtleS5zbGljZSgxKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZvcm1hdHRlZENsYXNzTmFtZSArIGZvcm1hdHRlZFBhcmFtS2V5O1xyXG4gICAgICAgIH07XHJcbiAgICB9KTsiLCJhbmd1bGFyLm1vZHVsZSgnc3RvcnlNb2R1bGUnLCBbXSlcclxuICAgIC5jb250cm9sbGVyKCdzdG9yeUN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbW9kYWwsICRsb2NhdGlvbiwgJGNvb2tpZVN0b3JlLCAkcSwgJGFuY2hvclNjcm9sbCwgc3RvcnksIHN0ZXBzLCBncm9vdnlDb21wb3NpdGVzLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAkc2NvcGUucGVuZGluZ1N0ZXBzID0gW107XHJcbiAgICAgICAgJHNjb3BlLnNldEFjdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLnN0b3J5Lm5hbWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aW9uID0gJ1BVVCc7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWRkSGlzdG9yeUl0ZW0oJHNjb3BlLnN0b3J5Lm5hbWUgKyAnIHN0b3J5Jyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aW9uID0gJ1BPU1QnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZXhwYW5kUGFuZWxzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBzY2VuYXJpb3NFeHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUucGFuZWxzRXhwYW5kZWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhbmVsc0V4cGFuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFuZWxzRXhwYW5kZWQgPSAhJHNjb3BlLnBhbmVsc0V4cGFuZGVkO1xyXG4gICAgICAgICAgICAgICAgc2NlbmFyaW9zRXhwYW5kZWQgPSAkc2NvcGUucGFuZWxzRXhwYW5kZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHNjb3BlLnBhbmVscyA9IHtcclxuICAgICAgICAgICAgICAgIHN0b3J5OiAkc2NvcGUucGFuZWxzRXhwYW5kZWQsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJHNjb3BlLnBhbmVsc0V4cGFuZGVkLFxyXG4gICAgICAgICAgICAgICAgbWV0YTogJHNjb3BlLnBhbmVsc0V4cGFuZGVkLFxyXG4gICAgICAgICAgICAgICAgbmFycmF0aXZlOiAkc2NvcGUucGFuZWxzRXhwYW5kZWQsXHJcbiAgICAgICAgICAgICAgICBnaXZlblN0b3JpZXM6ICRzY29wZS5wYW5lbHNFeHBhbmRlZCxcclxuICAgICAgICAgICAgICAgIGxpZmVjeWNsZTogJHNjb3BlLnBhbmVsc0V4cGFuZGVkLFxyXG4gICAgICAgICAgICAgICAgc2NlbmFyaW9zOiBzY2VuYXJpb3NFeHBhbmRlZFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnN0b3J5ID0gc3Rvcnk7XHJcbiAgICAgICAgJHNjb3BlLnN0ZXBzID0gc3RlcHM7XHJcbiAgICAgICAgJHNjb3BlLmdyb292eUNvbXBvc2l0ZXMgPSBncm9vdnlDb21wb3NpdGVzO1xyXG4gICAgICAgICRzY29wZS5zdGVwVHlwZXMgPSBbJ0dJVkVOJywgJ1dIRU4nLCAnVEhFTiddO1xyXG4gICAgICAgICRzY29wZS5zdG9yeUZvcm1DbGFzcyA9ICdjb2wtbWQtMTInO1xyXG4gICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyA9IHRydWU7XHJcbiAgICAgICAgJHNjb3BlLmV4cGFuZFBhbmVscygpO1xyXG4gICAgICAgICRzY29wZS5vcmlnaW5hbFN0b3J5ID0gYW5ndWxhci5jb3B5KHN0b3J5KTtcclxuICAgICAgICB2YXIgcGF0aEFycmF5ID0gJHNjb3BlLnN0b3J5LnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICAkc2NvcGUuZGlyUGF0aCA9IHBhdGhBcnJheS5zbGljZSgwLCBwYXRoQXJyYXkubGVuZ3RoIC0gMSkuam9pbignLycpO1xyXG4gICAgICAgIGlmICgkc2NvcGUuZGlyUGF0aCAhPT0gJycpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmRpclBhdGggKz0gJy8nO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkc2NvcGUuc2V0QWN0aW9uKCk7XHJcbiAgICAgICAgJHNjb3BlLmNzc0NsYXNzID0gY3NzQ2xhc3M7XHJcbiAgICAgICAgJHNjb3BlLmJ1dHRvbkNzc0NsYXNzID0gVGNCZGRTZXJ2aWNlLmJ1dHRvbkNzc0NsYXNzO1xyXG4gICAgICAgICRzY29wZS5jYW5TYXZlU3RvcnkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGlzVmFsaWQgPSAkc2NvcGUuc3RvcnlGb3JtLiR2YWxpZDtcclxuICAgICAgICAgICAgdmFyIGhhc0NoYW5nZWQgPSAhYW5ndWxhci5lcXVhbHMoJHNjb3BlLnN0b3J5LCAkc2NvcGUub3JpZ2luYWxTdG9yeSk7XHJcbiAgICAgICAgICAgIHJldHVybiBpc1ZhbGlkICYmIGhhc0NoYW5nZWQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuc3RlcFRleHRQYXR0ZXJuID0gc3RlcFRleHRQYXR0ZXJuO1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5zYXZlU3RvcnkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCRzY29wZS5jYW5TYXZlU3RvcnkoKSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5LnBhdGggPSAkc2NvcGUuZGlyUGF0aCArICRzY29wZS5zdG9yeS5uYW1lICsgXCIuc3RvcnlcIjtcclxuICAgICAgICAgICAgICAgIGlmICgnUE9TVCcgPT09ICRzY29wZS5hY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RyaXBwZWRQYXRoQXJyYXkgPSAkc2NvcGUuZGlyUGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdHJpcHBlZFBhdGggPSBzdHJpcHBlZFBhdGhBcnJheS5zbGljZSgwLCBzdHJpcHBlZFBhdGhBcnJheS5sZW5ndGggLSAxKS5qb2luKCcvJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0cmlwcGVkUGF0aCAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaXBwZWRQYXRoICs9ICcvJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAucG9zdCgnL3N0b3JpZXMvc3RvcnkuanNvbicsICRzY29wZS5zdG9yeSkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKGdldFZpZXdTdG9yeVVybCgpICsgc3RyaXBwZWRQYXRoICsgJHNjb3BlLnN0b3J5Lm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3JpZ2luYWxTdG9yeSA9IGFuZ3VsYXIuY29weSgkc2NvcGUuc3RvcnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3BlbkVycm9yTW9kYWwoJG1vZGFsLCByZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zdG9yeS5uYW1lICE9PSAkc2NvcGUub3JpZ2luYWxTdG9yeS5uYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeS5vcmlnaW5hbFBhdGggPSAkc2NvcGUub3JpZ2luYWxTdG9yeS5wYXRoO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAkaHR0cC5wdXQoJy9zdG9yaWVzL3N0b3J5Lmpzb24nLCAkc2NvcGUuc3RvcnkpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3JpZ2luYWxTdG9yeSA9IGFuZ3VsYXIuY29weSgkc2NvcGUuc3RvcnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3BlbkVycm9yTW9kYWwoJG1vZGFsLCByZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhblJ1blN0b3J5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLnN0b3J5Rm9ybS4kdmFsaWQgJiYgISRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3M7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUucnVuU3RvcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY2FuUnVuU3RvcnkoKSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNhdmVTdG9yeSgpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm9wZW5SdW5uZXJNb2RhbCgpLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNsYXNzZXMgPSBkYXRhLmNsYXNzZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5Rm9ybUNsYXNzID0gJ2NvbC1tZC02JztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJDbGFzcyA9ICdjb2wtbWQtNic7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyVmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3Nlcy5mb3JFYWNoKGZ1bmN0aW9uIChjbGFzc0VudHJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzRW50cnkucGFyYW1zLmZvckVhY2goZnVuY3Rpb24gKHBhcmFtRW50cnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb29raWVTdG9yZS5wdXQoY2xhc3NFbnRyeS5mdWxsTmFtZSArIFwiLlwiICsgcGFyYW1FbnRyeS5rZXksIHBhcmFtRW50cnkudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIganNvbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcnlQYXRoczogW3twYXRoOiAkc2NvcGUuc3RvcnkucGF0aH1dLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiBjbGFzc2VzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBncm9vdnlDb21wb3NpdGVzOiAkc2NvcGUuZ3Jvb3Z5Q29tcG9zaXRlc1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAucG9zdCgnL3J1bm5lci9ydW4uanNvbicsIGpzb24pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclN1Y2Nlc3MgPSAocmVzcG9uc2UuZGF0YS5zdGF0dXMgPT09ICdPSycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRSZXBvcnRzKHJlc3BvbnNlLmRhdGEuaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJTdWNjZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9wZW5FcnJvck1vZGFsKCRtb2RhbCwgcmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5vcGVuRXJyb3JNb2RhbCgkbW9kYWwsIHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRSZXBvcnRzID0gZnVuY3Rpb24ocmVwb3J0c0lkKSB7XHJcbiAgICAgICAgICAgICRodHRwLmdldCgnL2FwaS92MS9yZXBvcnRlcnMvbGlzdC8nICsgcmVwb3J0c0lkKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHMgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHMuaWQgPSByZXBvcnRzSWQ7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2V0UGVuZGluZ1N0ZXBzKCRzY29wZS5yZXBvcnRzKTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAgICAgICAgICRzY29wZS5vcGVuRXJyb3JNb2RhbCgkbW9kYWwsIHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRSZXBvcnRVcmwgPSBmdW5jdGlvbihyZXBvcnRzSWQsIHJlcG9ydCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJy9hcGkvdjEvcmVwb3J0ZXJzL2dldC8nICsgcmVwb3J0c0lkICsgJy8nICsgcmVwb3J0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLm9wZW5SdW5uZXJNb2RhbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gb3BlblJ1bm5lclBhcmFtZXRlcnNNb2RhbCgkbW9kYWwsIGZhbHNlKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRSdW5uZXJQcm9ncmVzc0NzcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRSdW5uZXJQcm9ncmVzc0Nzcygkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRSdW5uZXJTdGF0dXNDc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRSdW5uZXJTdGF0dXNDc3MoXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzLFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyxcclxuICAgICAgICAgICAgICAgICgkc2NvcGUucGVuZGluZ1N0ZXBzID4gMClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zZXRQZW5kaW5nU3RlcHMgPSBmdW5jdGlvbihyZXBvcnRzKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5wZW5kaW5nU3RlcHMgPSBbXTtcclxuICAgICAgICAgICAgcmVwb3J0cy5mb3JFYWNoKGZ1bmN0aW9uKHJlcG9ydCkge1xyXG4gICAgICAgICAgICAgICAgcmVwb3J0LnN0ZXBzLmZvckVhY2goZnVuY3Rpb24oc3RlcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGVwLnN0YXR1cyA9PT0gJ3BlbmRpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wZW5kaW5nU3RlcHMucHVzaCh7dGV4dDogc3RlcC50ZXh0fSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmhhc1BlbmRpbmdTdGVwcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLnBlbmRpbmdTdGVwcyAhPT0gdW5kZWZpbmVkICYmICRzY29wZS5wZW5kaW5nU3RlcHMubGVuZ3RoID4gMDtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRTdG9yeVJ1bm5lclN0YXR1c1RleHQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRTdG9yeVJ1bm5lclN0YXR1c1RleHQoXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzLFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyxcclxuICAgICAgICAgICAgICAgICRzY29wZS5wZW5kaW5nU3RlcHMubGVuZ3RoXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUucmVtb3ZlQ29sbGVjdGlvbkVsZW1lbnQgPSBUY0JkZFNlcnZpY2UucmVtb3ZlQ29sbGVjdGlvbkVsZW1lbnQ7XHJcbiAgICAgICAgJHNjb3BlLmFkZEVsZW1lbnQgPSBmdW5jdGlvbiAoY29sbGVjdGlvbikge1xyXG4gICAgICAgICAgICBjb2xsZWN0aW9uLnB1c2goe30pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmFkZFNjZW5hcmlvRWxlbWVudCA9IGZ1bmN0aW9uIChjb2xsZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGNvbGxlY3Rpb24ucHVzaCh7dGl0bGU6ICcnLCBtZXRhOiBbXSwgc3RlcHM6IFtdLCBleGFtcGxlc1RhYmxlOiAnJ30pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnJldmVydFN0b3J5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuc3RvcnkgPSBhbmd1bGFyLmNvcHkoJHNjb3BlLm9yaWdpbmFsU3RvcnkpO1xyXG4gICAgICAgICAgICAkc2NvcGUuc3RvcnlGb3JtLiRzZXRQcmlzdGluZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhblJldmVydFN0b3J5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gIWFuZ3VsYXIuZXF1YWxzKCRzY29wZS5zdG9yeSwgJHNjb3BlLm9yaWdpbmFsU3RvcnkpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhbkRlbGV0ZVN0b3J5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLmFjdGlvbiA9PT0gJ1BVVCcgJiYgISRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3M7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUuZGVsZXRlU3RvcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gJHNjb3BlLmRpclBhdGggKyAkc2NvcGUuc3RvcnkubmFtZSArICcuc3RvcnknO1xyXG4gICAgICAgICAgICBkZWxldGVTdG9yeSgkbW9kYWwsICRodHRwLCAkbG9jYXRpb24sICRxLCBwYXRoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zdGVwRW50ZXJLZXkgPSBUY0JkZFNlcnZpY2UubmV3Q29sbGVjdGlvbkl0ZW07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLmNsaWNrUGVuZGluZ1N0ZXAgPSBmdW5jdGlvbihzdGVwVGV4dCkge1xyXG4gICAgICAgICAgICB2YXIgY29tcG9zaXRlQ2xhc3MgPSAkY29va2llU3RvcmUuZ2V0KFwiY29tcG9zaXRlQ2xhc3NcIik7XHJcbiAgICAgICAgICAgIGlmIChjb21wb3NpdGVDbGFzcyA9PT0gdW5kZWZpbmVkIHx8IGNvbXBvc2l0ZUNsYXNzID09PSAnJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5vcGVuQ29tcG9zaXRlQ2xhc3Moc3RlcFRleHQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRsb2NhdGlvbi5zZWFyY2goJ3N0ZXBUZXh0Jywgc3RlcFRleHQpLnBhdGgoJy9wYWdlL2NvbXBvc2l0ZXMvY29tcG9zaXRlcy5jb20udGVjaG5vbG9neWNvbnZlcnNhdGlvbnMuYmRkLnN0ZXBzLicgKyBjb21wb3NpdGVDbGFzcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5vcGVuRXJyb3JNb2RhbCA9IG9wZW5FcnJvck1vZGFsO1xyXG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoJ3RvcE1lbnVNb2R1bGUnLCBbXSlcclxuICAgIC5jb250cm9sbGVyKCd0b3BNZW51Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJG1vZGFsLCAkbG9jYXRpb24sIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdCBtb3JlIHRoYW4gY2hlY2tpbmcgd2hldGhlciAkbW9kYWwub3BlbiB3YXMgY2FsbGVkXHJcbiAgICAgICAgJHNjb3BlLm9wZW5TdG9yeSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9zdG9yaWVzLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc3Rvcmllc0N0cmwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge307XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5vcGVuQ29tcG9zaXRlQ2xhc3MgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5Db21wb3NpdGVDbGFzcygkbW9kYWwpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmdldFRpdGxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gJGxvY2F0aW9uLnBhdGgoKTtcclxuICAgICAgICAgICAgaWYgKHBhdGguaW5kZXhPZihnZXRWaWV3U3RvcnlVcmwoKSkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnVmlldyBTdG9yeSc7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGF0aC5pbmRleE9mKGdldE5ld1N0b3J5VXJsKCkpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ05ldyBTdG9yeSc7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGF0aC5pbmRleE9mKGdldENvbXBvc2l0ZXNVcmwoKSkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnQ29tcG9zaXRlcyc7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGF0aC5pbmRleE9mKCcvcGFnZS9yZXBvcnRzLycpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1JlcG9ydHMnO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=