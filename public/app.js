angular.module("storiesModule",["ngRoute","ngCookies","ui.bootstrap","ui.sortable","configModule","bodyModule","topMenuModule","storyModule","compositeClassesModule","compositesModule","runnerModule"]).service("TcBddService",["$modal","$http","$location","$q",function(t,e,o,s){this.openCompositeClass=function(e){var o=this;t.open({templateUrl:"/assets/html/compositeClasses/compositeClasses.tmpl.html",controller:"compositeClassesCtrl",resolve:{compositeClasses:["$route","$http","$modal",function(){return o.getJson("/groovyComposites",!1)}],compositeStepText:function(){return e}}})},this.newCollectionItem=function(t,e){13===t.which&&e.push({})},this.removeCollectionElement=function(t,e){t.splice(e,1)},this.buttonCssClass=function(t){return{"btn-success":t.$valid,"btn-danger":t.$invalid}},this.getRunnerProgressCss=function(t){return{"progress progress-striped active":t,progress:!t}},this.getStoryRunnerStatusText=function(t,e,o){return t?"Story run is in progress":e?o>0?"Story run was successful with "+o+" pending steps":"Story run was successful":"Story run failed"},this.getRunnerStatusCss=function(t,e,o){return{"progress-bar progress-bar-info":t,"progress-bar progress-bar-warning":!t&&e&&o,"progress-bar progress-bar-success":!t&&e&&!o,"progress-bar progress-bar-danger":!t&&!e}},this.openRunnerParametersModal=function(e){var o=this;return t.open({templateUrl:"/assets/html/runner/runnerParams.tmpl.html",controller:"runnerParamsCtrl",resolve:{data:["$route","$http","$modal",function(){return o.getJson("/steps/classes.json",!0)}],showGetApi:function(){return e}}})},this.openDir=function(t,e){if(".."===e){var o=t.rootPath.split("/");t.rootPath=o.slice(0,o.length-2).join("/"),""!==t.rootPath&&(t.rootPath+="/"),this.getStories(t,"")}else this.getStories(t,e)},this.getStories=function(t,o){var s=this;void 0===t.rootPath&&(t.rootPath=""),e.get("/stories/list.json?path="+t.rootPath+o).then(function(e){t.files=e.data,""!==o&&(t.rootPath+=o+"/")},function(t){s.openErrorModal(t.data)})},this.stepTextPattern=function(){return/^(Given|When|Then) .+$/},this.openConfirmationModal=function(e){return t.open({templateUrl:"/assets/html/confirmationModal.tmpl.html",controller:"modalCtrl",resolve:{data:function(){return e}}})},this.classNamePattern=function(){return/^[a-zA-Z_$][a-zA-Z\d_$]*$/},this.cssClass=function(t){return{"has-error":t.$invalid,"has-success":t.$valid&&t.$dirty}},this.deleteStory=function(t){var n=this,r=s.defer(),a={status:"Delete Story",message:"Are you sure you want to delete this story?"},i=this.openConfirmationModal(a);return i.result.then(function(){e.delete("/stories/story/"+t).then(function(){o.path("/page/stories/new/"),r.resolve("OK")},function(t){n.openErrorModal(t.data),r.reject("NOK")})},function(){r.reject("NOK")}),r.promise},this.getJson=function(t,o){var s=this;return e.get(t,{cache:o}).then(function(t){return t.data},function(t){s.openErrorModal(t.data)})},this.openErrorModal=function(e){t.open({templateUrl:"/assets/html/errorModal.tmpl.html",controller:"modalCtrl",resolve:{data:function(){return e}}})}}]).controller("modalCtrl",["$scope","$modalInstance","data",function(t,e,o){t.data=o,t.ok=function(){e.close("ok")},t.cancel=function(){e.dismiss("cancel")}}]).controller("storiesCtrl",["$scope","$http","$modal","$modalInstance","$location","$q","TcBddService",function(t,e,o,s,n,r,a){a.getStories(t,""),t.openDir=function(e){a.openDir(t,e)},t.close=function(){s.close()},t.viewStoryUrl=function(e){return"/page/stories/view/"+t.rootPath+e},t.allowToPrevDir=function(){return""!==t.rootPath},t.deleteStory=function(e,o){var s=t.rootPath+e+".story";a.deleteStory(s).then(function(){t.files.stories.splice(o,1)})},t.createDirectory=function(o){var s='{"path": "'+t.rootPath+o+'"}';e.post("/stories/dir.json",s).then(function(){t.files.dirs.push({name:o})},function(t){a.openErrorModal(t.data)})}}]),angular.module("configModule",[]).config(["$routeProvider","$locationProvider",function(t,e){e.html5Mode(!0),t.when("/page/stories/new/",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",resolve:{story:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/stories/story.json",!1)}],steps:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/steps/list.json",!0)}],groovyComposites:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/groovyComposites",!0)}]}}).when("/page/stories/new/:path*",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",resolve:{story:["$route","$http","$modal","TcBddService",function(t,e,o,s){return s.getJson("/stories/story.json?path="+t.current.params.path+".story",!1)}],steps:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/steps/list.json",!0)}],groovyComposites:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/groovyComposites",!0)}]}}).when("/page/stories/view/:path*",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",resolve:{story:["$route","$http","$modal","TcBddService",function(t,e,o,s){return s.getJson("/stories/story.json?path="+t.current.params.path+".story",!1)}],steps:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/steps/list.json",!0)}],groovyComposites:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/groovyComposites",!0)}]},reloadOnSearch:!1}).when("/page/composites/:className*",{templateUrl:"/assets/html/composites/composites.tmpl.html",controller:"compositesCtrl",resolve:{compositesClass:["$route","$http",function(t,e){var o=t.current.params.className,s="/groovyComposites/"+o;return e.get(s,{cache:!1}).then(function(t){return t.data},function(){var t=o.substring(0,o.lastIndexOf("."));return{"class":t,composites:[{stepText:"",compositeSteps:[{}]}],isNew:!0}})}],steps:["$http","$modal","TcBddService",function(t,e,o){return o.getJson("/steps/list.json",!1)}]}}).when("/page/runner/",{templateUrl:"/assets/html/runner/runner.tmpl.html",controller:"runnerCtrl",resolve:{data:["$route",function(t){return{reportsPath:t.current.params.path}}]}}).otherwise({redirectTo:"/page/stories/new"})}]),angular.module("bodyModule",[]).controller("bodyCtrl",["$scope",function(){}]),angular.module("compositeClassesModule",[]).controller("compositeClassesCtrl",["$scope","$http","$modalInstance","compositeClasses","compositeStepText","TcBddService",function(t,e,o,s,n,r){t.compositeClasses=s,t.compositeStepText=n,t.close=function(){o.close()},t.compositeClassUrl=function(e,o){var s="/page/composites/";void 0!==e&&""!==e&&(s+=e+".");var n;return n=o.split(o.indexOf("/")>=0?"/":"\\"),s+=n[n.length-1],void 0!==t.compositeStepText&&""!==t.compositeStepText&&(s+="?stepText="+t.compositeStepText),s},t.compositeClassText=function(t){var e;e=t.split(t.indexOf("/")>=0?"/":"\\");var o=e[e.length-1];return o.indexOf(".")>=0&&(o=o.substr(0,o.lastIndexOf("."))),o},t.classNamePattern=r.classNamePattern,t.cssClass=r.cssClass,t.data={"class":""}}]),angular.module("compositesModule",[]).controller("compositesCtrl",["$scope","$http","$modal","$location","$cookieStore","compositesClass","steps","TcBddService",function(t,e,o,s,n,r,a,i){t.addNewComposite=function(){t.composite={stepText:"",compositeSteps:[{}]},t.compositesClass.composites.push(t.composite)},t.addStepTextParam=function(){void 0!==s.search().stepText&&""!==s.search().stepText&&t.compositesClass.composites.push({stepText:s.search().stepText,compositeSteps:[]})},t.addNewCompositeStep=function(){t.composite.compositeSteps.push({})},t.setLastComposite=function(){if(void 0!==t.compositesClass){var e=t.compositesClass.composites.length;t.composite=t.compositesClass.composites[e-1]}else t.composite={}},t.compositesClass=r,t.addStepTextParam(),t.originalCompositesClass=angular.copy(r),t.setLastComposite(),t.steps=a,t.classNamePattern=i.classNamePattern,t.stepTextPattern=i.stepTextPattern,t.cssClass=i.cssClass,t.buttonCssClass=function(t,e){return i.buttonCssClass(t.$valid?e:t)},t.openComposite=function(e){t.composite=e},t.newCollectionItem=i.newCollectionItem,t.removeCollectionElement=i.removeCollectionElement,t.revertCompositesClass=function(){t.compositesClass=angular.copy(t.originalCompositesClass),t.composite=t.compositesClass.composites[0]},t.canRevertCompositesClass=function(){return!angular.equals(t.compositesClass,t.originalCompositesClass)},t.canSaveCompositesClass=function(e){var o=e.$valid,s=!angular.equals(t.compositesClass,t.originalCompositesClass),n=t.compositesClass.isNew;return(n||s)&&o},t.compositesAreValid=function(e){var o=e.$valid;return angular.forEach(t.compositesClass.composites,function(t){void 0===t.stepText||""===t.stepText?o=!1:(void 0===t.compositeSteps||0===t.compositeSteps.length)&&(o=!1)}),o},t.saveCompositesClass=function(){e.put("/groovyComposites",t.compositesClass).then(function(){t.deleteCompositesClassWithoutConfirmation(),s.path("/page/composites/"+t.compositesClass.class+".groovy"),t.compositesClass.isNew=!1,t.originalCompositesClass=angular.copy(t.compositesClass),n.put("compositeClass",t.compositesClass.class)},function(t){i.openErrorModal(t.data)})},t.canDeleteCompositesClass=function(){return!t.compositesClass.isNew},t.deleteCompositesClassWithoutConfirmation=function(){var o=t.compositesClass.class,s=t.originalCompositesClass.class;o!==s&&e.delete("/groovyComposites/"+s).then(function(){},function(t){i.openErrorModal(t.data)})},t.deleteCompositesClass=function(){var o={status:"Delete Composites Class",message:"Are you sure you want to delete this composites class?"},n=i.openConfirmationModal(o);n.result.then(function(){e.delete("/groovyComposites/"+t.originalCompositesClass.class).then(function(){s.path("/")},function(t){i.openErrorModal(t.data)})},function(){})},t.saveCompositesText=function(){return t.compositesClass.isNew?"Create New Composites":"Update Composites"}}]),angular.module("runnerModule",[]).controller("runnerCtrl",["$scope","$modal","$http","$location","TcBddService",function(t,e,o,s,n){t.openRunnerSelector=function(){return e.open({templateUrl:"/assets/html/runner/runnerSelector.tmpl.html",controller:"runnerSelectorCtrl",resolve:{data:function(){return{}}}})},t.openRunner=function(){var e=t.openRunnerSelector();void 0!==e&&e.result.then(function(e){var s=[];e.dirs.forEach(function(t){s.push({path:t.path+"/**/*.story"})}),e.stories.forEach(function(t){s.push({path:t.path})}),n.openRunnerParametersModal(!0).result.then(function(e){var n=e.classes,r=e.action;o.get("/groovyComposites").then(function(e){var o=e.data;t.apiJson={storyPaths:s,classes:n,groovyComposites:o},"run"===r?(t.run(t.apiJson),t.showApi=!1):t.showApi=!0})})})},t.run=function(e){var s="/api/v1/reporters/get/";t.storyRunnerInProgress=!0,t.showRunnerProgress=!0,t.reportsUrl="",o.post("/runner/run.json",e).then(function(e){var o=e.data;"OK"===o.status?(t.reportsUrl=s+o.reportsPath,t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!0):"FAILED"===o.status?(t.reportsUrl=s+o.reportsPath,t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!1):n.openErrorModal(o),t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!0},function(e){t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!1,n.openErrorModal(e.data)})},t.getRunnerStatusCss=function(){return n.getRunnerStatusCss(t.storyRunnerInProgress,t.storyRunnerSuccess,t.pendingSteps>0)},t.getStoryRunnerStatusText=function(){return t.storyRunnerInProgress?"Stories run is in progress":"Stories run is finished"},t.getRunnerProgressCss=function(){return n.getRunnerProgressCss(t.storyRunnerInProgress)},t.init=function(){t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!1,t.showRunnerProgress=!1,t.pendingSteps=[],t.reportsUrl="",t.openRunner(),t.showApi=!1},t.apiUrl=function(){return s.protocol()+"://"+s.host()+":"+s.port()+"/runner/run.json"},t.init()}]).controller("runnerSelectorCtrl",["$scope","$http","$modal","$modalInstance","TcBddService",function(t,e,o,s,n){t.files={dirs:[],stories:[]},n.getStories(t,""),t.openDir=function(e){n.openDir(t,e)},t.cancelRunnerSelector=function(){s.dismiss("cancel")},t.okRunnerSelector=function(){var e={dirs:[],stories:[]};angular.forEach(t.files.dirs,function(o){o.selected&&e.dirs.push({path:t.rootPath+o.name})}),angular.forEach(t.files.stories,function(o){o.selected&&e.stories.push({path:t.rootPath+o.name+".story"})}),s.close(e)},t.allowToPrevDir=function(){return""!==t.rootPath},t.canContinue=function(){var e=!1;return angular.forEach(t.files.dirs,function(t){t.selected&&(e=!0)}),e||angular.forEach(t.files.stories,function(t){t.selected&&(e=!0)}),e}}]).controller("runnerParamsCtrl",["$scope","$modalInstance","$cookieStore","data","showGetApi",function(t,e,o,s,n){t.classes=s.classes,t.paramArray=[],t.setParams=function(){t.classes.forEach(function(t){t.params.forEach(function(e){if(void 0!==e.value&&""!==e.value)e.disabled=!0;else{e.disabled=!1;try{e.value=o.get(t.fullName+"."+e.key)}catch(s){console.log("Could not retrieve cookie "+t.fullName+"."+e.key),console.log(s.message)}}})})},t.hasOptions=function(t){return t?t.length>0:!1},t.hasParams=function(t){return void 0!==t.params&&t.params.length>0},t.ok=function(){e.close({action:"run",classes:t.classes})},t.cancel=function(){e.dismiss("cancel")},t.showGetApi=function(){return n},t.getApi=function(){e.close({action:"api",classes:t.classes})},t.paramElementId=function(t,e){var o=t.charAt(0).toLowerCase()+t.slice(1),s=e.charAt(0).toUpperCase()+e.slice(1);return o+s},t.setParams()}]),angular.module("topMenuModule",[]).controller("topMenuController",["$scope","$modal","$location","TcBddService",function(t,e,o,s){t.openStory=function(){e.open({templateUrl:"/assets/html/stories.tmpl.html",controller:"storiesCtrl",resolve:{data:function(){return{}}}})},t.openCompositeClass=function(){s.openCompositeClass()},t.getTitle=function(){var t=o.path();return 0===t.indexOf("/page/stories/view/")?"View Story":0===t.indexOf("/page/stories/new/")?"New Story":0===t.indexOf("/page/composites/")?"Composites":0===t.indexOf("/page/reports/")?"Reports":""}}]),angular.module("storyModule",[]).controller("storyCtrl",["$scope","$http","$modal","$location","$cookieStore","$q","$anchorScroll","story","steps","groovyComposites","TcBddService",function(t,e,o,s,n,r,a,i,l,c,u){t.pendingSteps=[],t.setAction=function(){t.action=""!==t.story.name?"PUT":"POST"},t.expandPanels=function(){var e=!0;void 0===t.panelsExpanded?t.panelsExpanded=!1:(t.panelsExpanded=!t.panelsExpanded,e=t.panelsExpanded),t.panels={story:t.panelsExpanded,description:t.panelsExpanded,meta:t.panelsExpanded,narrative:t.panelsExpanded,givenStories:t.panelsExpanded,lifecycle:t.panelsExpanded,scenarios:e}},t.story=i,t.steps=l,t.groovyComposites=c,t.stepTypes=["GIVEN","WHEN","THEN"],t.storyFormClass="col-md-10 col-md-offset-1 col-lg-8 col-lg-offset-2",t.storyRunnerVisible=!1,t.storyRunnerInProgress=!1,t.storyRunnerSuccess=!0,t.expandPanels(),t.panels.story=!0,t.activateRunnerTab={value:!1},t.originalStory=angular.copy(i);var p=t.story.path.split("/");t.dirPath=p.slice(0,p.length-1).join("/"),""!==t.dirPath&&(t.dirPath+="/"),t.setAction(),t.cssClass=u.cssClass,t.buttonCssClass=u.buttonCssClass,t.canSaveStory=function(){var e=t.storyForm.$valid,o=!angular.equals(t.story,t.originalStory);return e&&o},t.stepTextPattern=u.stepTextPattern,t.saveStory=function(){if(t.canSaveStory())if(t.story.path=t.dirPath+t.story.name+".story","POST"===t.action){var o=t.dirPath.split("/"),n=o.slice(0,o.length-1).join("/");""!==n&&(n+="/"),e.post("/stories/story.json",t.story).then(function(){s.path("/page/stories/view/"+n+t.story.name),t.originalStory=angular.copy(t.story)},function(e){t.openErrorModal(e.data)})}else t.story.name!==t.originalStory.name&&(t.story.originalPath=t.originalStory.path),e.put("/stories/story.json",t.story).then(function(){t.originalStory=angular.copy(t.story)},function(e){t.openErrorModal(e.data)})},t.canRunStory=function(){return t.storyForm.$valid&&!t.storyRunnerInProgress},t.runStory=function(){t.canRunStory()&&(t.activateRunnerTab.value=!0,t.saveStory(),t.openRunnerModal().result.then(function(o){var s=o.classes;t.storyFormClass="col-md-6",t.storyRunnerClass="col-md-6",t.storyRunnerVisible=!0,t.storyRunnerInProgress=!0,s.forEach(function(t){t.params.forEach(function(e){n.put(t.fullName+"."+e.key,e.value)})});var r={storyPaths:[{path:t.story.path}],classes:s,groovyComposites:t.groovyComposites};e.post("/runner/run.json",r).then(function(e){t.storyRunnerSuccess="OK"===e.data.status,t.storyRunnerInProgress=!1,t.getReports(e.data.id)},function(e){t.storyRunnerSuccess=!1,t.storyRunnerInProgress=!1,t.openErrorModal(e.data)})},function(e){t.openErrorModal(e.data)}))},t.getReports=function(o){e.get("/api/v1/reporters/list/"+o).then(function(e){t.reports=e.data,t.reports.id=o,t.setPendingSteps(t.reports)},function(e){t.openErrorModal(e.data)})},t.getReportUrl=function(t,e){return"/api/v1/reporters/get/"+t+"/"+e},t.openRunnerModal=function(){return u.openRunnerParametersModal(!1)},t.getRunnerProgressCss=function(){return u.getRunnerProgressCss(t.storyRunnerInProgress)},t.getRunnerStatusCss=function(){return u.getRunnerStatusCss(t.storyRunnerInProgress,t.storyRunnerSuccess,t.pendingSteps>0)},t.setPendingSteps=function(e){t.pendingSteps=[],e.forEach(function(e){e.steps.forEach(function(e){"pending"===e.status&&t.pendingSteps.push({text:e.text})})})},t.hasPendingSteps=function(){return void 0!==t.pendingSteps&&t.pendingSteps.length>0},t.getStoryRunnerStatusText=function(){var e;return e=u.getStoryRunnerStatusText(t.storyRunnerInProgress,t.storyRunnerSuccess,t.pendingSteps.length),t.storyRunnerVisible||(e="Not run"),e},t.removeCollectionElement=u.removeCollectionElement,t.addElement=function(t){t.push({})},t.addScenarioElement=function(t){t.push({title:"",meta:[],steps:[],examplesTable:""})},t.revertStory=function(){t.story=angular.copy(t.originalStory),t.storyForm.$setPristine()},t.canRevertStory=function(){return!angular.equals(t.story,t.originalStory)},t.canDeleteStory=function(){return"PUT"===t.action&&!t.storyRunnerInProgress},t.deleteStory=function(){var e=t.dirPath+t.story.name+".story";u.deleteStory(e)},t.stepEnterKey=u.newCollectionItem,t.clickPendingStep=function(t){var e=n.get("compositeClass");return void 0===e||""===e?u.openCompositeClass(t):s.search("stepText",t).path("/page/composites/composites.com.technologyconversations.bdd.steps."+e)},t.openErrorModal=u.openErrorModal}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlcyI6WyJpbmRleC5qcyIsImNvbmZpZy5qcyIsImNvbW1vblxcYm9keS5jdHJsLmpzIiwiY29tcG9zaXRlQ2xhc3Nlc1xcY29tcG9zaXRlQ2xhc3Nlcy5jdHJsLmpzIiwiY29tcG9zaXRlc1xcY29tcG9zaXRlcy5jdHJsLmpzIiwicnVubmVyXFxydW5uZXIuY3RybC5qcyIsInRvcE1lbnVcXHRvcE1lbnUuY3RybC5qcyIsInN0b3J5XFxzdG9yeS5jdHJsLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFFBQUEsT0FBQSxpQkFDQSxVQUNBLFlBQ0EsZUFDQSxjQUNBLGVBQ0EsYUFDQSxnQkFDQSxjQUNBLHlCQUNBLG1CQUNBLGlCQUVBLFFBQUEsZ0JBQUEsU0FBQSxRQUFBLFlBQUEsS0FBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsS0FBQSxtQkFBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLElBQ0EsR0FBQSxNQUNBLFlBQUEsMkRBQ0EsV0FBQSx1QkFDQSxTQUNBLGtCQUFBLFNBQUEsUUFBQSxTQUFBLFdBQ0EsTUFBQSxHQUFBLFFBQUEscUJBQUEsS0FFQSxrQkFBQSxXQUNBLE1BQUEsUUFLQSxLQUFBLGtCQUFBLFNBQUEsRUFBQSxHQUNBLEtBQUEsRUFBQSxPQUNBLEVBQUEsVUFHQSxLQUFBLHdCQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsT0FBQSxFQUFBLElBRUEsS0FBQSxlQUFBLFNBQUEsR0FDQSxPQUNBLGNBQUEsRUFBQSxPQUNBLGFBQUEsRUFBQSxXQUdBLEtBQUEscUJBQUEsU0FBQSxHQUNBLE9BQ0EsbUNBQUEsRUFDQSxVQUFBLElBR0EsS0FBQSx5QkFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsR0FDQSwyQkFDQSxFQUNBLEVBQUEsRUFDQSxpQ0FBQSxFQUFBLGlCQUVBLDJCQUdBLG9CQUdBLEtBQUEsbUJBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxPQUNBLGlDQUFBLEVBQ0EscUNBQUEsR0FBQSxHQUFBLEVBQ0EscUNBQUEsR0FBQSxJQUFBLEVBQ0Esb0NBQUEsSUFBQSxJQUdBLEtBQUEsMEJBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxJQUNBLE9BQUEsR0FBQSxNQUNBLFlBQUEsNkNBQ0EsV0FBQSxtQkFDQSxTQUNBLE1BQUEsU0FBQSxRQUFBLFNBQUEsV0FDQSxNQUFBLEdBQUEsUUFBQSx1QkFBQSxLQUVBLFdBQUEsV0FDQSxNQUFBLFFBS0EsS0FBQSxRQUFBLFNBQUEsRUFBQSxHQUNBLEdBQUEsT0FBQSxFQUFBLENBQ0EsR0FBQSxHQUFBLEVBQUEsU0FBQSxNQUFBLElBQ0EsR0FBQSxTQUFBLEVBQUEsTUFBQSxFQUFBLEVBQUEsT0FBQSxHQUFBLEtBQUEsS0FDQSxLQUFBLEVBQUEsV0FDQSxFQUFBLFVBQUEsS0FFQSxLQUFBLFdBQUEsRUFBQSxRQUVBLE1BQUEsV0FBQSxFQUFBLElBR0EsS0FBQSxXQUFBLFNBQUEsRUFBQSxHQUNBLEdBQUEsR0FBQSxJQUNBLFVBQUEsRUFBQSxXQUNBLEVBQUEsU0FBQSxJQUVBLEVBQUEsSUFBQSwyQkFBQSxFQUFBLFNBQUEsR0FBQSxLQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsRUFBQSxLQUNBLEtBQUEsSUFDQSxFQUFBLFVBQUEsRUFBQSxNQUVBLFNBQUEsR0FDQSxFQUFBLGVBQUEsRUFBQSxTQUdBLEtBQUEsZ0JBQUEsV0FDQSxNQUFBLDBCQUVBLEtBQUEsc0JBQUEsU0FBQSxHQUNBLE1BQUEsR0FBQSxNQUNBLFlBQUEsMkNBQ0EsV0FBQSxZQUNBLFNBQ0EsS0FBQSxXQUNBLE1BQUEsUUFLQSxLQUFBLGlCQUFBLFdBQ0EsTUFBQSw2QkFFQSxLQUFBLFNBQUEsU0FBQSxHQUNBLE9BQ0EsWUFBQSxFQUFBLFNBQ0EsY0FBQSxFQUFBLFFBQUEsRUFBQSxTQUlBLEtBQUEsWUFBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLEtBQ0EsRUFBQSxFQUFBLFFBQ0EsR0FBQSxPQUFBLGVBQUEsUUFBQSwrQ0FDQSxFQUFBLEtBQUEsc0JBQUEsRUFZQSxPQVhBLEdBQUEsT0FBQSxLQUFBLFdBQ0EsRUFBQSxPQUFBLGtCQUFBLEdBQUEsS0FBQSxXQUNBLEVBQUEsS0FBQSxzQkFDQSxFQUFBLFFBQUEsT0FDQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEVBQUEsTUFDQSxFQUFBLE9BQUEsVUFFQSxXQUNBLEVBQUEsT0FBQSxTQUVBLEVBQUEsU0FFQSxLQUFBLFFBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLElBQ0EsT0FBQSxHQUFBLElBQUEsR0FBQSxNQUFBLElBQUEsS0FBQSxTQUFBLEdBQ0EsTUFBQSxHQUFBLE1BQ0EsU0FBQSxHQUNBLEVBQUEsZUFBQSxFQUFBLFNBR0EsS0FBQSxlQUFBLFNBQUEsR0FDQSxFQUFBLE1BQ0EsWUFBQSxvQ0FDQSxXQUFBLFlBQ0EsU0FDQSxLQUFBLFdBQ0EsTUFBQSxXQU1BLFdBQUEsYUFBQSxTQUFBLGlCQUFBLE9BQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLEtBQUEsRUFDQSxFQUFBLEdBQUEsV0FDQSxFQUFBLE1BQUEsT0FFQSxFQUFBLE9BQUEsV0FDQSxFQUFBLFFBQUEsY0FHQSxXQUFBLGVBQUEsU0FBQSxRQUFBLFNBQUEsaUJBQUEsWUFBQSxLQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsV0FBQSxFQUFBLElBQ0EsRUFBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLFFBQUEsRUFBQSxJQUVBLEVBQUEsTUFBQSxXQUNBLEVBQUEsU0FFQSxFQUFBLGFBQUEsU0FBQSxHQUNBLE1BQUEsc0JBQUEsRUFBQSxTQUFBLEdBRUEsRUFBQSxlQUFBLFdBQ0EsTUFBQSxLQUFBLEVBQUEsVUFHQSxFQUFBLFlBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsU0FBQSxFQUFBLFFBQ0EsR0FBQSxZQUFBLEdBQUEsS0FBQSxXQUNBLEVBQUEsTUFBQSxRQUFBLE9BQUEsRUFBQSxNQUlBLEVBQUEsZ0JBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxhQUFBLEVBQUEsU0FBQSxFQUFBLElBQ0EsR0FBQSxLQUFBLG9CQUFBLEdBQUEsS0FBQSxXQUNBLEVBQUEsTUFBQSxLQUFBLE1BQUEsS0FBQSxLQUNBLFNBQUEsR0FDQSxFQUFBLGVBQUEsRUFBQSxZQ2pOQSxRQUFBLE9BQUEsbUJBQ0EsUUFBQSxpQkFBQSxvQkFBQSxTQUFBLEVBQUEsR0FDQSxFQUFBLFdBQUEsR0FDQSxFQUVBLEtBQUEsc0JBQ0EsWUFBQSxxQ0FDQSxXQUFBLFlBRUEsU0FDQSxPQUFBLFFBQUEsU0FBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLFFBQUEsdUJBQUEsS0FFQSxPQUFBLFFBQUEsU0FBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLFFBQUEsb0JBQUEsS0FFQSxrQkFBQSxRQUFBLFNBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsR0FBQSxRQUFBLHFCQUFBLFFBSUEsS0FBQSw0QkFDQSxZQUFBLHFDQUNBLFdBQUEsWUFFQSxTQUNBLE9BQUEsU0FBQSxRQUFBLFNBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLFFBQUEsNEJBQUEsRUFBQSxRQUFBLE9BQUEsS0FBQSxVQUFBLEtBRUEsT0FBQSxRQUFBLFNBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsR0FBQSxRQUFBLG9CQUFBLEtBRUEsa0JBQUEsUUFBQSxTQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxNQUFBLEdBQUEsUUFBQSxxQkFBQSxRQUlBLEtBQUEsNkJBQ0EsWUFBQSxxQ0FDQSxXQUFBLFlBRUEsU0FDQSxPQUFBLFNBQUEsUUFBQSxTQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsR0FBQSxRQUFBLDRCQUFBLEVBQUEsUUFBQSxPQUFBLEtBQUEsVUFBQSxLQUVBLE9BQUEsUUFBQSxTQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxNQUFBLEdBQUEsUUFBQSxvQkFBQSxLQUVBLGtCQUFBLFFBQUEsU0FBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLFFBQUEscUJBQUEsTUFHQSxnQkFBQSxJQUVBLEtBQUEsZ0NBQ0EsWUFBQSwrQ0FDQSxXQUFBLGlCQUVBLFNBQ0EsaUJBQUEsU0FBQSxRQUFBLFNBQUEsRUFBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLFFBQUEsT0FBQSxVQUNBLEVBQUEscUJBQUEsQ0FDQSxPQUFBLEdBQUEsSUFBQSxHQUFBLE9BQUEsSUFBQSxLQUFBLFNBQUEsR0FDQSxNQUFBLEdBQUEsTUFDQSxXQUNBLEdBQUEsR0FBQSxFQUFBLFVBQUEsRUFBQSxFQUFBLFlBQUEsS0FDQSxRQUNBLFFBQUEsRUFDQSxhQUFBLFNBQUEsR0FBQSxzQkFDQSxPQUFBLE9BSUEsT0FBQSxRQUFBLFNBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsR0FBQSxRQUFBLG9CQUFBLFFBSUEsS0FBQSxpQkFDQSxZQUFBLHVDQUNBLFdBQUEsYUFFQSxTQUNBLE1BQUEsU0FBQSxTQUFBLEdBQ0EsT0FBQSxZQUFBLEVBQUEsUUFBQSxPQUFBLFdBS0EsV0FDQSxXQUFBLHlCQzFGQSxRQUFBLE9BQUEsaUJBQ0EsV0FBQSxZQUFBLFNBQUEsZUNEQSxRQUFBLE9BQUEsNkJBQ0EsV0FBQSx3QkFBQSxTQUFBLFFBQUEsaUJBQUEsbUJBQUEsb0JBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsaUJBQUEsRUFDQSxFQUFBLGtCQUFBLEVBRUEsRUFBQSxNQUFBLFdBQ0EsRUFBQSxTQUVBLEVBQUEsa0JBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLG1CQUNBLFVBQUEsR0FBQSxLQUFBLElBQ0EsR0FBQSxFQUFBLElBRUEsSUFBQSxFQVVBLE9BUkEsR0FBQSxFQUFBLE1BREEsRUFBQSxRQUFBLE1BQUEsRUFDQSxJQUVBLE1BRUEsR0FBQSxFQUFBLEVBQUEsT0FBQSxHQUNBLFNBQUEsRUFBQSxtQkFBQSxLQUFBLEVBQUEsb0JBQ0EsR0FBQSxhQUFBLEVBQUEsbUJBRUEsR0FFQSxFQUFBLG1CQUFBLFNBQUEsR0FDQSxHQUFBLEVBRUEsR0FBQSxFQUFBLE1BREEsRUFBQSxRQUFBLE1BQUEsRUFDQSxJQUVBLEtBRUEsSUFBQSxHQUFBLEVBQUEsRUFBQSxPQUFBLEVBSUEsT0FIQSxHQUFBLFFBQUEsTUFBQSxJQUNBLEVBQUEsRUFBQSxPQUFBLEVBQUEsRUFBQSxZQUFBLE9BRUEsR0FFQSxFQUFBLGlCQUFBLEVBQUEsaUJBRUEsRUFBQSxTQUFBLEVBQUEsU0FDQSxFQUFBLE1BQUEsUUFBQSxPQ3pDQSxRQUFBLE9BQUEsdUJBQ0EsV0FBQSxrQkFBQSxTQUFBLFFBQUEsU0FBQSxZQUFBLGVBQUEsa0JBQUEsUUFBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsZ0JBQUEsV0FDQSxFQUFBLFdBQUEsU0FBQSxHQUFBLHFCQUNBLEVBQUEsZ0JBQUEsV0FBQSxLQUFBLEVBQUEsWUFFQSxFQUFBLGlCQUFBLFdBQ0EsU0FBQSxFQUFBLFNBQUEsVUFBQSxLQUFBLEVBQUEsU0FBQSxVQUNBLEVBQUEsZ0JBQUEsV0FBQSxNQUFBLFNBQUEsRUFBQSxTQUFBLFNBQUEscUJBR0EsRUFBQSxvQkFBQSxXQUNBLEVBQUEsVUFBQSxlQUFBLFVBRUEsRUFBQSxpQkFBQSxXQUNBLEdBQUEsU0FBQSxFQUFBLGdCQUFBLENBQ0EsR0FBQSxHQUFBLEVBQUEsZ0JBQUEsV0FBQSxNQUNBLEdBQUEsVUFBQSxFQUFBLGdCQUFBLFdBQUEsRUFBQSxPQUVBLEdBQUEsY0FHQSxFQUFBLGdCQUFBLEVBQ0EsRUFBQSxtQkFDQSxFQUFBLHdCQUFBLFFBQUEsS0FBQSxHQUNBLEVBQUEsbUJBQ0EsRUFBQSxNQUFBLEVBQ0EsRUFBQSxpQkFBQSxFQUFBLGlCQUNBLEVBQUEsZ0JBQUEsRUFBQSxnQkFDQSxFQUFBLFNBQUEsRUFBQSxTQUVBLEVBQUEsZUFBQSxTQUFBLEVBQUEsR0FDQSxNQUdBLEdBQUEsZUFIQSxFQUFBLE9BR0EsRUFGQSxJQUtBLEVBQUEsY0FBQSxTQUFBLEdBQ0EsRUFBQSxVQUFBLEdBRUEsRUFBQSxrQkFBQSxFQUFBLGtCQUNBLEVBQUEsd0JBQUEsRUFBQSx3QkFDQSxFQUFBLHNCQUFBLFdBQ0EsRUFBQSxnQkFBQSxRQUFBLEtBQUEsRUFBQSx5QkFDQSxFQUFBLFVBQUEsRUFBQSxnQkFBQSxXQUFBLElBRUEsRUFBQSx5QkFBQSxXQUNBLE9BQUEsUUFBQSxPQUFBLEVBQUEsZ0JBQUEsRUFBQSwwQkFFQSxFQUFBLHVCQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxPQUNBLEdBQUEsUUFBQSxPQUFBLEVBQUEsZ0JBQUEsRUFBQSx5QkFDQSxFQUFBLEVBQUEsZ0JBQUEsS0FDQSxRQUFBLEdBQUEsSUFBQSxHQUVBLEVBQUEsbUJBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLE1BUUEsT0FQQSxTQUFBLFFBQUEsRUFBQSxnQkFBQSxXQUFBLFNBQUEsR0FDQSxTQUFBLEVBQUEsVUFBQSxLQUFBLEVBQUEsU0FDQSxHQUFBLEdBQ0EsU0FBQSxFQUFBLGdCQUFBLElBQUEsRUFBQSxlQUFBLFVBQ0EsR0FBQSxLQUdBLEdBRUEsRUFBQSxvQkFBQSxXQUNBLEVBQUEsSUFBQSxvQkFBQSxFQUFBLGlCQUFBLEtBQUEsV0FDQSxFQUFBLDJDQUNBLEVBQUEsS0FBQSxvQkFBQSxFQUFBLGdCQUFBLE1BQUEsV0FDQSxFQUFBLGdCQUFBLE9BQUEsRUFDQSxFQUFBLHdCQUFBLFFBQUEsS0FBQSxFQUFBLGlCQUNBLEVBQUEsSUFBQSxpQkFBQSxFQUFBLGdCQUFBLFFBQ0EsU0FBQSxHQUNBLEVBQUEsZUFBQSxFQUFBLFNBR0EsRUFBQSx5QkFBQSxXQUNBLE9BQUEsRUFBQSxnQkFBQSxPQUlBLEVBQUEseUNBQUEsV0FDQSxHQUFBLEdBQUEsRUFBQSxnQkFBQSxNQUNBLEVBQUEsRUFBQSx3QkFBQSxLQUNBLEtBQUEsR0FDQSxFQUFBLE9BQUEscUJBQUEsR0FBQSxLQUFBLGFBQ0EsU0FBQSxHQUNBLEVBQUEsZUFBQSxFQUFBLFNBS0EsRUFBQSxzQkFBQSxXQUNBLEdBQUEsSUFBQSxPQUFBLDBCQUFBLFFBQUEsMERBQ0EsRUFBQSxFQUFBLHNCQUFBLEVBQ0EsR0FBQSxPQUFBLEtBQUEsV0FDQSxFQUFBLE9BQUEscUJBQUEsRUFBQSx3QkFBQSxPQUFBLEtBQUEsV0FDQSxFQUFBLEtBQUEsTUFDQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEVBQUEsU0FFQSxlQUlBLEVBQUEsbUJBQUEsV0FDQSxNQUFBLEdBQUEsZ0JBQUEsTUFDQSx3QkFFQSx3QkMvR0EsUUFBQSxPQUFBLG1CQUNBLFdBQUEsY0FBQSxTQUFBLFNBQUEsUUFBQSxZQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsRUFBQSxtQkFBQSxXQUNBLE1BQUEsR0FBQSxNQUNBLFlBQUEsK0NBQ0EsV0FBQSxxQkFDQSxTQUNBLEtBQUEsV0FDQSxjQU1BLEVBQUEsV0FBQSxXQUNBLEdBQUEsR0FBQSxFQUFBLG9CQUNBLFVBQUEsR0FDQSxFQUFBLE9BQUEsS0FBQSxTQUFBLEdBQ0EsR0FBQSxLQUNBLEdBQUEsS0FBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsS0FBQSxFQUFBLEtBQUEsa0JBRUEsRUFBQSxRQUFBLFFBQUEsU0FBQSxHQUNBLEVBQUEsTUFBQSxLQUFBLEVBQUEsU0FFQSxFQUFBLDJCQUFBLEdBQUEsT0FBQSxLQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxRQUNBLEVBQUEsRUFBQSxNQUNBLEdBQUEsSUFBQSxxQkFBQSxLQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxJQUNBLEdBQUEsU0FDQSxXQUFBLEVBQ0EsUUFBQSxFQUNBLGlCQUFBLEdBRUEsUUFBQSxHQUNBLEVBQUEsSUFBQSxFQUFBLFNBQ0EsRUFBQSxTQUFBLEdBRUEsRUFBQSxTQUFBLFNBT0EsRUFBQSxJQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsd0JBQ0EsR0FBQSx1QkFBQSxFQUNBLEVBQUEsb0JBQUEsRUFDQSxFQUFBLFdBQUEsR0FDQSxFQUFBLEtBQUEsbUJBQUEsR0FBQSxLQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxJQUNBLFFBQUEsRUFBQSxRQUNBLEVBQUEsV0FBQSxFQUFBLEVBQUEsWUFDQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxvQkFBQSxHQUNBLFdBQUEsRUFBQSxRQUNBLEVBQUEsV0FBQSxFQUFBLEVBQUEsWUFDQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxvQkFBQSxHQUdBLEVBQUEsZUFBQSxHQUVBLEVBQUEsdUJBQUEsRUFDQSxFQUFBLG9CQUFBLEdBQ0EsU0FBQSxHQUNBLEVBQUEsdUJBQUEsRUFDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSxlQUFBLEVBQUEsU0FHQSxFQUFBLG1CQUFBLFdBQ0EsTUFBQSxHQUFBLG1CQUNBLEVBQUEsc0JBQ0EsRUFBQSxtQkFDQSxFQUFBLGFBQUEsSUFHQSxFQUFBLHlCQUFBLFdBQ0EsTUFBQSxHQUFBLHNCQUNBLDZCQUVBLDJCQUdBLEVBQUEscUJBQUEsV0FDQSxNQUFBLEdBQUEscUJBQUEsRUFBQSx3QkFFQSxFQUFBLEtBQUEsV0FDQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxvQkFBQSxFQUNBLEVBQUEsb0JBQUEsRUFDQSxFQUFBLGdCQUNBLEVBQUEsV0FBQSxHQUNBLEVBQUEsYUFDQSxFQUFBLFNBQUEsR0FFQSxFQUFBLE9BQUEsV0FDQSxNQUFBLEdBQUEsV0FBQSxNQUFBLEVBQUEsT0FBQSxJQUFBLEVBQUEsT0FBQSxvQkFFQSxFQUFBLFVBRUEsV0FBQSxzQkFBQSxTQUFBLFFBQUEsU0FBQSxpQkFBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsT0FBQSxRQUFBLFlBQ0EsRUFBQSxXQUFBLEVBQUEsSUFDQSxFQUFBLFFBQUEsU0FBQSxHQUNBLEVBQUEsUUFBQSxFQUFBLElBRUEsRUFBQSxxQkFBQSxXQUNBLEVBQUEsUUFBQSxXQUVBLEVBQUEsaUJBQUEsV0FDQSxHQUFBLElBQUEsUUFBQSxXQUNBLFNBQUEsUUFBQSxFQUFBLE1BQUEsS0FBQSxTQUFBLEdBQ0EsRUFBQSxVQUNBLEVBQUEsS0FBQSxNQUFBLEtBQUEsRUFBQSxTQUFBLEVBQUEsU0FHQSxRQUFBLFFBQUEsRUFBQSxNQUFBLFFBQUEsU0FBQSxHQUNBLEVBQUEsVUFDQSxFQUFBLFFBQUEsTUFBQSxLQUFBLEVBQUEsU0FBQSxFQUFBLEtBQUEsYUFHQSxFQUFBLE1BQUEsSUFFQSxFQUFBLGVBQUEsV0FDQSxNQUFBLEtBQUEsRUFBQSxVQUVBLEVBQUEsWUFBQSxXQUNBLEdBQUEsSUFBQSxDQWFBLE9BWkEsU0FBQSxRQUFBLEVBQUEsTUFBQSxLQUFBLFNBQUEsR0FDQSxFQUFBLFdBQ0EsR0FBQSxLQUdBLEdBQ0EsUUFBQSxRQUFBLEVBQUEsTUFBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLFdBQ0EsR0FBQSxLQUlBLE1BR0EsV0FBQSxvQkFBQSxTQUFBLGlCQUFBLGVBQUEsT0FBQSxhQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsUUFBQSxFQUFBLFFBQ0EsRUFBQSxjQUNBLEVBQUEsVUFBQSxXQUNBLEVBQUEsUUFBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLE9BQUEsUUFBQSxTQUFBLEdBQ0EsR0FBQSxTQUFBLEVBQUEsT0FBQSxLQUFBLEVBQUEsTUFDQSxFQUFBLFVBQUEsTUFDQSxDQUNBLEVBQUEsVUFBQSxDQUNBLEtBQ0EsRUFBQSxNQUFBLEVBQUEsSUFBQSxFQUFBLFNBQUEsSUFBQSxFQUFBLEtBQ0EsTUFBQSxHQUNBLFFBQUEsSUFBQSw2QkFBQSxFQUFBLFNBQUEsSUFBQSxFQUFBLEtBQ0EsUUFBQSxJQUFBLEVBQUEsZ0JBTUEsRUFBQSxXQUFBLFNBQUEsR0FDQSxNQUFBLEdBQ0EsRUFBQSxPQUFBLEdBRUEsR0FHQSxFQUFBLFVBQUEsU0FBQSxHQUNBLE1BQUEsVUFBQSxFQUFBLFFBQUEsRUFBQSxPQUFBLE9BQUEsR0FFQSxFQUFBLEdBQUEsV0FDQSxFQUFBLE9BQUEsT0FBQSxNQUFBLFFBQUEsRUFBQSxXQUVBLEVBQUEsT0FBQSxXQUNBLEVBQUEsUUFBQSxXQUVBLEVBQUEsV0FBQSxXQUNBLE1BQUEsSUFFQSxFQUFBLE9BQUEsV0FDQSxFQUFBLE9BQUEsT0FBQSxNQUFBLFFBQUEsRUFBQSxXQUVBLEVBQUEsZUFBQSxTQUFBLEVBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxPQUFBLEdBQUEsY0FBQSxFQUFBLE1BQUEsR0FDQSxFQUFBLEVBQUEsT0FBQSxHQUFBLGNBQUEsRUFBQSxNQUFBLEVBQ0EsT0FBQSxHQUFBLEdBRUEsRUFBQSxlQ25NQSxRQUFBLE9BQUEsb0JBQ0EsV0FBQSxxQkFBQSxTQUFBLFNBQUEsWUFBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FFQSxFQUFBLFVBQUEsV0FDQSxFQUFBLE1BQ0EsWUFBQSxpQ0FDQSxXQUFBLGNBQ0EsU0FDQSxLQUFBLFdBQ0EsY0FLQSxFQUFBLG1CQUFBLFdBQ0EsRUFBQSxzQkFFQSxFQUFBLFNBQUEsV0FDQSxHQUFBLEdBQUEsRUFBQSxNQUNBLE9BQUEsS0FBQSxFQUFBLFFBQUEsdUJBQ0EsYUFDQSxJQUFBLEVBQUEsUUFBQSxzQkFDQSxZQUNBLElBQUEsRUFBQSxRQUFBLHFCQUNBLGFBQ0EsSUFBQSxFQUFBLFFBQUEsa0JBQ0EsVUFFQSxPQzVCQSxRQUFBLE9BQUEsa0JBQ0EsV0FBQSxhQUFBLFNBQUEsUUFBQSxTQUFBLFlBQUEsZUFBQSxLQUFBLGdCQUFBLFFBQUEsUUFBQSxtQkFBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsZ0JBQ0EsRUFBQSxVQUFBLFdBRUEsRUFBQSxPQURBLEtBQUEsRUFBQSxNQUFBLEtBQ0EsTUFFQSxRQUdBLEVBQUEsYUFBQSxXQUNBLEdBQUEsSUFBQSxDQUNBLFVBQUEsRUFBQSxlQUNBLEVBQUEsZ0JBQUEsR0FFQSxFQUFBLGdCQUFBLEVBQUEsZUFDQSxFQUFBLEVBQUEsZ0JBRUEsRUFBQSxRQUNBLE1BQUEsRUFBQSxlQUNBLFlBQUEsRUFBQSxlQUNBLEtBQUEsRUFBQSxlQUNBLFVBQUEsRUFBQSxlQUNBLGFBQUEsRUFBQSxlQUNBLFVBQUEsRUFBQSxlQUNBLFVBQUEsSUFJQSxFQUFBLE1BQUEsRUFDQSxFQUFBLE1BQUEsRUFDQSxFQUFBLGlCQUFBLEVBQ0EsRUFBQSxXQUFBLFFBQUEsT0FBQSxRQUNBLEVBQUEsZUFBQSxxREFDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSx1QkFBQSxFQUNBLEVBQUEsb0JBQUEsRUFDQSxFQUFBLGVBQ0EsRUFBQSxPQUFBLE9BQUEsRUFDQSxFQUFBLG1CQUNBLE9BQUEsR0FHQSxFQUFBLGNBQUEsUUFBQSxLQUFBLEVBQ0EsSUFBQSxHQUFBLEVBQUEsTUFBQSxLQUFBLE1BQUEsSUFDQSxHQUFBLFFBQUEsRUFBQSxNQUFBLEVBQUEsRUFBQSxPQUFBLEdBQUEsS0FBQSxLQUNBLEtBQUEsRUFBQSxVQUNBLEVBQUEsU0FBQSxLQUVBLEVBQUEsWUFDQSxFQUFBLFNBQUEsRUFBQSxTQUNBLEVBQUEsZUFBQSxFQUFBLGVBQ0EsRUFBQSxhQUFBLFdBQ0EsR0FBQSxHQUFBLEVBQUEsVUFBQSxPQUNBLEdBQUEsUUFBQSxPQUFBLEVBQUEsTUFBQSxFQUFBLGNBQ0EsT0FBQSxJQUFBLEdBRUEsRUFBQSxnQkFBQSxFQUFBLGdCQUVBLEVBQUEsVUFBQSxXQUNBLEdBQUEsRUFBQSxlQUVBLEdBREEsRUFBQSxNQUFBLEtBQUEsRUFBQSxRQUFBLEVBQUEsTUFBQSxLQUFBLFNBQ0EsU0FBQSxFQUFBLE9BQUEsQ0FDQSxHQUFBLEdBQUEsRUFBQSxRQUFBLE1BQUEsS0FDQSxFQUFBLEVBQUEsTUFBQSxFQUFBLEVBQUEsT0FBQSxHQUFBLEtBQUEsSUFDQSxNQUFBLElBQ0EsR0FBQSxLQUVBLEVBQUEsS0FBQSxzQkFBQSxFQUFBLE9BQUEsS0FBQSxXQUNBLEVBQUEsS0FBQSxzQkFBQSxFQUFBLEVBQUEsTUFBQSxNQUNBLEVBQUEsY0FBQSxRQUFBLEtBQUEsRUFBQSxRQUNBLFNBQUEsR0FDQSxFQUFBLGVBQUEsRUFBQSxZQUdBLEdBQUEsTUFBQSxPQUFBLEVBQUEsY0FBQSxPQUNBLEVBQUEsTUFBQSxhQUFBLEVBQUEsY0FBQSxNQUVBLEVBQUEsSUFBQSxzQkFBQSxFQUFBLE9BQUEsS0FBQSxXQUNBLEVBQUEsY0FBQSxRQUFBLEtBQUEsRUFBQSxRQUNBLFNBQUEsR0FDQSxFQUFBLGVBQUEsRUFBQSxTQUtBLEVBQUEsWUFBQSxXQUNBLE1BQUEsR0FBQSxVQUFBLFNBQUEsRUFBQSx1QkFHQSxFQUFBLFNBQUEsV0FDQSxFQUFBLGdCQUNBLEVBQUEsa0JBQUEsT0FBQSxFQUNBLEVBQUEsWUFDQSxFQUFBLGtCQUFBLE9BQUEsS0FBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsT0FDQSxHQUFBLGVBQUEsV0FDQSxFQUFBLGlCQUFBLFdBQ0EsRUFBQSxvQkFBQSxFQUNBLEVBQUEsdUJBQUEsRUFDQSxFQUFBLFFBQUEsU0FBQSxHQUNBLEVBQUEsT0FBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLElBQUEsRUFBQSxTQUFBLElBQUEsRUFBQSxJQUFBLEVBQUEsVUFHQSxJQUFBLElBQ0EsYUFBQSxLQUFBLEVBQUEsTUFBQSxPQUNBLFFBQUEsRUFDQSxpQkFBQSxFQUFBLGlCQUVBLEdBQUEsS0FBQSxtQkFBQSxHQUFBLEtBQUEsU0FBQSxHQUNBLEVBQUEsbUJBQUEsT0FBQSxFQUFBLEtBQUEsT0FDQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxXQUFBLEVBQUEsS0FBQSxLQUNBLFNBQUEsR0FDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSx1QkFBQSxFQUNBLEVBQUEsZUFBQSxFQUFBLFNBRUEsU0FBQSxHQUNBLEVBQUEsZUFBQSxFQUFBLFVBSUEsRUFBQSxXQUFBLFNBQUEsR0FDQSxFQUFBLElBQUEsMEJBQUEsR0FBQSxLQUFBLFNBQUEsR0FDQSxFQUFBLFFBQUEsRUFBQSxLQUNBLEVBQUEsUUFBQSxHQUFBLEVBQ0EsRUFBQSxnQkFBQSxFQUFBLFVBQ0EsU0FBQSxHQUVBLEVBQUEsZUFBQSxFQUFBLFNBR0EsRUFBQSxhQUFBLFNBQUEsRUFBQSxHQUNBLE1BQUEseUJBQUEsRUFBQSxJQUFBLEdBRUEsRUFBQSxnQkFBQSxXQUNBLE1BQUEsR0FBQSwyQkFBQSxJQUVBLEVBQUEscUJBQUEsV0FDQSxNQUFBLEdBQUEscUJBQUEsRUFBQSx3QkFFQSxFQUFBLG1CQUFBLFdBQ0EsTUFBQSxHQUFBLG1CQUNBLEVBQUEsc0JBQ0EsRUFBQSxtQkFDQSxFQUFBLGFBQUEsSUFHQSxFQUFBLGdCQUFBLFNBQUEsR0FDQSxFQUFBLGdCQUNBLEVBQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxNQUFBLFFBQUEsU0FBQSxHQUNBLFlBQUEsRUFBQSxRQUNBLEVBQUEsYUFBQSxNQUFBLEtBQUEsRUFBQSxZQUtBLEVBQUEsZ0JBQUEsV0FDQSxNQUFBLFVBQUEsRUFBQSxjQUFBLEVBQUEsYUFBQSxPQUFBLEdBRUEsRUFBQSx5QkFBQSxXQUNBLEdBQUEsRUFZQSxPQVZBLEdBQUEsRUFBQSx5QkFDQSxFQUFBLHNCQUNBLEVBQUEsbUJBQ0EsRUFBQSxhQUFBLFFBR0EsRUFBQSxxQkFDQSxFQUFBLFdBR0EsR0FFQSxFQUFBLHdCQUFBLEVBQUEsd0JBQ0EsRUFBQSxXQUFBLFNBQUEsR0FDQSxFQUFBLFVBRUEsRUFBQSxtQkFBQSxTQUFBLEdBQ0EsRUFBQSxNQUFBLE1BQUEsR0FBQSxRQUFBLFNBQUEsY0FBQSxNQUVBLEVBQUEsWUFBQSxXQUNBLEVBQUEsTUFBQSxRQUFBLEtBQUEsRUFBQSxlQUNBLEVBQUEsVUFBQSxnQkFFQSxFQUFBLGVBQUEsV0FDQSxPQUFBLFFBQUEsT0FBQSxFQUFBLE1BQUEsRUFBQSxnQkFFQSxFQUFBLGVBQUEsV0FDQSxNQUFBLFFBQUEsRUFBQSxTQUFBLEVBQUEsdUJBR0EsRUFBQSxZQUFBLFdBQ0EsR0FBQSxHQUFBLEVBQUEsUUFBQSxFQUFBLE1BQUEsS0FBQSxRQUNBLEdBQUEsWUFBQSxJQUVBLEVBQUEsYUFBQSxFQUFBLGtCQUVBLEVBQUEsaUJBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLElBQUEsaUJBQ0EsT0FBQSxVQUFBLEdBQUEsS0FBQSxFQUNBLEVBQUEsbUJBQUEsR0FFQSxFQUFBLE9BQUEsV0FBQSxHQUFBLEtBQUEscUVBQUEsSUFJQSxFQUFBLGVBQUEsRUFBQSIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdzdG9yaWVzTW9kdWxlJywgW1xyXG4gICAgJ25nUm91dGUnLFxyXG4gICAgJ25nQ29va2llcycsXHJcbiAgICAndWkuYm9vdHN0cmFwJyxcclxuICAgICd1aS5zb3J0YWJsZScsXHJcbiAgICAnY29uZmlnTW9kdWxlJyxcclxuICAgICdib2R5TW9kdWxlJyxcclxuICAgICd0b3BNZW51TW9kdWxlJyxcclxuICAgICdzdG9yeU1vZHVsZScsXHJcbiAgICAnY29tcG9zaXRlQ2xhc3Nlc01vZHVsZScsXHJcbiAgICAnY29tcG9zaXRlc01vZHVsZScsXHJcbiAgICAncnVubmVyTW9kdWxlJ1xyXG5dKVxyXG4gICAgLnNlcnZpY2UoJ1RjQmRkU2VydmljZScsIGZ1bmN0aW9uKCRtb2RhbCwgJGh0dHAsICRsb2NhdGlvbiwgJHEpIHtcclxuICAgICAgICB0aGlzLm9wZW5Db21wb3NpdGVDbGFzcyA9IGZ1bmN0aW9uKGNvbXBvc2l0ZVN0ZXBUZXh0KSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvY29tcG9zaXRlQ2xhc3Nlcy9jb21wb3NpdGVDbGFzc2VzLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnY29tcG9zaXRlQ2xhc3Nlc0N0cmwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvc2l0ZUNsYXNzZXM6IGZ1bmN0aW9uKCRyb3V0ZSwgJGh0dHAsICRtb2RhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRKc29uKCcvZ3Jvb3Z5Q29tcG9zaXRlcycsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvc2l0ZVN0ZXBUZXh0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvc2l0ZVN0ZXBUZXh0O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm5ld0NvbGxlY3Rpb25JdGVtID0gZnVuY3Rpb24oZXZlbnQsIGNvbGxlY3Rpb24pIHtcclxuICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoID09PSAxMykge1xyXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbi5wdXNoKHt9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5yZW1vdmVDb2xsZWN0aW9uRWxlbWVudCA9IGZ1bmN0aW9uKGNvbGxlY3Rpb24sIGluZGV4KSB7XHJcbiAgICAgICAgICAgIGNvbGxlY3Rpb24uc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuYnV0dG9uQ3NzQ2xhc3MgPSBmdW5jdGlvbihuZ01vZGVsQ29udHJvbGxlcikge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgJ2J0bi1zdWNjZXNzJzogbmdNb2RlbENvbnRyb2xsZXIuJHZhbGlkLFxyXG4gICAgICAgICAgICAgICAgJ2J0bi1kYW5nZXInOiBuZ01vZGVsQ29udHJvbGxlci4kaW52YWxpZFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5nZXRSdW5uZXJQcm9ncmVzc0NzcyA9IGZ1bmN0aW9uKGluUHJvZ3Jlc3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICdwcm9ncmVzcyBwcm9ncmVzcy1zdHJpcGVkIGFjdGl2ZSc6IGluUHJvZ3Jlc3MsXHJcbiAgICAgICAgICAgICAgICAncHJvZ3Jlc3MnOiAhaW5Qcm9ncmVzc1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5nZXRTdG9yeVJ1bm5lclN0YXR1c1RleHQgPSBmdW5jdGlvbihpblByb2dyZXNzLCBzdWNjZXNzLCBwZW5kaW5nU3RlcHNMZW5ndGgpIHtcclxuICAgICAgICAgICAgaWYgKGluUHJvZ3Jlc3MpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnU3RvcnkgcnVuIGlzIGluIHByb2dyZXNzJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChzdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocGVuZGluZ1N0ZXBzTGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnU3RvcnkgcnVuIHdhcyBzdWNjZXNzZnVsIHdpdGggJyArIHBlbmRpbmdTdGVwc0xlbmd0aCArICcgcGVuZGluZyBzdGVwcyc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnU3RvcnkgcnVuIHdhcyBzdWNjZXNzZnVsJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnU3RvcnkgcnVuIGZhaWxlZCc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0UnVubmVyU3RhdHVzQ3NzID0gZnVuY3Rpb24oaW5Qcm9ncmVzcywgc3VjY2VzcywgcGVuZGluZ1N0ZXBzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAncHJvZ3Jlc3MtYmFyIHByb2dyZXNzLWJhci1pbmZvJzogaW5Qcm9ncmVzcyxcclxuICAgICAgICAgICAgICAgICdwcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyLXdhcm5pbmcnOiAhaW5Qcm9ncmVzcyAmJiBzdWNjZXNzICYmIHBlbmRpbmdTdGVwcyxcclxuICAgICAgICAgICAgICAgICdwcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyLXN1Y2Nlc3MnOiAhaW5Qcm9ncmVzcyAmJiBzdWNjZXNzICYmICFwZW5kaW5nU3RlcHMsXHJcbiAgICAgICAgICAgICAgICAncHJvZ3Jlc3MtYmFyIHByb2dyZXNzLWJhci1kYW5nZXInOiAhaW5Qcm9ncmVzcyAmJiAhc3VjY2Vzc1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5vcGVuUnVubmVyUGFyYW1ldGVyc01vZGFsID0gZnVuY3Rpb24oc2hvd0dldEFwaSkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHJldHVybiAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9ydW5uZXIvcnVubmVyUGFyYW1zLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAncnVubmVyUGFyYW1zQ3RybCcsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24oJHJvdXRlLCAkaHR0cCwgJG1vZGFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmdldEpzb24oJy9zdGVwcy9jbGFzc2VzLmpzb24nLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHNob3dHZXRBcGk6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2hvd0dldEFwaTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5vcGVuRGlyID0gZnVuY3Rpb24oJHNjb3BlLCBwYXRoKSB7XHJcbiAgICAgICAgICAgIGlmIChwYXRoID09PSAnLi4nKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGlycyA9ICRzY29wZS5yb290UGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnJvb3RQYXRoID0gZGlycy5zbGljZSgwLCBkaXJzLmxlbmd0aCAtIDIpLmpvaW4oJy8nKTtcclxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucm9vdFBhdGggIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJvb3RQYXRoICs9ICcvJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0U3Rvcmllcygkc2NvcGUsICcnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0U3Rvcmllcygkc2NvcGUsIHBhdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldFN0b3JpZXMgPSBmdW5jdGlvbiAoJHNjb3BlLCBwYXRoKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgaWYgKCRzY29wZS5yb290UGF0aCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucm9vdFBhdGggPSAnJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJy9zdG9yaWVzL2xpc3QuanNvbj9wYXRoPScgKyAkc2NvcGUucm9vdFBhdGggKyBwYXRoKS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsZXMgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhdGggIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJvb3RQYXRoICs9IHBhdGggKyAnLyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLm9wZW5FcnJvck1vZGFsKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc3RlcFRleHRQYXR0ZXJuID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoL14oR2l2ZW58V2hlbnxUaGVuKSAuKyQvKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMub3BlbkNvbmZpcm1hdGlvbk1vZGFsID0gZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvY29uZmlybWF0aW9uTW9kYWwudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtb2RhbEN0cmwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5jbGFzc05hbWVQYXR0ZXJuID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoL15bYS16QS1aXyRdW2EtekEtWlxcZF8kXSokLyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmNzc0NsYXNzID0gZnVuY3Rpb24obmdNb2RlbENvbnRyb2xsZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICdoYXMtZXJyb3InOiBuZ01vZGVsQ29udHJvbGxlci4kaW52YWxpZCxcclxuICAgICAgICAgICAgICAgICdoYXMtc3VjY2Vzcyc6IG5nTW9kZWxDb250cm9sbGVyLiR2YWxpZCAmJiBuZ01vZGVsQ29udHJvbGxlci4kZGlydHlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgIHRoaXMuZGVsZXRlU3RvcnkgPSBmdW5jdGlvbihwYXRoKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSB7c3RhdHVzOiAnRGVsZXRlIFN0b3J5JywgbWVzc2FnZTogJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyBzdG9yeT8nfTtcclxuICAgICAgICAgICAgdmFyIG9rTW9kYWwgPSB0aGlzLm9wZW5Db25maXJtYXRpb25Nb2RhbChtZXNzYWdlKTtcclxuICAgICAgICAgICAgb2tNb2RhbC5yZXN1bHQudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLmRlbGV0ZSgnL3N0b3JpZXMvc3RvcnkvJyArIHBhdGgpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9wYWdlL3N0b3JpZXMvbmV3LycpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoJ09LJyk7XHJcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCdOT0snKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdCgnTk9LJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0SnNvbiA9IGZ1bmN0aW9uKHVybCwgY2FjaGVUeXBlKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCh1cmwsIHtjYWNoZTogY2FjaGVUeXBlfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLm9wZW5FcnJvck1vZGFsKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMub3BlbkVycm9yTW9kYWwgPSBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2Fzc2V0cy9odG1sL2Vycm9yTW9kYWwudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtb2RhbEN0cmwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICB9KVxyXG4gICAgLmNvbnRyb2xsZXIoJ21vZGFsQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJG1vZGFsSW5zdGFuY2UsIGRhdGEpIHtcclxuICAgICAgICAkc2NvcGUuZGF0YSA9IGRhdGE7XHJcbiAgICAgICAgJHNjb3BlLm9rID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSgnb2snKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xyXG4gICAgICAgIH07XHJcbiAgICB9KVxyXG4gICAgLmNvbnRyb2xsZXIoJ3N0b3JpZXNDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJG1vZGFsLCAkbW9kYWxJbnN0YW5jZSwgJGxvY2F0aW9uLCAkcSwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgVGNCZGRTZXJ2aWNlLmdldFN0b3JpZXMoJHNjb3BlLCAnJyk7XHJcbiAgICAgICAgJHNjb3BlLm9wZW5EaXIgPSBmdW5jdGlvbihwYXRoKSB7XHJcbiAgICAgICAgICAgIFRjQmRkU2VydmljZS5vcGVuRGlyKCRzY29wZSwgcGF0aCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS52aWV3U3RvcnlVcmwgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnL3BhZ2Uvc3Rvcmllcy92aWV3LycgKyAkc2NvcGUucm9vdFBhdGggKyBuYW1lO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmFsbG93VG9QcmV2RGlyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUucm9vdFBhdGggIT09ICcnO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLmRlbGV0ZVN0b3J5ID0gZnVuY3Rpb24obmFtZSwgaW5kZXgpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSAkc2NvcGUucm9vdFBhdGggKyBuYW1lICsgJy5zdG9yeSc7XHJcbiAgICAgICAgICAgIFRjQmRkU2VydmljZS5kZWxldGVTdG9yeShwYXRoKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZpbGVzLnN0b3JpZXMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUuY3JlYXRlRGlyZWN0b3J5ID0gZnVuY3Rpb24ocGF0aCkge1xyXG4gICAgICAgICAgICB2YXIganNvbiA9ICd7XCJwYXRoXCI6IFwiJyArICRzY29wZS5yb290UGF0aCArIHBhdGggKyAnXCJ9JztcclxuICAgICAgICAgICAgJGh0dHAucG9zdCgnL3N0b3JpZXMvZGlyLmpzb24nLCBqc29uKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZpbGVzLmRpcnMucHVzaCh7bmFtZTogcGF0aH0pO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5FcnJvck1vZGFsKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdjb25maWdNb2R1bGUnLCBbXSlcclxuICAgIC5jb25maWcoZnVuY3Rpb24oJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XHJcbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xyXG4gICAgICAgICRyb3V0ZVByb3ZpZGVyXHJcbiAgICAgICAgICAgIC8vIFRPRE8gUmVtb3ZlIGR1cGxpY2F0aW9uIGluIHJlc29sdmVcclxuICAgICAgICAgICAgLndoZW4oJy9wYWdlL3N0b3JpZXMvbmV3LycsIHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2Fzc2V0cy9odG1sL3N0b3J5L3N0b3J5LnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc3RvcnlDdHJsJyxcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0b3J5OiBmdW5jdGlvbigkaHR0cCwgJG1vZGFsLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRKc29uKCcvc3Rvcmllcy9zdG9yeS5qc29uJywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3RlcHM6IGZ1bmN0aW9uKCRodHRwLCAkbW9kYWwsIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldEpzb24oJy9zdGVwcy9saXN0Lmpzb24nLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGdyb292eUNvbXBvc2l0ZXM6IGZ1bmN0aW9uKCRodHRwLCAkbW9kYWwsIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldEpzb24oJy9ncm9vdnlDb21wb3NpdGVzJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAud2hlbignL3BhZ2Uvc3Rvcmllcy9uZXcvOnBhdGgqJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvc3Rvcnkvc3RvcnkudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzdG9yeUN0cmwnLFxyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3Rvcnk6IGZ1bmN0aW9uKCRyb3V0ZSwgJGh0dHAsICRtb2RhbCwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0SnNvbignL3N0b3JpZXMvc3RvcnkuanNvbj9wYXRoPScgKyAkcm91dGUuY3VycmVudC5wYXJhbXMucGF0aCArICcuc3RvcnknLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBzdGVwczogZnVuY3Rpb24oJGh0dHAsICRtb2RhbCwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0SnNvbignL3N0ZXBzL2xpc3QuanNvbicsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZ3Jvb3Z5Q29tcG9zaXRlczogZnVuY3Rpb24oJGh0dHAsICRtb2RhbCwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0SnNvbignL2dyb292eUNvbXBvc2l0ZXMnLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC53aGVuKCcvcGFnZS9zdG9yaWVzL3ZpZXcvOnBhdGgqJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvc3Rvcnkvc3RvcnkudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzdG9yeUN0cmwnLFxyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3Rvcnk6IGZ1bmN0aW9uKCRyb3V0ZSwgJGh0dHAsICRtb2RhbCwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0SnNvbignL3N0b3JpZXMvc3RvcnkuanNvbj9wYXRoPScgKyAkcm91dGUuY3VycmVudC5wYXJhbXMucGF0aCArICcuc3RvcnknLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBzdGVwczogZnVuY3Rpb24oJGh0dHAsICRtb2RhbCwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0SnNvbignL3N0ZXBzL2xpc3QuanNvbicsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgZ3Jvb3Z5Q29tcG9zaXRlczogZnVuY3Rpb24oJGh0dHAsICRtb2RhbCwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0SnNvbignL2dyb292eUNvbXBvc2l0ZXMnLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVsb2FkT25TZWFyY2g6IGZhbHNlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgLndoZW4oJy9wYWdlL2NvbXBvc2l0ZXMvOmNsYXNzTmFtZSonLCB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9jb21wb3NpdGVzL2NvbXBvc2l0ZXMudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjb21wb3NpdGVzQ3RybCcsXHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBjb21wb3NpdGVzQ2xhc3M6IGZ1bmN0aW9uKCRyb3V0ZSwgJGh0dHApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGVOYW1lID0gJHJvdXRlLmN1cnJlbnQucGFyYW1zLmNsYXNzTmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9ICcvZ3Jvb3Z5Q29tcG9zaXRlcy8nICsgZmlsZU5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQodXJsLCB7Y2FjaGU6IGZhbHNlfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IGZpbGVOYW1lLnN1YnN0cmluZygwLCBmaWxlTmFtZS5sYXN0SW5kZXhPZignLicpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IGNsYXNzTmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb3NpdGVzOlt7c3RlcFRleHQ6ICcnLCBjb21wb3NpdGVTdGVwczogW3t9XX1dLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzTmV3OiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHN0ZXBzOiBmdW5jdGlvbigkaHR0cCwgJG1vZGFsLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRKc29uKCcvc3RlcHMvbGlzdC5qc29uJywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLndoZW4oJy9wYWdlL3J1bm5lci8nLCB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9ydW5uZXIvcnVubmVyLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAncnVubmVyQ3RybCcsXHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbigkcm91dGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtyZXBvcnRzUGF0aDogJHJvdXRlLmN1cnJlbnQucGFyYW1zLnBhdGh9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgICAgIC5vdGhlcndpc2Uoe1xyXG4gICAgICAgICAgICAgICAgcmVkaXJlY3RUbzogJy9wYWdlL3N0b3JpZXMvbmV3J1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYm9keU1vZHVsZScsIFtdKVxyXG4gICAgLmNvbnRyb2xsZXIoJ2JvZHlDdHJsJywgZnVuY3Rpb24gKCRzY29wZSkge1xyXG4gICAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdjb21wb3NpdGVDbGFzc2VzTW9kdWxlJywgW10pXHJcbiAgICAuY29udHJvbGxlcignY29tcG9zaXRlQ2xhc3Nlc0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbW9kYWxJbnN0YW5jZSwgY29tcG9zaXRlQ2xhc3NlcywgY29tcG9zaXRlU3RlcFRleHQsIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgICRzY29wZS5jb21wb3NpdGVDbGFzc2VzID0gY29tcG9zaXRlQ2xhc3NlcztcclxuICAgICAgICAkc2NvcGUuY29tcG9zaXRlU3RlcFRleHQgPSBjb21wb3NpdGVTdGVwVGV4dDtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2UoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jb21wb3NpdGVDbGFzc1VybCA9IGZ1bmN0aW9uKHBhY2thZ2VOYW1lLCBjbGFzc05hbWUpIHtcclxuICAgICAgICAgICAgdmFyIHVybCA9ICcvcGFnZS9jb21wb3NpdGVzLyc7XHJcbiAgICAgICAgICAgIGlmIChwYWNrYWdlTmFtZSAhPT0gdW5kZWZpbmVkICYmIHBhY2thZ2VOYW1lICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgdXJsICs9IHBhY2thZ2VOYW1lICsgJy4nO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBjbGFzc05hbWVQYXJ0cztcclxuICAgICAgICAgICAgaWYgKGNsYXNzTmFtZS5pbmRleE9mKCcvJykgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lUGFydHMgPSBjbGFzc05hbWUuc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZVBhcnRzID0gY2xhc3NOYW1lLnNwbGl0KCdcXFxcJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdXJsICs9IGNsYXNzTmFtZVBhcnRzW2NsYXNzTmFtZVBhcnRzLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmNvbXBvc2l0ZVN0ZXBUZXh0ICE9PSB1bmRlZmluZWQgJiYgJHNjb3BlLmNvbXBvc2l0ZVN0ZXBUZXh0ICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgdXJsICs9ICc/c3RlcFRleHQ9JyArICRzY29wZS5jb21wb3NpdGVTdGVwVGV4dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZUNsYXNzVGV4dCA9IGZ1bmN0aW9uKGNsYXNzTmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgY2xhc3NOYW1lUGFydHM7XHJcbiAgICAgICAgICAgIGlmIChjbGFzc05hbWUuaW5kZXhPZignLycpID49IDApIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZVBhcnRzID0gY2xhc3NOYW1lLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWVQYXJ0cyA9IGNsYXNzTmFtZS5zcGxpdCgnXFxcXCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciB0ZXh0ID0gY2xhc3NOYW1lUGFydHNbY2xhc3NOYW1lUGFydHMubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIGlmICh0ZXh0LmluZGV4T2YoJy4nKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5zdWJzdHIoMCwgdGV4dC5sYXN0SW5kZXhPZignLicpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGV4dDtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jbGFzc05hbWVQYXR0ZXJuID0gVGNCZGRTZXJ2aWNlLmNsYXNzTmFtZVBhdHRlcm47XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLmNzc0NsYXNzID0gVGNCZGRTZXJ2aWNlLmNzc0NsYXNzO1xyXG4gICAgICAgICRzY29wZS5kYXRhID0ge2NsYXNzOiAnJ307XHJcbiAgICB9KTsiLCJhbmd1bGFyLm1vZHVsZSgnY29tcG9zaXRlc01vZHVsZScsIFtdKVxyXG4gICAgLmNvbnRyb2xsZXIoJ2NvbXBvc2l0ZXNDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJG1vZGFsLCAkbG9jYXRpb24sICRjb29raWVTdG9yZSwgY29tcG9zaXRlc0NsYXNzLCBzdGVwcywgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHNjb3BlLmFkZE5ld0NvbXBvc2l0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuY29tcG9zaXRlID0ge3N0ZXBUZXh0OiAnJywgY29tcG9zaXRlU3RlcHM6IFt7fV19O1xyXG4gICAgICAgICAgICAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNvbXBvc2l0ZXMucHVzaCgkc2NvcGUuY29tcG9zaXRlKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5hZGRTdGVwVGV4dFBhcmFtID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICgkbG9jYXRpb24uc2VhcmNoKCkuc3RlcFRleHQgIT09IHVuZGVmaW5lZCAmJiAkbG9jYXRpb24uc2VhcmNoKCkuc3RlcFRleHQgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNvbXBvc2l0ZXMucHVzaCh7c3RlcFRleHQ6ICRsb2NhdGlvbi5zZWFyY2goKS5zdGVwVGV4dCwgY29tcG9zaXRlU3RlcHM6IFtdfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5hZGROZXdDb21wb3NpdGVTdGVwID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGUuY29tcG9zaXRlU3RlcHMucHVzaCh7fSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuc2V0TGFzdENvbXBvc2l0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoID0gJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5jb21wb3NpdGVzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGUgPSAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNvbXBvc2l0ZXNbbGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29tcG9zaXRlID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jb21wb3NpdGVzQ2xhc3MgPSBjb21wb3NpdGVzQ2xhc3M7XHJcbiAgICAgICAgJHNjb3BlLmFkZFN0ZXBUZXh0UGFyYW0oKTtcclxuICAgICAgICAkc2NvcGUub3JpZ2luYWxDb21wb3NpdGVzQ2xhc3MgPSBhbmd1bGFyLmNvcHkoY29tcG9zaXRlc0NsYXNzKTtcclxuICAgICAgICAkc2NvcGUuc2V0TGFzdENvbXBvc2l0ZSgpO1xyXG4gICAgICAgICRzY29wZS5zdGVwcyA9IHN0ZXBzO1xyXG4gICAgICAgICRzY29wZS5jbGFzc05hbWVQYXR0ZXJuID0gVGNCZGRTZXJ2aWNlLmNsYXNzTmFtZVBhdHRlcm47XHJcbiAgICAgICAgJHNjb3BlLnN0ZXBUZXh0UGF0dGVybiA9IFRjQmRkU2VydmljZS5zdGVwVGV4dFBhdHRlcm47XHJcbiAgICAgICAgJHNjb3BlLmNzc0NsYXNzID0gVGNCZGRTZXJ2aWNlLmNzc0NsYXNzO1xyXG5cclxuICAgICAgICAkc2NvcGUuYnV0dG9uQ3NzQ2xhc3MgPSBmdW5jdGlvbihjb21wb3NpdGVDbGFzc0Zvcm0sIGNvbXBvc2l0ZUZvcm0pIHtcclxuICAgICAgICAgICAgaWYgKCFjb21wb3NpdGVDbGFzc0Zvcm0uJHZhbGlkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmJ1dHRvbkNzc0NsYXNzKGNvbXBvc2l0ZUNsYXNzRm9ybSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmJ1dHRvbkNzc0NsYXNzKGNvbXBvc2l0ZUZvcm0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUub3BlbkNvbXBvc2l0ZSA9IGZ1bmN0aW9uKGNvbXBvc2l0ZSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuY29tcG9zaXRlID0gY29tcG9zaXRlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLm5ld0NvbGxlY3Rpb25JdGVtID0gVGNCZGRTZXJ2aWNlLm5ld0NvbGxlY3Rpb25JdGVtO1xyXG4gICAgICAgICRzY29wZS5yZW1vdmVDb2xsZWN0aW9uRWxlbWVudCA9IFRjQmRkU2VydmljZS5yZW1vdmVDb2xsZWN0aW9uRWxlbWVudDtcclxuICAgICAgICAkc2NvcGUucmV2ZXJ0Q29tcG9zaXRlc0NsYXNzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGVzQ2xhc3MgPSBhbmd1bGFyLmNvcHkoJHNjb3BlLm9yaWdpbmFsQ29tcG9zaXRlc0NsYXNzKTtcclxuICAgICAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZSA9ICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuY29tcG9zaXRlc1swXTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jYW5SZXZlcnRDb21wb3NpdGVzQ2xhc3MgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICFhbmd1bGFyLmVxdWFscygkc2NvcGUuY29tcG9zaXRlc0NsYXNzLCAkc2NvcGUub3JpZ2luYWxDb21wb3NpdGVzQ2xhc3MpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhblNhdmVDb21wb3NpdGVzQ2xhc3MgPSBmdW5jdGlvbihuZ01vZGVsQ29udHJvbGxlcikge1xyXG4gICAgICAgICAgICB2YXIgaXNWYWxpZCA9IG5nTW9kZWxDb250cm9sbGVyLiR2YWxpZDtcclxuICAgICAgICAgICAgdmFyIGlzVXBkYXRlZCA9ICFhbmd1bGFyLmVxdWFscygkc2NvcGUuY29tcG9zaXRlc0NsYXNzLCAkc2NvcGUub3JpZ2luYWxDb21wb3NpdGVzQ2xhc3MpO1xyXG4gICAgICAgICAgICB2YXIgaXNOZXcgPSAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmlzTmV3O1xyXG4gICAgICAgICAgICByZXR1cm4gKGlzTmV3IHx8IGlzVXBkYXRlZCkgJiYgaXNWYWxpZDtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jb21wb3NpdGVzQXJlVmFsaWQgPSBmdW5jdGlvbihuZ01vZGVsQ29udHJvbGxlcikge1xyXG4gICAgICAgICAgICB2YXIgaXNWYWxpZCA9IG5nTW9kZWxDb250cm9sbGVyLiR2YWxpZDtcclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRzY29wZS5jb21wb3NpdGVzQ2xhc3MuY29tcG9zaXRlcywgZnVuY3Rpb24oZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuc3RlcFRleHQgPT09IHVuZGVmaW5lZCB8fCBlbGVtZW50LnN0ZXBUZXh0ID09PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzVmFsaWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5jb21wb3NpdGVTdGVwcyA9PT0gdW5kZWZpbmVkIHx8IGVsZW1lbnQuY29tcG9zaXRlU3RlcHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNWYWxpZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGlzVmFsaWQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuc2F2ZUNvbXBvc2l0ZXNDbGFzcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkaHR0cC5wdXQoJy9ncm9vdnlDb21wb3NpdGVzJywgJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcykudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kZWxldGVDb21wb3NpdGVzQ2xhc3NXaXRob3V0Q29uZmlybWF0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3BhZ2UvY29tcG9zaXRlcy8nICsgJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5jbGFzcyArICcuZ3Jvb3Z5Jyk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmlzTmV3ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUub3JpZ2luYWxDb21wb3NpdGVzQ2xhc3MgPSBhbmd1bGFyLmNvcHkoJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcyk7XHJcbiAgICAgICAgICAgICAgICAkY29va2llU3RvcmUucHV0KCdjb21wb3NpdGVDbGFzcycsICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuY2xhc3MpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5FcnJvck1vZGFsKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jYW5EZWxldGVDb21wb3NpdGVzQ2xhc3MgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICghJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5pc05ldyk7XHJcblxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLmRlbGV0ZUNvbXBvc2l0ZXNDbGFzc1dpdGhvdXRDb25maXJtYXRpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGNsYXNzTmFtZSA9ICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuY2xhc3M7XHJcbiAgICAgICAgICAgIHZhciBvcmlnaW5hbENsYXNzTmFtZSA9ICRzY29wZS5vcmlnaW5hbENvbXBvc2l0ZXNDbGFzcy5jbGFzcztcclxuICAgICAgICAgICAgaWYgKGNsYXNzTmFtZSAhPT0gb3JpZ2luYWxDbGFzc05hbWUpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLmRlbGV0ZSgnL2dyb292eUNvbXBvc2l0ZXMvJyArIG9yaWdpbmFsQ2xhc3NOYW1lKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIFRjQmRkU2VydmljZS5vcGVuRXJyb3JNb2RhbChyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUuZGVsZXRlQ29tcG9zaXRlc0NsYXNzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0ge3N0YXR1czogJ0RlbGV0ZSBDb21wb3NpdGVzIENsYXNzJywgbWVzc2FnZTogJ0FyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUgdGhpcyBjb21wb3NpdGVzIGNsYXNzPyd9O1xyXG4gICAgICAgICAgICB2YXIgb2tNb2RhbCA9IFRjQmRkU2VydmljZS5vcGVuQ29uZmlybWF0aW9uTW9kYWwobWVzc2FnZSk7XHJcbiAgICAgICAgICAgIG9rTW9kYWwucmVzdWx0LnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5kZWxldGUoJy9ncm9vdnlDb21wb3NpdGVzLycgKyAkc2NvcGUub3JpZ2luYWxDb21wb3NpdGVzQ2xhc3MuY2xhc3MpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcclxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5FcnJvck1vZGFsKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gRG8gbm90aGluZ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zYXZlQ29tcG9zaXRlc1RleHQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCRzY29wZS5jb21wb3NpdGVzQ2xhc3MuaXNOZXcpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnQ3JlYXRlIE5ldyBDb21wb3NpdGVzJztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnVXBkYXRlIENvbXBvc2l0ZXMnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pOyIsImFuZ3VsYXIubW9kdWxlKCdydW5uZXJNb2R1bGUnLCBbXSlcclxuICAgIC5jb250cm9sbGVyKCdydW5uZXJDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkbW9kYWwsICRodHRwLCAkbG9jYXRpb24sIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdCBtb3JlIHRoYW4gY2hlY2tpbmcgd2hldGhlciAkbW9kYWwub3BlbiB3YXMgY2FsbGVkXHJcbiAgICAgICAgJHNjb3BlLm9wZW5SdW5uZXJTZWxlY3RvciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvcnVubmVyL3J1bm5lclNlbGVjdG9yLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAncnVubmVyU2VsZWN0b3JDdHJsJyxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUub3BlblJ1bm5lciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcnVubmVyU2VsZWN0b3IgPSAkc2NvcGUub3BlblJ1bm5lclNlbGVjdG9yKCk7XHJcbiAgICAgICAgICAgIGlmIChydW5uZXJTZWxlY3RvciAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICBydW5uZXJTZWxlY3Rvci5yZXN1bHQudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdG9yeVBhdGhzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5kaXJzLmZvckVhY2goZnVuY3Rpb24gKGRpcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9yeVBhdGhzLnB1c2goe3BhdGg6IGRpci5wYXRoICsgXCIvKiovKi5zdG9yeVwifSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5zdG9yaWVzLmZvckVhY2goZnVuY3Rpb24gKHN0b3J5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3J5UGF0aHMucHVzaCh7cGF0aDogc3RvcnkucGF0aH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIFRjQmRkU2VydmljZS5vcGVuUnVubmVyUGFyYW1ldGVyc01vZGFsKHRydWUpLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbGFzc2VzID0gZGF0YS5jbGFzc2VzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gZGF0YS5hY3Rpb247XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRodHRwLmdldCgnL2dyb292eUNvbXBvc2l0ZXMnKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdyb292eUNvbXBvc2l0ZXMgPSByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFwaUpzb24gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcnlQYXRoczogc3RvcnlQYXRocyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc2VzOiBjbGFzc2VzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyb292eUNvbXBvc2l0ZXM6IGdyb292eUNvbXBvc2l0ZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aW9uID09PSAncnVuJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5ydW4oJHNjb3BlLmFwaUpzb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93QXBpID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93QXBpID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnJ1biA9IGZ1bmN0aW9uKGpzb24pIHtcclxuICAgICAgICAgICAgdmFyIHJlcG9ydHNQcmVmaXggPSAnL2FwaS92MS9yZXBvcnRlcnMvZ2V0Lyc7XHJcbiAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MgPSB0cnVlO1xyXG4gICAgICAgICAgICAkc2NvcGUuc2hvd1J1bm5lclByb2dyZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHNVcmwgPSAnJztcclxuICAgICAgICAgICAgJGh0dHAucG9zdCgnL3J1bm5lci9ydW4uanNvbicsIGpzb24pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09ICdPSycpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVwb3J0c1VybCA9IHJlcG9ydHNQcmVmaXggKyBkYXRhLnJlcG9ydHNQYXRoO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJTdWNjZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YS5zdGF0dXMgPT09ICdGQUlMRUQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHNVcmwgPSByZXBvcnRzUHJlZml4ICsgZGF0YS5yZXBvcnRzUGF0aDtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5FcnJvck1vZGFsKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyA9IHRydWU7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5FcnJvck1vZGFsKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRSdW5uZXJTdGF0dXNDc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0UnVubmVyU3RhdHVzQ3NzKFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyxcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclN1Y2Nlc3MsXHJcbiAgICAgICAgICAgICAgICAoJHNjb3BlLnBlbmRpbmdTdGVwcyA+IDApXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0U3RvcnlSdW5uZXJTdGF0dXNUZXh0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdTdG9yaWVzIHJ1biBpcyBpbiBwcm9ncmVzcyc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1N0b3JpZXMgcnVuIGlzIGZpbmlzaGVkJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmdldFJ1bm5lclByb2dyZXNzQ3NzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldFJ1bm5lclByb2dyZXNzQ3NzKCRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJTdWNjZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRzY29wZS5zaG93UnVubmVyUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgJHNjb3BlLnBlbmRpbmdTdGVwcyA9IFtdO1xyXG4gICAgICAgICAgICAkc2NvcGUucmVwb3J0c1VybCA9ICcnO1xyXG4gICAgICAgICAgICAkc2NvcGUub3BlblJ1bm5lcigpO1xyXG4gICAgICAgICAgICAkc2NvcGUuc2hvd0FwaSA9IGZhbHNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmFwaVVybCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGxvY2F0aW9uLnByb3RvY29sKCkgKyAnOi8vJyArICRsb2NhdGlvbi5ob3N0KCkgKyAnOicgKyAkbG9jYXRpb24ucG9ydCgpICsgJy9ydW5uZXIvcnVuLmpzb24nO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmluaXQoKTtcclxuICAgIH0pXHJcbiAgICAuY29udHJvbGxlcigncnVubmVyU2VsZWN0b3JDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJG1vZGFsLCAkbW9kYWxJbnN0YW5jZSwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHNjb3BlLmZpbGVzID0ge2RpcnM6IFtdLCBzdG9yaWVzOiBbXX07XHJcbiAgICAgICAgVGNCZGRTZXJ2aWNlLmdldFN0b3JpZXMoJHNjb3BlLCAnJyk7XHJcbiAgICAgICAgJHNjb3BlLm9wZW5EaXIgPSBmdW5jdGlvbihwYXRoKSB7XHJcbiAgICAgICAgICAgIFRjQmRkU2VydmljZS5vcGVuRGlyKCRzY29wZSwgcGF0aCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuY2VsUnVubmVyU2VsZWN0b3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLm9rUnVubmVyU2VsZWN0b3IgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkRmlsZXMgPSB7ZGlyczogW10sIHN0b3JpZXM6IFtdfTtcclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRzY29wZS5maWxlcy5kaXJzLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLnNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRGaWxlcy5kaXJzLnB1c2goe3BhdGg6ICRzY29wZS5yb290UGF0aCArIHZhbHVlLm5hbWV9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuZmlsZXMuc3RvcmllcywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5zZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkRmlsZXMuc3Rvcmllcy5wdXNoKHtwYXRoOiAkc2NvcGUucm9vdFBhdGggKyB2YWx1ZS5uYW1lICsgXCIuc3RvcnlcIn0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2Uoc2VsZWN0ZWRGaWxlcyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuYWxsb3dUb1ByZXZEaXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5yb290UGF0aCAhPT0gJyc7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuQ29udGludWUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGhhc1NlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuZmlsZXMuZGlycywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5zZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc1NlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICghaGFzU2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuZmlsZXMuc3RvcmllcywgZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLnNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc1NlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaGFzU2VsZWN0ZWQ7XHJcbiAgICAgICAgfTtcclxuICAgIH0pXHJcbiAgICAuY29udHJvbGxlcigncnVubmVyUGFyYW1zQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbEluc3RhbmNlLCAkY29va2llU3RvcmUsIGRhdGEsIHNob3dHZXRBcGkpIHtcclxuICAgICAgICAkc2NvcGUuY2xhc3NlcyA9IGRhdGEuY2xhc3NlcztcclxuICAgICAgICAkc2NvcGUucGFyYW1BcnJheSA9IFtdO1xyXG4gICAgICAgICRzY29wZS5zZXRQYXJhbXMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmNsYXNzZXMuZm9yRWFjaChmdW5jdGlvbihjbGFzc0VudHJ5KSB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc0VudHJ5LnBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtRW50cnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1FbnRyeS52YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHBhcmFtRW50cnkudmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtRW50cnkuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtRW50cnkuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtRW50cnkudmFsdWUgPSAkY29va2llU3RvcmUuZ2V0KGNsYXNzRW50cnkuZnVsbE5hbWUgKyBcIi5cIiArIHBhcmFtRW50cnkua2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDb3VsZCBub3QgcmV0cmlldmUgY29va2llICcgKyBjbGFzc0VudHJ5LmZ1bGxOYW1lICsgXCIuXCIgKyBwYXJhbUVudHJ5LmtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHRcdCRzY29wZS5oYXNPcHRpb25zID0gZnVuY3Rpb24ob3B0aW9ucykge1xyXG5cdFx0XHRpZiAob3B0aW9ucykge1xyXG5cdFx0XHQgIHJldHVybiBvcHRpb25zLmxlbmd0aCA+IDA7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdCAgcmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG4gICAgICAgICRzY29wZS5oYXNQYXJhbXMgPSBmdW5jdGlvbihjbGFzc0VudHJ5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjbGFzc0VudHJ5LnBhcmFtcyAhPT0gdW5kZWZpbmVkICYmIGNsYXNzRW50cnkucGFyYW1zLmxlbmd0aCA+IDA7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUub2sgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2Uoe2FjdGlvbjogJ3J1bicsIGNsYXNzZXM6ICRzY29wZS5jbGFzc2VzfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnNob3dHZXRBcGkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNob3dHZXRBcGk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0QXBpID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKHthY3Rpb246ICdhcGknLCBjbGFzc2VzOiAkc2NvcGUuY2xhc3Nlc30pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnBhcmFtRWxlbWVudElkID0gZnVuY3Rpb24oY2xhc3NOYW1lLCBwYXJhbUtleSkge1xyXG4gICAgICAgICAgICB2YXIgZm9ybWF0dGVkQ2xhc3NOYW1lID0gY2xhc3NOYW1lLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpICsgY2xhc3NOYW1lLnNsaWNlKDEpO1xyXG4gICAgICAgICAgICB2YXIgZm9ybWF0dGVkUGFyYW1LZXkgPSBwYXJhbUtleS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHBhcmFtS2V5LnNsaWNlKDEpO1xyXG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0dGVkQ2xhc3NOYW1lICsgZm9ybWF0dGVkUGFyYW1LZXk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuc2V0UGFyYW1zKCk7XHJcbiAgICB9KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ3RvcE1lbnVNb2R1bGUnLCBbXSlcclxuICAgIC5jb250cm9sbGVyKCd0b3BNZW51Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJG1vZGFsLCAkbG9jYXRpb24sIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdCBtb3JlIHRoYW4gY2hlY2tpbmcgd2hldGhlciAkbW9kYWwub3BlbiB3YXMgY2FsbGVkXHJcbiAgICAgICAgJHNjb3BlLm9wZW5TdG9yeSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9zdG9yaWVzLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc3Rvcmllc0N0cmwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge307XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5vcGVuQ29tcG9zaXRlQ2xhc3MgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5Db21wb3NpdGVDbGFzcygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmdldFRpdGxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gJGxvY2F0aW9uLnBhdGgoKTtcclxuICAgICAgICAgICAgaWYgKHBhdGguaW5kZXhPZignL3BhZ2Uvc3Rvcmllcy92aWV3LycpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1ZpZXcgU3RvcnknO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdGguaW5kZXhPZignL3BhZ2Uvc3Rvcmllcy9uZXcvJykgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnTmV3IFN0b3J5JztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXRoLmluZGV4T2YoJy9wYWdlL2NvbXBvc2l0ZXMvJykgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnQ29tcG9zaXRlcyc7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGF0aC5pbmRleE9mKCcvcGFnZS9yZXBvcnRzLycpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1JlcG9ydHMnO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnc3RvcnlNb2R1bGUnLCBbXSlcclxuICAgIC5jb250cm9sbGVyKCdzdG9yeUN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbW9kYWwsICRsb2NhdGlvbiwgJGNvb2tpZVN0b3JlLCAkcSwgJGFuY2hvclNjcm9sbCwgc3RvcnksIHN0ZXBzLCBncm9vdnlDb21wb3NpdGVzLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAkc2NvcGUucGVuZGluZ1N0ZXBzID0gW107XHJcbiAgICAgICAgJHNjb3BlLnNldEFjdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLnN0b3J5Lm5hbWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aW9uID0gJ1BVVCc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aW9uID0gJ1BPU1QnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZXhwYW5kUGFuZWxzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBzY2VuYXJpb3NFeHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUucGFuZWxzRXhwYW5kZWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhbmVsc0V4cGFuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFuZWxzRXhwYW5kZWQgPSAhJHNjb3BlLnBhbmVsc0V4cGFuZGVkO1xyXG4gICAgICAgICAgICAgICAgc2NlbmFyaW9zRXhwYW5kZWQgPSAkc2NvcGUucGFuZWxzRXhwYW5kZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHNjb3BlLnBhbmVscyA9IHtcclxuICAgICAgICAgICAgICAgIHN0b3J5OiAkc2NvcGUucGFuZWxzRXhwYW5kZWQsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJHNjb3BlLnBhbmVsc0V4cGFuZGVkLFxyXG4gICAgICAgICAgICAgICAgbWV0YTogJHNjb3BlLnBhbmVsc0V4cGFuZGVkLFxyXG4gICAgICAgICAgICAgICAgbmFycmF0aXZlOiAkc2NvcGUucGFuZWxzRXhwYW5kZWQsXHJcbiAgICAgICAgICAgICAgICBnaXZlblN0b3JpZXM6ICRzY29wZS5wYW5lbHNFeHBhbmRlZCxcclxuICAgICAgICAgICAgICAgIGxpZmVjeWNsZTogJHNjb3BlLnBhbmVsc0V4cGFuZGVkLFxyXG4gICAgICAgICAgICAgICAgc2NlbmFyaW9zOiBzY2VuYXJpb3NFeHBhbmRlZFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5zdG9yeSA9IHN0b3J5O1xyXG4gICAgICAgICRzY29wZS5zdGVwcyA9IHN0ZXBzO1xyXG4gICAgICAgICRzY29wZS5ncm9vdnlDb21wb3NpdGVzID0gZ3Jvb3Z5Q29tcG9zaXRlcztcclxuICAgICAgICAkc2NvcGUuc3RlcFR5cGVzID0gWydHSVZFTicsICdXSEVOJywgJ1RIRU4nXTtcclxuICAgICAgICAkc2NvcGUuc3RvcnlGb3JtQ2xhc3MgPSAnY29sLW1kLTEwIGNvbC1tZC1vZmZzZXQtMSBjb2wtbGctOCBjb2wtbGctb2Zmc2V0LTInO1xyXG4gICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyA9IHRydWU7XHJcbiAgICAgICAgJHNjb3BlLmV4cGFuZFBhbmVscygpO1xyXG4gICAgICAgICRzY29wZS5wYW5lbHMuc3RvcnkgPSB0cnVlOyAvLyBleHBhbmQgc3RvcnkgYnkgZGVmYXVsdFxyXG4gICAgICAgICRzY29wZS5hY3RpdmF0ZVJ1bm5lclRhYiA9IHtcclxuICAgICAgICAgICAgdmFsdWU6IGZhbHNlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLm9yaWdpbmFsU3RvcnkgPSBhbmd1bGFyLmNvcHkoc3RvcnkpO1xyXG4gICAgICAgIHZhciBwYXRoQXJyYXkgPSAkc2NvcGUuc3RvcnkucGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgICRzY29wZS5kaXJQYXRoID0gcGF0aEFycmF5LnNsaWNlKDAsIHBhdGhBcnJheS5sZW5ndGggLSAxKS5qb2luKCcvJyk7XHJcbiAgICAgICAgaWYgKCRzY29wZS5kaXJQYXRoICE9PSAnJykge1xyXG4gICAgICAgICAgICAkc2NvcGUuZGlyUGF0aCArPSAnLyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICRzY29wZS5zZXRBY3Rpb24oKTtcclxuICAgICAgICAkc2NvcGUuY3NzQ2xhc3MgPSBUY0JkZFNlcnZpY2UuY3NzQ2xhc3M7XHJcbiAgICAgICAgJHNjb3BlLmJ1dHRvbkNzc0NsYXNzID0gVGNCZGRTZXJ2aWNlLmJ1dHRvbkNzc0NsYXNzO1xyXG4gICAgICAgICRzY29wZS5jYW5TYXZlU3RvcnkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGlzVmFsaWQgPSAkc2NvcGUuc3RvcnlGb3JtLiR2YWxpZDtcclxuICAgICAgICAgICAgdmFyIGhhc0NoYW5nZWQgPSAhYW5ndWxhci5lcXVhbHMoJHNjb3BlLnN0b3J5LCAkc2NvcGUub3JpZ2luYWxTdG9yeSk7XHJcbiAgICAgICAgICAgIHJldHVybiBpc1ZhbGlkICYmIGhhc0NoYW5nZWQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuc3RlcFRleHRQYXR0ZXJuID0gVGNCZGRTZXJ2aWNlLnN0ZXBUZXh0UGF0dGVybjtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUuc2F2ZVN0b3J5ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY2FuU2F2ZVN0b3J5KCkpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeS5wYXRoID0gJHNjb3BlLmRpclBhdGggKyAkc2NvcGUuc3RvcnkubmFtZSArIFwiLnN0b3J5XCI7XHJcbiAgICAgICAgICAgICAgICBpZiAoJ1BPU1QnID09PSAkc2NvcGUuYWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmlwcGVkUGF0aEFycmF5ID0gJHNjb3BlLmRpclBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RyaXBwZWRQYXRoID0gc3RyaXBwZWRQYXRoQXJyYXkuc2xpY2UoMCwgc3RyaXBwZWRQYXRoQXJyYXkubGVuZ3RoIC0gMSkuam9pbignLycpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdHJpcHBlZFBhdGggIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmlwcGVkUGF0aCArPSAnLyc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICRodHRwLnBvc3QoJy9zdG9yaWVzL3N0b3J5Lmpzb24nLCAkc2NvcGUuc3RvcnkpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3BhZ2Uvc3Rvcmllcy92aWV3LycgKyBzdHJpcHBlZFBhdGggKyAkc2NvcGUuc3RvcnkubmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5vcmlnaW5hbFN0b3J5ID0gYW5ndWxhci5jb3B5KCRzY29wZS5zdG9yeSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5vcGVuRXJyb3JNb2RhbChyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5zdG9yeS5uYW1lICE9PSAkc2NvcGUub3JpZ2luYWxTdG9yeS5uYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeS5vcmlnaW5hbFBhdGggPSAkc2NvcGUub3JpZ2luYWxTdG9yeS5wYXRoO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAkaHR0cC5wdXQoJy9zdG9yaWVzL3N0b3J5Lmpzb24nLCAkc2NvcGUuc3RvcnkpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3JpZ2luYWxTdG9yeSA9IGFuZ3VsYXIuY29weSgkc2NvcGUuc3RvcnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jYW5SdW5TdG9yeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5zdG9yeUZvcm0uJHZhbGlkICYmICEkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLnJ1blN0b3J5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmNhblJ1blN0b3J5KCkpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hY3RpdmF0ZVJ1bm5lclRhYi52YWx1ZSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2F2ZVN0b3J5KCk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUub3BlblJ1bm5lck1vZGFsKCkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2xhc3NlcyA9IGRhdGEuY2xhc3NlcztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlGb3JtQ2xhc3MgPSAnY29sLW1kLTYnO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckNsYXNzID0gJ2NvbC1tZC02JztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJWaXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc2VzLmZvckVhY2goZnVuY3Rpb24gKGNsYXNzRW50cnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NFbnRyeS5wYXJhbXMuZm9yRWFjaChmdW5jdGlvbiAocGFyYW1FbnRyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvb2tpZVN0b3JlLnB1dChjbGFzc0VudHJ5LmZ1bGxOYW1lICsgXCIuXCIgKyBwYXJhbUVudHJ5LmtleSwgcGFyYW1FbnRyeS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBqc29uID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9yeVBhdGhzOiBbe3BhdGg6ICRzY29wZS5zdG9yeS5wYXRofV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6IGNsYXNzZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb292eUNvbXBvc2l0ZXM6ICRzY29wZS5ncm9vdnlDb21wb3NpdGVzXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KCcvcnVubmVyL3J1bi5qc29uJywganNvbikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyA9IChyZXNwb25zZS5kYXRhLnN0YXR1cyA9PT0gJ09LJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFJlcG9ydHMocmVzcG9uc2UuZGF0YS5pZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclN1Y2Nlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5vcGVuRXJyb3JNb2RhbChyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0UmVwb3J0cyA9IGZ1bmN0aW9uKHJlcG9ydHNJZCkge1xyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvcmVwb3J0ZXJzL2xpc3QvJyArIHJlcG9ydHNJZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZXBvcnRzID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZXBvcnRzLmlkID0gcmVwb3J0c0lkO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnNldFBlbmRpbmdTdGVwcygkc2NvcGUucmVwb3J0cyk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmdldFJlcG9ydFVybCA9IGZ1bmN0aW9uKHJlcG9ydHNJZCwgcmVwb3J0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnL2FwaS92MS9yZXBvcnRlcnMvZ2V0LycgKyByZXBvcnRzSWQgKyAnLycgKyByZXBvcnQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUub3BlblJ1bm5lck1vZGFsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2Uub3BlblJ1bm5lclBhcmFtZXRlcnNNb2RhbChmYWxzZSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0UnVubmVyUHJvZ3Jlc3NDc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0UnVubmVyUHJvZ3Jlc3NDc3MoJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0UnVubmVyU3RhdHVzQ3NzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldFJ1bm5lclN0YXR1c0NzcyhcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MsXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJTdWNjZXNzLFxyXG4gICAgICAgICAgICAgICAgKCRzY29wZS5wZW5kaW5nU3RlcHMgPiAwKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnNldFBlbmRpbmdTdGVwcyA9IGZ1bmN0aW9uKHJlcG9ydHMpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnBlbmRpbmdTdGVwcyA9IFtdO1xyXG4gICAgICAgICAgICByZXBvcnRzLmZvckVhY2goZnVuY3Rpb24ocmVwb3J0KSB7XHJcbiAgICAgICAgICAgICAgICByZXBvcnQuc3RlcHMuZm9yRWFjaChmdW5jdGlvbihzdGVwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0ZXAuc3RhdHVzID09PSAncGVuZGluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBlbmRpbmdTdGVwcy5wdXNoKHt0ZXh0OiBzdGVwLnRleHR9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuaGFzUGVuZGluZ1N0ZXBzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUucGVuZGluZ1N0ZXBzICE9PSB1bmRlZmluZWQgJiYgJHNjb3BlLnBlbmRpbmdTdGVwcy5sZW5ndGggPiAwO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmdldFN0b3J5UnVubmVyU3RhdHVzVGV4dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdDtcclxuXHJcbiAgICAgICAgICAgIHJlc3VsdCA9IFRjQmRkU2VydmljZS5nZXRTdG9yeVJ1bm5lclN0YXR1c1RleHQoXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzLFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyxcclxuICAgICAgICAgICAgICAgICRzY29wZS5wZW5kaW5nU3RlcHMubGVuZ3RoXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBpZighJHNjb3BlLnN0b3J5UnVubmVyVmlzaWJsZSl7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSAnTm90IHJ1bic7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUucmVtb3ZlQ29sbGVjdGlvbkVsZW1lbnQgPSBUY0JkZFNlcnZpY2UucmVtb3ZlQ29sbGVjdGlvbkVsZW1lbnQ7XHJcbiAgICAgICAgJHNjb3BlLmFkZEVsZW1lbnQgPSBmdW5jdGlvbiAoY29sbGVjdGlvbikge1xyXG4gICAgICAgICAgICBjb2xsZWN0aW9uLnB1c2goe30pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmFkZFNjZW5hcmlvRWxlbWVudCA9IGZ1bmN0aW9uIChjb2xsZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGNvbGxlY3Rpb24ucHVzaCh7dGl0bGU6ICcnLCBtZXRhOiBbXSwgc3RlcHM6IFtdLCBleGFtcGxlc1RhYmxlOiAnJ30pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnJldmVydFN0b3J5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuc3RvcnkgPSBhbmd1bGFyLmNvcHkoJHNjb3BlLm9yaWdpbmFsU3RvcnkpO1xyXG4gICAgICAgICAgICAkc2NvcGUuc3RvcnlGb3JtLiRzZXRQcmlzdGluZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhblJldmVydFN0b3J5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gIWFuZ3VsYXIuZXF1YWxzKCRzY29wZS5zdG9yeSwgJHNjb3BlLm9yaWdpbmFsU3RvcnkpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhbkRlbGV0ZVN0b3J5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLmFjdGlvbiA9PT0gJ1BVVCcgJiYgISRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3M7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUuZGVsZXRlU3RvcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gJHNjb3BlLmRpclBhdGggKyAkc2NvcGUuc3RvcnkubmFtZSArICcuc3RvcnknO1xyXG4gICAgICAgICAgICBUY0JkZFNlcnZpY2UuZGVsZXRlU3RvcnkocGF0aCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuc3RlcEVudGVyS2V5ID0gVGNCZGRTZXJ2aWNlLm5ld0NvbGxlY3Rpb25JdGVtO1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5jbGlja1BlbmRpbmdTdGVwID0gZnVuY3Rpb24oc3RlcFRleHQpIHtcclxuICAgICAgICAgICAgdmFyIGNvbXBvc2l0ZUNsYXNzID0gJGNvb2tpZVN0b3JlLmdldChcImNvbXBvc2l0ZUNsYXNzXCIpO1xyXG4gICAgICAgICAgICBpZiAoY29tcG9zaXRlQ2xhc3MgPT09IHVuZGVmaW5lZCB8fCBjb21wb3NpdGVDbGFzcyA9PT0gJycpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2Uub3BlbkNvbXBvc2l0ZUNsYXNzKHN0ZXBUZXh0KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAkbG9jYXRpb24uc2VhcmNoKCdzdGVwVGV4dCcsIHN0ZXBUZXh0KS5wYXRoKCcvcGFnZS9jb21wb3NpdGVzL2NvbXBvc2l0ZXMuY29tLnRlY2hub2xvZ3ljb252ZXJzYXRpb25zLmJkZC5zdGVwcy4nICsgY29tcG9zaXRlQ2xhc3MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUub3BlbkVycm9yTW9kYWwgPSBUY0JkZFNlcnZpY2Uub3BlbkVycm9yTW9kYWw7XHJcbiAgICB9KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=