angular.module("storiesModule",["ngRoute","ngCookies","ui.bootstrap","ui.sortable","configModule","bodyModule","topMenuModule","storyModule","compositeClassesModule","compositesModule","runnerModule","loginModule","tourModule"]).service("TcBddService",["$modal","$http","$location","$q",function(e,t,o,s){this.openCompositeClass=function(t){var o=this;e.open({templateUrl:"/assets/html/compositeClasses/compositeClasses.tmpl.html",controller:"compositeClassesCtrl",resolve:{compositeClasses:["$route","$http","$modal",function(){return o.getJson("/groovyComposites",!1)}],compositeStepText:function(){return t}}})},this.newCollectionItem=function(e,t){13===e.which&&t.push({})},this.removeCollectionElement=function(e,t){e.splice(t,1)},this.buttonCssClass=function(e){return{"btn-success":e.$valid,"btn-danger":e.$invalid}},this.getRunnerProgressCss=function(e){return{"progress progress-striped active":e,progress:!e}},this.getStoryRunnerStatusText=function(e,t,o){return e?"Story run is in progress":t?o>0?"Story run was successful with "+o+" pending steps":"Story run was successful":"Story run failed"},this.getRunnerStatusCss=function(e,t,o){return{"progress-bar progress-bar-info":e,"progress-bar progress-bar-warning":!e&&t&&o,"progress-bar progress-bar-success":!e&&t&&!o,"progress-bar progress-bar-danger":!e&&!t}},this.openRunnerParametersModal=function(t){var o=this;return e.open({templateUrl:"/assets/html/runner/runnerParams.tmpl.html",controller:"runnerParamsCtrl",resolve:{data:["$route","$http","$modal",function(){return o.getJson("/steps/classes.json",!0)}],showGetApi:function(){return t}}})},this.openDir=function(e,t){if(".."===t){var o=e.rootPath.split("/");e.rootPath=o.slice(0,o.length-2).join("/"),""!==e.rootPath&&(e.rootPath+="/"),this.getStories(e,"")}else this.getStories(e,t)},this.getStories=function(e,o){var s=this;void 0===e.rootPath&&(e.rootPath=""),t.get("/stories/list.json?path="+e.rootPath+o).then(function(t){e.files=t.data,""!==o&&(e.rootPath+=o+"/")},function(e){s.openErrorModal(e.data)})},this.stepTextPattern=function(){return/^(Given|When|Then) .+$/},this.openConfirmationModal=function(t){return e.open({templateUrl:"/assets/html/confirmationModal.tmpl.html",controller:"modalCtrl",resolve:{data:function(){return t}}})},this.classNamePattern=function(){return/^[a-zA-Z_$][a-zA-Z\d_$]*$/},this.cssClass=function(e){return{"has-error":e.$invalid,"has-success":e.$valid&&e.$dirty}},this.deleteStory=function(e){var n=this,r=s.defer(),a={status:"Delete Story",message:"Are you sure you want to delete this story?"},i=this.openConfirmationModal(a);return i.result.then(function(){t.delete("/stories/story/"+e).then(function(){o.path("/page/stories/new/"),r.resolve("OK")},function(e){n.openErrorModal(e.data),r.reject("NOK")})},function(){r.reject("NOK")}),r.promise},this.getJson=function(e,o){var s=this;return t.get(e,{cache:o}).then(function(e){return e.data},function(e){s.openErrorModal(e.data)})},this.openErrorModal=function(t){e.open({templateUrl:"/assets/html/errorModal.tmpl.html",controller:"modalCtrl",resolve:{data:function(){return t}}})}}]).controller("modalCtrl",["$scope","$modalInstance","data",function(e,t,o){e.data=o,e.ok=function(){t.close("ok")},e.cancel=function(){t.dismiss("cancel")}}]).controller("storiesCtrl",["$scope","$http","$modal","$modalInstance","$location","$q","TcBddService",function(e,t,o,s,n,r,a){a.getStories(e,""),e.openDir=function(t){a.openDir(e,t)},e.close=function(){s.close()},e.viewStoryUrl=function(t){return"/page/stories/view/"+e.rootPath+t},e.allowToPrevDir=function(){return""!==e.rootPath},e.deleteStory=function(t,o){var s=e.rootPath+t+".story";a.deleteStory(s).then(function(){e.files.stories.splice(o,1)})},e.createDirectory=function(o){var s='{"path": "'+e.rootPath+o+'"}';t.post("/stories/dir.json",s).then(function(){e.files.dirs.push({name:o})},function(e){a.openErrorModal(e.data)})}}]),angular.module("configModule",[]).config(["$routeProvider","$locationProvider",function(e,t){t.html5Mode(!0),e.when("/page/tour/",{templateUrl:"/assets/html/tour/tour.tmpl.html",controller:"tourCtrl"}).when("/page/stories/new/",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",resolve:{story:["$http","$modal","TcBddService",function(e,t,o){return o.getJson("/stories/story.json",!1)}],steps:["$http","$modal","TcBddService",function(e,t,o){return o.getJson("/steps/list.json",!0)}],groovyComposites:["$http","$modal","TcBddService",function(e,t,o){return o.getJson("/groovyComposites",!0)}]}}).when("/page/stories/new/:path*",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",resolve:{story:["$route","$http","$modal","TcBddService",function(e,t,o,s){return s.getJson("/stories/story.json?path="+e.current.params.path+".story",!1)}],steps:["$http","$modal","TcBddService",function(e,t,o){return o.getJson("/steps/list.json",!0)}],groovyComposites:["$http","$modal","TcBddService",function(e,t,o){return o.getJson("/groovyComposites",!0)}]}}).when("/page/stories/view/:path*",{templateUrl:"/assets/html/story/story.tmpl.html",controller:"storyCtrl",resolve:{story:["$route","$http","$modal","TcBddService",function(e,t,o,s){return s.getJson("/stories/story.json?path="+e.current.params.path+".story",!1)}],steps:["$http","$modal","TcBddService",function(e,t,o){return o.getJson("/steps/list.json",!0)}],groovyComposites:["$http","$modal","TcBddService",function(e,t,o){return o.getJson("/groovyComposites",!0)}]},reloadOnSearch:!1}).when("/page/composites/:className*",{templateUrl:"/assets/html/composites/composites.tmpl.html",controller:"compositesCtrl",resolve:{compositesClass:["$route","$http",function(e,t){var o=e.current.params.className,s="/groovyComposites/"+o;return t.get(s,{cache:!1}).then(function(e){return e.data},function(){var e=o.substring(0,o.lastIndexOf("."));return{"class":e,composites:[{stepText:"",compositeSteps:[{}]}],isNew:!0}})}],steps:["$http","$modal","TcBddService",function(e,t,o){return o.getJson("/steps/list.json",!1)}]}}).when("/page/runner/",{templateUrl:"/assets/html/runner/runner.tmpl.html",controller:"runnerCtrl",resolve:{data:["$route",function(e){return{reportsPath:e.current.params.path}}]}}).when("/page/login/",{templateUrl:"/assets/html/login/login.tmpl.html",controller:"loginCtrl"}).when("/page/loginWelcome/",{templateUrl:"/assets/html/login/loginWelcome.tmpl.html",controller:"loginWelcomeCtrl"}).otherwise({redirectTo:"/page/tour"})}]),angular.module("bodyModule",["ngJoyRide"]).controller("bodyCtrl",["$scope",function(e){e.startJoyRideFlag=!1,e.configJoyRide=[{type:"element",selector:"#menu",heading:"Navigation",text:"The main purpose of the navigation menu is to provide quick links to major sections of the application as well as the information about the current location.",placement:"bottom",scroll:!0},{type:"element",selector:"#browseStories",heading:"Browse Stories",text:"Displays the dialog that can be used to open an existing or create a new story.",placement:"bottom",scroll:!0},{type:"element",selector:"#browseComposites",heading:"Browse Composites",text:"Displays the dialog that can be used to open an existing or create a new composites class.",placement:"bottom",scroll:!0},{type:"element",selector:"#runner",heading:"Run Stories",text:"Displays the dialog that can be used to select one or more stories and directories with stories that will be run.",placement:"bottom",scroll:!0},{type:"element",selector:"#menu",heading:"Navigation",text:"This tour is still under construction. More will be added soon.",placement:"bottom",scroll:!0}],e.onFinishJoyRide=function(){console.log("TOUR FINISHED")},e.startJoyRide=function(){e.startJoyRideFlag=!0}}]),angular.module("compositeClassesModule",[]).controller("compositeClassesCtrl",["$scope","$http","$modalInstance","compositeClasses","compositeStepText","TcBddService",function(e,t,o,s,n,r){e.compositeClasses=s,e.compositeStepText=n,e.close=function(){o.close()},e.compositeClassUrl=function(t,o){var s="/page/composites/";void 0!==t&&""!==t&&(s+=t+".");var n;return n=o.split(o.indexOf("/")>=0?"/":"\\"),s+=n[n.length-1],void 0!==e.compositeStepText&&""!==e.compositeStepText&&(s+="?stepText="+e.compositeStepText),s},e.compositeClassText=function(e){var t;t=e.split(e.indexOf("/")>=0?"/":"\\");var o=t[t.length-1];return o.indexOf(".")>=0&&(o=o.substr(0,o.lastIndexOf("."))),o},e.classNamePattern=r.classNamePattern,e.cssClass=r.cssClass,e.data={"class":""}}]),angular.module("compositesModule",[]).controller("compositesCtrl",["$scope","$http","$modal","$location","$cookieStore","compositesClass","steps","TcBddService",function(e,t,o,s,n,r,a,i){e.addNewComposite=function(){e.composite={stepText:"",compositeSteps:[{}]},e.compositesClass.composites.push(e.composite)},e.addStepTextParam=function(){void 0!==s.search().stepText&&""!==s.search().stepText&&e.compositesClass.composites.push({stepText:s.search().stepText,compositeSteps:[]})},e.addNewCompositeStep=function(){e.composite.compositeSteps.push({})},e.setLastComposite=function(){if(void 0!==e.compositesClass){var t=e.compositesClass.composites.length;e.composite=e.compositesClass.composites[t-1]}else e.composite={}},e.compositesClass=r,e.addStepTextParam(),e.originalCompositesClass=angular.copy(r),e.setLastComposite(),e.steps=a,e.classNamePattern=i.classNamePattern,e.stepTextPattern=i.stepTextPattern,e.cssClass=i.cssClass,e.buttonCssClass=function(e,t){return i.buttonCssClass(e.$valid?t:e)},e.openComposite=function(t){e.composite=t},e.newCollectionItem=i.newCollectionItem,e.removeCollectionElement=i.removeCollectionElement,e.revertCompositesClass=function(){e.compositesClass=angular.copy(e.originalCompositesClass),e.composite=e.compositesClass.composites[0]},e.canRevertCompositesClass=function(){return!angular.equals(e.compositesClass,e.originalCompositesClass)},e.canSaveCompositesClass=function(t){var o=t.$valid,s=!angular.equals(e.compositesClass,e.originalCompositesClass),n=e.compositesClass.isNew;return(n||s)&&o},e.compositesAreValid=function(t){var o=t.$valid;return angular.forEach(e.compositesClass.composites,function(e){void 0===e.stepText||""===e.stepText?o=!1:(void 0===e.compositeSteps||0===e.compositeSteps.length)&&(o=!1)}),o},e.saveCompositesClass=function(){t.put("/groovyComposites",e.compositesClass).then(function(){e.deleteCompositesClassWithoutConfirmation(),s.path("/page/composites/"+e.compositesClass.class+".groovy"),e.compositesClass.isNew=!1,e.originalCompositesClass=angular.copy(e.compositesClass),n.put("compositeClass",e.compositesClass.class)},function(e){i.openErrorModal(e.data)})},e.canDeleteCompositesClass=function(){return!e.compositesClass.isNew},e.deleteCompositesClassWithoutConfirmation=function(){var o=e.compositesClass.class,s=e.originalCompositesClass.class;o!==s&&t.delete("/groovyComposites/"+s).then(function(){},function(e){i.openErrorModal(e.data)})},e.deleteCompositesClass=function(){var o={status:"Delete Composites Class",message:"Are you sure you want to delete this composites class?"},n=i.openConfirmationModal(o);n.result.then(function(){t.delete("/groovyComposites/"+e.originalCompositesClass.class).then(function(){s.path("/")},function(e){i.openErrorModal(e.data)})},function(){})},e.saveCompositesText=function(){return e.compositesClass.isNew?"Create New Composites":"Update Composites"}}]),angular.module("loginModule",[]).controller("loginCtrl",["$scope","$location","TcBddService",function(e,t,o){e.init=function(){e.users=[]},e.cssClass=o.cssClass,e.buttonCssClass=o.buttonCssClass,e.canLogin=function(){return e.loginForm.$valid},e.register=function(){e.users.push(e.user),e.user={}},e.delete=function(){angular.forEach(e.users,function(t,o){t.username===e.user.username&&(e.users.splice(o,1),e.user={})})},e.login=function(){angular.forEach(e.users,function(o){o.username===e.user.username&&t.path("/page/loginWelcome")}),e.user.notRegistered=!0},e.init()}]).controller("loginWelcomeCtrl",["$scope",function(){}]),angular.module("storyModule",[]).controller("storyCtrl",["$scope","$http","$modal","$location","$cookieStore","$q","$anchorScroll","$timeout","story","steps","groovyComposites","TcBddService",function(e,t,o,s,n,r,a,i,l,c,u,p){e.pendingSteps=[],e.setAction=function(){e.action=""!==e.story.name?"PUT":"POST"},e.expandPanels=function(){var t=!0;void 0===e.panelsExpanded?e.panelsExpanded=!1:(e.panelsExpanded=!e.panelsExpanded,t=e.panelsExpanded),e.panels={story:e.panelsExpanded,description:e.panelsExpanded,meta:e.panelsExpanded,narrative:e.panelsExpanded,givenStories:e.panelsExpanded,lifecycle:e.panelsExpanded,scenarios:t}},e.story=l,e.steps=c,e.groovyComposites=u,e.stepTypes=["GIVEN","WHEN","THEN"],e.storyFormClass="col-md-12",e.storyRunnerVisible=!1,e.storyRunnerInProgress=!1,e.storyRunnerSuccess=!0,e.expandPanels(),e.originalStory=angular.copy(l);var d=e.story.path.split("/");e.dirPath=d.slice(0,d.length-1).join("/"),""!==e.dirPath&&(e.dirPath+="/"),e.setAction(),e.cssClass=p.cssClass,e.buttonCssClass=p.buttonCssClass,e.canSaveStory=function(){var t=e.storyForm.$valid,o=!angular.equals(e.story,e.originalStory);return t&&o},e.stepTextPattern=p.stepTextPattern,e.saveStory=function(){if(e.canSaveStory())if(e.story.path=e.dirPath+e.story.name+".story","POST"===e.action){var o=e.dirPath.split("/"),n=o.slice(0,o.length-1).join("/");""!==n&&(n+="/"),t.post("/stories/story.json",e.story).then(function(){s.path("/page/stories/view/"+n+e.story.name),e.originalStory=angular.copy(e.story)},function(t){e.openErrorModal(t.data)})}else e.story.name!==e.originalStory.name&&(e.story.originalPath=e.originalStory.path),t.put("/stories/story.json",e.story).then(function(){e.originalStory=angular.copy(e.story)},function(t){e.openErrorModal(t.data)})},e.canRunStory=function(){return e.storyForm.$valid&&!e.storyRunnerInProgress},e.runStory=function(){e.canRunStory()&&(e.saveStory(),e.openRunnerModal().result.then(function(o){var s=o.classes;e.storyFormClass="col-md-6",e.storyRunnerClass="col-md-6",e.storyRunnerVisible=!0,e.storyRunnerInProgress=!0,s.forEach(function(e){e.params.forEach(function(t){n.put(e.fullName+"."+t.key,t.value)})});var r={storyPaths:[{path:e.story.path}],classes:s,groovyComposites:e.groovyComposites};t.post("/runner/run.json",r).then(function(t){e.getReports(t.data.id)},function(t){e.storyRunnerSuccess=!1,e.storyRunnerInProgress=!1,e.openErrorModal(t.data)})},function(t){e.openErrorModal(t.data)}))},e.getReports=function(o){t.get("/api/v1/reporters/list/"+o).then(function(t){if("finished"!==t.data.status)e.storyRunnerInProgress=!0,i(function(){e.getReports(o)},5e3);else{var s=t.data.reports;e.reports=s,e.reports.id=o,e.setPendingSteps(s),e.storyRunnerInProgress=!1,e.storyRunnerSuccess=e.isStoryRunnerSuccess(s)}},function(t){"ID is NOT correct"===t.data.message?i(function(){e.getReports(o)},5e3):(e.storyRunnerInProgress=!1,p.openErrorModal(t.data))})},e.isStoryRunnerSuccess=function(e){var t=!0;return e.forEach(function(e){e.steps.forEach(function(e){"successful"!==e.status&&"pending"!==e.status&&"notPerformed"!==e.status&&(t=!1)})}),t},e.getReportUrl=function(e,t){return"/api/v1/reporters/get/"+e+"/"+t},e.openRunnerModal=function(){return p.openRunnerParametersModal(!1)},e.getRunnerProgressCss=function(){return p.getRunnerProgressCss(e.storyRunnerInProgress)},e.getRunnerStatusCss=function(){return p.getRunnerStatusCss(e.storyRunnerInProgress,e.storyRunnerSuccess,e.pendingSteps>0)},e.setPendingSteps=function(t){e.pendingSteps=[],t.forEach(function(t){t.steps.forEach(function(t){"pending"===t.status&&e.pendingSteps.push({text:t.text})})})},e.hasPendingSteps=function(){return void 0!==e.pendingSteps&&e.pendingSteps.length>0},e.getStoryRunnerStatusText=function(){return p.getStoryRunnerStatusText(e.storyRunnerInProgress,e.storyRunnerSuccess,e.pendingSteps.length)},e.removeCollectionElement=p.removeCollectionElement,e.addElement=function(e){e.push({})},e.addScenarioElement=function(e){e.push({title:"",meta:[],steps:[],examplesTable:""})},e.revertStory=function(){e.story=angular.copy(e.originalStory),e.storyForm.$setPristine()},e.canRevertStory=function(){return!angular.equals(e.story,e.originalStory)},e.canDeleteStory=function(){return"PUT"===e.action&&!e.storyRunnerInProgress},e.deleteStory=function(){var t=e.dirPath+e.story.name+".story";p.deleteStory(t)},e.stepEnterKey=p.newCollectionItem,e.clickPendingStep=function(e){var t=n.get("compositeClass");return void 0===t||""===t?p.openCompositeClass(e):s.search("stepText",e).path("/page/composites/"+t+".groovy")},e.openErrorModal=p.openErrorModal}]),angular.module("topMenuModule",[]).controller("topMenuController",["$scope","$modal","$location","TcBddService",function(e,t,o,s){e.openStory=function(){t.open({templateUrl:"/assets/html/stories.tmpl.html",controller:"storiesCtrl",resolve:{data:function(){return{}}}})},e.openCompositeClass=function(){s.openCompositeClass()},e.getTitle=function(){var e=o.path();return 0===e.indexOf("/page/stories/view/")?"View Story":0===e.indexOf("/page/stories/new/")?"New Story":0===e.indexOf("/page/composites/")?"Composites":0===e.indexOf("/page/reports/")?"Reports":0===e.indexOf("/page/login/")?"Login":0===e.indexOf("/page/loginWelcome/")?"Welcome":0===e.indexOf("/page/tour/")?"Home":""}}]),angular.module("tourModule",[]).controller("tourCtrl",["$scope",function(){}]),angular.module("runnerModule",[]).controller("runnerCtrl",["$scope","$modal","$http","$location","$timeout","TcBddService",function(e,t,o,s,n,r){e.openRunnerSelector=function(){return t.open({templateUrl:"/assets/html/runner/runnerSelector.tmpl.html",controller:"runnerSelectorCtrl",resolve:{data:function(){return{}}}})},e.openRunner=function(){var t=e.openRunnerSelector();void 0!==t&&t.result.then(function(t){var s=[];t.dirs.forEach(function(e){s.push({path:e.path+"/**/*.story"})}),t.stories.forEach(function(e){s.push({path:e.path})}),r.openRunnerParametersModal(!0).result.then(function(t){var n=t.classes,r=t.action;o.get("/groovyComposites").then(function(t){var o=t.data;e.apiJson={storyPaths:s,classes:n,groovyComposites:o},"run"===r?(e.run(e.apiJson),e.showApi=!1):e.showApi=!0})})})},e.run=function(t){var s="/api/v1/reporters/get/";e.reportsUrl="",e.storyRunnerSuccess=!1,e.showRunnerProgress=!0,o.post("/runner/run.json",t).then(function(t){var o=t.data;"OK"===o.status?(e.reportsUrl=s+o.reportsPath,e.storyRunnerInProgress=!0,e.getReports(o.id)):"FAILED"===o.status?(e.reportsUrl=s+o.reportsPath,e.storyRunnerInProgress=!1):r.openErrorModal(o)},function(t){e.storyRunnerInProgress=!1,e.storyRunnerSuccess=!1,r.openErrorModal(t.data)})},e.getReports=function(t){o.get("/api/v1/reporters/list/"+t).then(function(o){e.reports=o.data,"finished"!==e.reports.status?(e.showRunnerProgress=!0,n(function(){e.getReports(t)},15e3)):e.showRunnerProgress=!1},function(o){"ID is NOT correct"===o.data.message?n(function(){e.getReports(t)},15e3):(e.showRunnerProgress=!1,r.openErrorModal(o.data))})},e.getRunnerStatusCss=function(){return r.getRunnerStatusCss(e.storyRunnerInProgress,e.storyRunnerSuccess,e.pendingSteps>0)},e.getStoryRunnerStatusText=function(){return e.storyRunnerInProgress?"Stories run is in progress":"Stories run is finished"},e.getRunnerProgressCss=function(){return r.getRunnerProgressCss(e.storyRunnerInProgress)},e.init=function(){e.storyRunnerInProgress=!1,e.storyRunnerSuccess=!1,e.showRunnerProgress=!1,e.pendingSteps=[],e.reportsUrl="",e.openRunner(),e.showApi=!1},e.apiUrl=function(){return s.protocol()+"://"+s.host()+":"+s.port()+"/runner/run.json"},e.init()}]).controller("runnerSelectorCtrl",["$scope","$http","$modal","$modalInstance","TcBddService",function(e,t,o,s,n){e.files={dirs:[],stories:[]},n.getStories(e,""),e.openDir=function(t){n.openDir(e,t)},e.cancelRunnerSelector=function(){s.dismiss("cancel")},e.okRunnerSelector=function(){var t={dirs:[],stories:[]};angular.forEach(e.files.dirs,function(o){o.selected&&t.dirs.push({path:e.rootPath+o.name})}),angular.forEach(e.files.stories,function(o){o.selected&&t.stories.push({path:e.rootPath+o.name+".story"})}),s.close(t)},e.allowToPrevDir=function(){return""!==e.rootPath},e.canContinue=function(){var t=!1;return angular.forEach(e.files.dirs,function(e){e.selected&&(t=!0)}),t||angular.forEach(e.files.stories,function(e){e.selected&&(t=!0)}),t}}]).controller("runnerParamsCtrl",["$scope","$modalInstance","$cookieStore","data","showGetApi",function(e,t,o,s,n){e.classes=s.classes,e.paramArray=[],e.setParams=function(){e.classes.forEach(function(e){e.params.forEach(function(t){if(void 0!==t.value&&""!==t.value)t.disabled=!0;else{t.disabled=!1;try{t.value=o.get(e.fullName+"."+t.key)}catch(s){console.log("Could not retrieve cookie "+e.fullName+"."+t.key),console.log(s.message)}}})})},e.hasOptions=function(e){return e?e.length>0:!1},e.hasParams=function(e){return void 0!==e.params&&e.params.length>0},e.ok=function(){t.close({action:"run",classes:e.classes})},e.cancel=function(){t.dismiss("cancel")},e.showGetApi=function(){return n},e.getApi=function(){t.close({action:"api",classes:e.classes})},e.paramElementId=function(e,t){var o=e.charAt(0).toLowerCase()+e.slice(1),s=t.charAt(0).toUpperCase()+t.slice(1);return o+s},e.setParams()}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlcyI6WyJpbmRleC5qcyIsImNvbmZpZy5qcyIsImNvbW1vblxcYm9keS5jdHJsLmpzIiwiY29tcG9zaXRlQ2xhc3Nlc1xcY29tcG9zaXRlQ2xhc3Nlcy5jdHJsLmpzIiwiY29tcG9zaXRlc1xcY29tcG9zaXRlcy5jdHJsLmpzIiwibG9naW5cXGxvZ2luLmN0cmwuanMiLCJzdG9yeVxcc3RvcnkuY3RybC5qcyIsInRvcE1lbnVcXHRvcE1lbnUuY3RybC5qcyIsInRvdXJcXHRvdXIuY3RybC5qcyIsInJ1bm5lclxccnVubmVyLmN0cmwuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsUUFBQSxPQUFBLGlCQUNBLFVBQ0EsWUFDQSxlQUNBLGNBQ0EsZUFDQSxhQUNBLGdCQUNBLGNBQ0EseUJBQ0EsbUJBQ0EsZUFDQSxjQUNBLGVBRUEsUUFBQSxnQkFBQSxTQUFBLFFBQUEsWUFBQSxLQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxLQUFBLG1CQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsSUFDQSxHQUFBLE1BQ0EsWUFBQSwyREFDQSxXQUFBLHVCQUNBLFNBQ0Esa0JBQUEsU0FBQSxRQUFBLFNBQUEsV0FDQSxNQUFBLEdBQUEsUUFBQSxxQkFBQSxLQUVBLGtCQUFBLFdBQ0EsTUFBQSxRQUtBLEtBQUEsa0JBQUEsU0FBQSxFQUFBLEdBQ0EsS0FBQSxFQUFBLE9BQ0EsRUFBQSxVQUdBLEtBQUEsd0JBQUEsU0FBQSxFQUFBLEdBQ0EsRUFBQSxPQUFBLEVBQUEsSUFFQSxLQUFBLGVBQUEsU0FBQSxHQUNBLE9BQ0EsY0FBQSxFQUFBLE9BQ0EsYUFBQSxFQUFBLFdBR0EsS0FBQSxxQkFBQSxTQUFBLEdBQ0EsT0FDQSxtQ0FBQSxFQUNBLFVBQUEsSUFHQSxLQUFBLHlCQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUNBLDJCQUNBLEVBQ0EsRUFBQSxFQUNBLGlDQUFBLEVBQUEsaUJBRUEsMkJBR0Esb0JBR0EsS0FBQSxtQkFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLE9BQ0EsaUNBQUEsRUFDQSxxQ0FBQSxHQUFBLEdBQUEsRUFDQSxxQ0FBQSxHQUFBLElBQUEsRUFDQSxvQ0FBQSxJQUFBLElBR0EsS0FBQSwwQkFBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLElBQ0EsT0FBQSxHQUFBLE1BQ0EsWUFBQSw2Q0FDQSxXQUFBLG1CQUNBLFNBQ0EsTUFBQSxTQUFBLFFBQUEsU0FBQSxXQUNBLE1BQUEsR0FBQSxRQUFBLHVCQUFBLEtBRUEsV0FBQSxXQUNBLE1BQUEsUUFLQSxLQUFBLFFBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxPQUFBLEVBQUEsQ0FDQSxHQUFBLEdBQUEsRUFBQSxTQUFBLE1BQUEsSUFDQSxHQUFBLFNBQUEsRUFBQSxNQUFBLEVBQUEsRUFBQSxPQUFBLEdBQUEsS0FBQSxLQUNBLEtBQUEsRUFBQSxXQUNBLEVBQUEsVUFBQSxLQUVBLEtBQUEsV0FBQSxFQUFBLFFBRUEsTUFBQSxXQUFBLEVBQUEsSUFHQSxLQUFBLFdBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLElBQ0EsVUFBQSxFQUFBLFdBQ0EsRUFBQSxTQUFBLElBRUEsRUFBQSxJQUFBLDJCQUFBLEVBQUEsU0FBQSxHQUFBLEtBQUEsU0FBQSxHQUNBLEVBQUEsTUFBQSxFQUFBLEtBQ0EsS0FBQSxJQUNBLEVBQUEsVUFBQSxFQUFBLE1BRUEsU0FBQSxHQUNBLEVBQUEsZUFBQSxFQUFBLFNBR0EsS0FBQSxnQkFBQSxXQUNBLE1BQUEsMEJBRUEsS0FBQSxzQkFBQSxTQUFBLEdBQ0EsTUFBQSxHQUFBLE1BQ0EsWUFBQSwyQ0FDQSxXQUFBLFlBQ0EsU0FDQSxLQUFBLFdBQ0EsTUFBQSxRQUtBLEtBQUEsaUJBQUEsV0FDQSxNQUFBLDZCQUVBLEtBQUEsU0FBQSxTQUFBLEdBQ0EsT0FDQSxZQUFBLEVBQUEsU0FDQSxjQUFBLEVBQUEsUUFBQSxFQUFBLFNBSUEsS0FBQSxZQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsS0FDQSxFQUFBLEVBQUEsUUFDQSxHQUFBLE9BQUEsZUFBQSxRQUFBLCtDQUNBLEVBQUEsS0FBQSxzQkFBQSxFQVlBLE9BWEEsR0FBQSxPQUFBLEtBQUEsV0FDQSxFQUFBLE9BQUEsa0JBQUEsR0FBQSxLQUFBLFdBQ0EsRUFBQSxLQUFBLHNCQUNBLEVBQUEsUUFBQSxPQUNBLFNBQUEsR0FDQSxFQUFBLGVBQUEsRUFBQSxNQUNBLEVBQUEsT0FBQSxVQUVBLFdBQ0EsRUFBQSxPQUFBLFNBRUEsRUFBQSxTQUVBLEtBQUEsUUFBQSxTQUFBLEVBQUEsR0FDQSxHQUFBLEdBQUEsSUFDQSxPQUFBLEdBQUEsSUFBQSxHQUFBLE1BQUEsSUFBQSxLQUFBLFNBQUEsR0FDQSxNQUFBLEdBQUEsTUFDQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEVBQUEsU0FHQSxLQUFBLGVBQUEsU0FBQSxHQUNBLEVBQUEsTUFDQSxZQUFBLG9DQUNBLFdBQUEsWUFDQSxTQUNBLEtBQUEsV0FDQSxNQUFBLFdBTUEsV0FBQSxhQUFBLFNBQUEsaUJBQUEsT0FBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsS0FBQSxFQUNBLEVBQUEsR0FBQSxXQUNBLEVBQUEsTUFBQSxPQUVBLEVBQUEsT0FBQSxXQUNBLEVBQUEsUUFBQSxjQUdBLFdBQUEsZUFBQSxTQUFBLFFBQUEsU0FBQSxpQkFBQSxZQUFBLEtBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxXQUFBLEVBQUEsSUFDQSxFQUFBLFFBQUEsU0FBQSxHQUNBLEVBQUEsUUFBQSxFQUFBLElBRUEsRUFBQSxNQUFBLFdBQ0EsRUFBQSxTQUVBLEVBQUEsYUFBQSxTQUFBLEdBQ0EsTUFBQSxzQkFBQSxFQUFBLFNBQUEsR0FFQSxFQUFBLGVBQUEsV0FDQSxNQUFBLEtBQUEsRUFBQSxVQUdBLEVBQUEsWUFBQSxTQUFBLEVBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxTQUFBLEVBQUEsUUFDQSxHQUFBLFlBQUEsR0FBQSxLQUFBLFdBQ0EsRUFBQSxNQUFBLFFBQUEsT0FBQSxFQUFBLE1BSUEsRUFBQSxnQkFBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLGFBQUEsRUFBQSxTQUFBLEVBQUEsSUFDQSxHQUFBLEtBQUEsb0JBQUEsR0FBQSxLQUFBLFdBQ0EsRUFBQSxNQUFBLEtBQUEsTUFBQSxLQUFBLEtBQ0EsU0FBQSxHQUNBLEVBQUEsZUFBQSxFQUFBLFlDbk5BLFFBQUEsT0FBQSxtQkFDQSxRQUFBLGlCQUFBLG9CQUFBLFNBQUEsRUFBQSxHQUNBLEVBQUEsV0FBQSxHQUNBLEVBQ0EsS0FBQSxlQUNBLFlBQUEsbUNBQ0EsV0FBQSxhQUVBLEtBQUEsc0JBQ0EsWUFBQSxxQ0FDQSxXQUFBLFlBRUEsU0FDQSxPQUFBLFFBQUEsU0FBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLFFBQUEsdUJBQUEsS0FFQSxPQUFBLFFBQUEsU0FBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLFFBQUEsb0JBQUEsS0FFQSxrQkFBQSxRQUFBLFNBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsR0FBQSxRQUFBLHFCQUFBLFFBSUEsS0FBQSw0QkFDQSxZQUFBLHFDQUNBLFdBQUEsWUFFQSxTQUNBLE9BQUEsU0FBQSxRQUFBLFNBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLFFBQUEsNEJBQUEsRUFBQSxRQUFBLE9BQUEsS0FBQSxVQUFBLEtBRUEsT0FBQSxRQUFBLFNBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsR0FBQSxRQUFBLG9CQUFBLEtBRUEsa0JBQUEsUUFBQSxTQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxNQUFBLEdBQUEsUUFBQSxxQkFBQSxRQUlBLEtBQUEsNkJBQ0EsWUFBQSxxQ0FDQSxXQUFBLFlBRUEsU0FDQSxPQUFBLFNBQUEsUUFBQSxTQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsR0FBQSxRQUFBLDRCQUFBLEVBQUEsUUFBQSxPQUFBLEtBQUEsVUFBQSxLQUVBLE9BQUEsUUFBQSxTQUFBLGVBQUEsU0FBQSxFQUFBLEVBQUEsR0FDQSxNQUFBLEdBQUEsUUFBQSxvQkFBQSxLQUVBLGtCQUFBLFFBQUEsU0FBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEdBQ0EsTUFBQSxHQUFBLFFBQUEscUJBQUEsTUFHQSxnQkFBQSxJQUVBLEtBQUEsZ0NBQ0EsWUFBQSwrQ0FDQSxXQUFBLGlCQUVBLFNBQ0EsaUJBQUEsU0FBQSxRQUFBLFNBQUEsRUFBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLFFBQUEsT0FBQSxVQUNBLEVBQUEscUJBQUEsQ0FDQSxPQUFBLEdBQUEsSUFBQSxHQUFBLE9BQUEsSUFBQSxLQUFBLFNBQUEsR0FDQSxNQUFBLEdBQUEsTUFDQSxXQUNBLEdBQUEsR0FBQSxFQUFBLFVBQUEsRUFBQSxFQUFBLFlBQUEsS0FDQSxRQUNBLFFBQUEsRUFDQSxhQUFBLFNBQUEsR0FBQSxzQkFDQSxPQUFBLE9BSUEsT0FBQSxRQUFBLFNBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLE1BQUEsR0FBQSxRQUFBLG9CQUFBLFFBSUEsS0FBQSxpQkFDQSxZQUFBLHVDQUNBLFdBQUEsYUFFQSxTQUNBLE1BQUEsU0FBQSxTQUFBLEdBQ0EsT0FBQSxZQUFBLEVBQUEsUUFBQSxPQUFBLFdBSUEsS0FBQSxnQkFDQSxZQUFBLHFDQUNBLFdBQUEsY0FFQSxLQUFBLHVCQUNBLFlBQUEsNENBQ0EsV0FBQSxxQkFFQSxXQUNBLFdBQUEsa0JDcEdBLFFBQUEsT0FBQSxjQUFBLGNBQ0EsV0FBQSxZQUFBLFNBQUEsU0FBQSxHQUNBLEVBQUEsa0JBQUEsRUFDQSxFQUFBLGdCQUVBLEtBQUEsVUFDQSxTQUFBLFFBQ0EsUUFBQSxhQUNBLEtBQUEsZ0tBQ0EsVUFBQSxTQUNBLFFBQUEsSUFFQSxLQUFBLFVBQ0EsU0FBQSxpQkFDQSxRQUFBLGlCQUNBLEtBQUEsa0ZBQ0EsVUFBQSxTQUNBLFFBQUEsSUFFQSxLQUFBLFVBQ0EsU0FBQSxvQkFDQSxRQUFBLG9CQUNBLEtBQUEsNkZBQ0EsVUFBQSxTQUNBLFFBQUEsSUFFQSxLQUFBLFVBQ0EsU0FBQSxVQUNBLFFBQUEsY0FDQSxLQUFBLG9IQUNBLFVBQUEsU0FDQSxRQUFBLElBU0EsS0FBQSxVQUNBLFNBQUEsUUFDQSxRQUFBLGFBQ0EsS0FBQSxrRUFDQSxVQUFBLFNBQ0EsUUFBQSxJQUdBLEVBQUEsZ0JBQUEsV0FDQSxRQUFBLElBQUEsa0JBRUEsRUFBQSxhQUFBLFdBQ0EsRUFBQSxrQkFBQSxNQ3BEQSxRQUFBLE9BQUEsNkJBQ0EsV0FBQSx3QkFBQSxTQUFBLFFBQUEsaUJBQUEsbUJBQUEsb0JBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsaUJBQUEsRUFDQSxFQUFBLGtCQUFBLEVBRUEsRUFBQSxNQUFBLFdBQ0EsRUFBQSxTQUVBLEVBQUEsa0JBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLG1CQUNBLFVBQUEsR0FBQSxLQUFBLElBQ0EsR0FBQSxFQUFBLElBRUEsSUFBQSxFQVVBLE9BUkEsR0FBQSxFQUFBLE1BREEsRUFBQSxRQUFBLE1BQUEsRUFDQSxJQUVBLE1BRUEsR0FBQSxFQUFBLEVBQUEsT0FBQSxHQUNBLFNBQUEsRUFBQSxtQkFBQSxLQUFBLEVBQUEsb0JBQ0EsR0FBQSxhQUFBLEVBQUEsbUJBRUEsR0FFQSxFQUFBLG1CQUFBLFNBQUEsR0FDQSxHQUFBLEVBRUEsR0FBQSxFQUFBLE1BREEsRUFBQSxRQUFBLE1BQUEsRUFDQSxJQUVBLEtBRUEsSUFBQSxHQUFBLEVBQUEsRUFBQSxPQUFBLEVBSUEsT0FIQSxHQUFBLFFBQUEsTUFBQSxJQUNBLEVBQUEsRUFBQSxPQUFBLEVBQUEsRUFBQSxZQUFBLE9BRUEsR0FFQSxFQUFBLGlCQUFBLEVBQUEsaUJBRUEsRUFBQSxTQUFBLEVBQUEsU0FDQSxFQUFBLE1BQUEsUUFBQSxPQ3pDQSxRQUFBLE9BQUEsdUJBQ0EsV0FBQSxrQkFBQSxTQUFBLFFBQUEsU0FBQSxZQUFBLGVBQUEsa0JBQUEsUUFBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsZ0JBQUEsV0FDQSxFQUFBLFdBQUEsU0FBQSxHQUFBLHFCQUNBLEVBQUEsZ0JBQUEsV0FBQSxLQUFBLEVBQUEsWUFFQSxFQUFBLGlCQUFBLFdBQ0EsU0FBQSxFQUFBLFNBQUEsVUFBQSxLQUFBLEVBQUEsU0FBQSxVQUNBLEVBQUEsZ0JBQUEsV0FBQSxNQUFBLFNBQUEsRUFBQSxTQUFBLFNBQUEscUJBR0EsRUFBQSxvQkFBQSxXQUNBLEVBQUEsVUFBQSxlQUFBLFVBRUEsRUFBQSxpQkFBQSxXQUNBLEdBQUEsU0FBQSxFQUFBLGdCQUFBLENBQ0EsR0FBQSxHQUFBLEVBQUEsZ0JBQUEsV0FBQSxNQUNBLEdBQUEsVUFBQSxFQUFBLGdCQUFBLFdBQUEsRUFBQSxPQUVBLEdBQUEsY0FHQSxFQUFBLGdCQUFBLEVBQ0EsRUFBQSxtQkFDQSxFQUFBLHdCQUFBLFFBQUEsS0FBQSxHQUNBLEVBQUEsbUJBQ0EsRUFBQSxNQUFBLEVBQ0EsRUFBQSxpQkFBQSxFQUFBLGlCQUNBLEVBQUEsZ0JBQUEsRUFBQSxnQkFDQSxFQUFBLFNBQUEsRUFBQSxTQUNBLEVBQUEsZUFBQSxTQUFBLEVBQUEsR0FDQSxNQUdBLEdBQUEsZUFIQSxFQUFBLE9BR0EsRUFGQSxJQUtBLEVBQUEsY0FBQSxTQUFBLEdBQ0EsRUFBQSxVQUFBLEdBRUEsRUFBQSxrQkFBQSxFQUFBLGtCQUNBLEVBQUEsd0JBQUEsRUFBQSx3QkFDQSxFQUFBLHNCQUFBLFdBQ0EsRUFBQSxnQkFBQSxRQUFBLEtBQUEsRUFBQSx5QkFDQSxFQUFBLFVBQUEsRUFBQSxnQkFBQSxXQUFBLElBRUEsRUFBQSx5QkFBQSxXQUNBLE9BQUEsUUFBQSxPQUFBLEVBQUEsZ0JBQUEsRUFBQSwwQkFFQSxFQUFBLHVCQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxPQUNBLEdBQUEsUUFBQSxPQUFBLEVBQUEsZ0JBQUEsRUFBQSx5QkFDQSxFQUFBLEVBQUEsZ0JBQUEsS0FDQSxRQUFBLEdBQUEsSUFBQSxHQUVBLEVBQUEsbUJBQUEsU0FBQSxHQUNBLEdBQUEsR0FBQSxFQUFBLE1BUUEsT0FQQSxTQUFBLFFBQUEsRUFBQSxnQkFBQSxXQUFBLFNBQUEsR0FDQSxTQUFBLEVBQUEsVUFBQSxLQUFBLEVBQUEsU0FDQSxHQUFBLEdBQ0EsU0FBQSxFQUFBLGdCQUFBLElBQUEsRUFBQSxlQUFBLFVBQ0EsR0FBQSxLQUdBLEdBRUEsRUFBQSxvQkFBQSxXQUNBLEVBQUEsSUFBQSxvQkFBQSxFQUFBLGlCQUFBLEtBQUEsV0FDQSxFQUFBLDJDQUNBLEVBQUEsS0FBQSxvQkFBQSxFQUFBLGdCQUFBLE1BQUEsV0FDQSxFQUFBLGdCQUFBLE9BQUEsRUFDQSxFQUFBLHdCQUFBLFFBQUEsS0FBQSxFQUFBLGlCQUNBLEVBQUEsSUFBQSxpQkFBQSxFQUFBLGdCQUFBLFFBQ0EsU0FBQSxHQUNBLEVBQUEsZUFBQSxFQUFBLFNBR0EsRUFBQSx5QkFBQSxXQUNBLE9BQUEsRUFBQSxnQkFBQSxPQUlBLEVBQUEseUNBQUEsV0FDQSxHQUFBLEdBQUEsRUFBQSxnQkFBQSxNQUNBLEVBQUEsRUFBQSx3QkFBQSxLQUNBLEtBQUEsR0FDQSxFQUFBLE9BQUEscUJBQUEsR0FBQSxLQUFBLGFBQ0EsU0FBQSxHQUNBLEVBQUEsZUFBQSxFQUFBLFNBS0EsRUFBQSxzQkFBQSxXQUNBLEdBQUEsSUFBQSxPQUFBLDBCQUFBLFFBQUEsMERBQ0EsRUFBQSxFQUFBLHNCQUFBLEVBQ0EsR0FBQSxPQUFBLEtBQUEsV0FDQSxFQUFBLE9BQUEscUJBQUEsRUFBQSx3QkFBQSxPQUFBLEtBQUEsV0FDQSxFQUFBLEtBQUEsTUFDQSxTQUFBLEdBQ0EsRUFBQSxlQUFBLEVBQUEsU0FFQSxlQUlBLEVBQUEsbUJBQUEsV0FDQSxNQUFBLEdBQUEsZ0JBQUEsTUFDQSx3QkFFQSx3QkM5R0EsUUFBQSxPQUFBLGtCQUNBLFdBQUEsYUFBQSxTQUFBLFlBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxHQUNBLEVBQUEsS0FBQSxXQUNBLEVBQUEsVUFFQSxFQUFBLFNBQUEsRUFBQSxTQUNBLEVBQUEsZUFBQSxFQUFBLGVBQ0EsRUFBQSxTQUFBLFdBQ0EsTUFBQSxHQUFBLFVBQUEsUUFHQSxFQUFBLFNBQUEsV0FDQSxFQUFBLE1BQUEsS0FBQSxFQUFBLE1BQ0EsRUFBQSxTQUdBLEVBQUEsT0FBQSxXQUNBLFFBQUEsUUFBQSxFQUFBLE1BQUEsU0FBQSxFQUFBLEdBQ0EsRUFBQSxXQUFBLEVBQUEsS0FBQSxXQUNBLEVBQUEsTUFBQSxPQUFBLEVBQUEsR0FDQSxFQUFBLFlBSUEsRUFBQSxNQUFBLFdBRUEsUUFBQSxRQUFBLEVBQUEsTUFBQSxTQUFBLEdBQ0EsRUFBQSxXQUFBLEVBQUEsS0FBQSxVQUNBLEVBQUEsS0FBQSx3QkFHQSxFQUFBLEtBQUEsZUFBQSxHQUVBLEVBQUEsVUFFQSxXQUFBLG9CQUFBLFNBQUEsZUNuQ0EsUUFBQSxPQUFBLGtCQUNBLFdBQUEsYUFBQSxTQUFBLFFBQUEsU0FBQSxZQUFBLGVBQUEsS0FBQSxnQkFBQSxXQUFBLFFBQUEsUUFBQSxtQkFBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBQ0EsRUFBQSxnQkFDQSxFQUFBLFVBQUEsV0FFQSxFQUFBLE9BREEsS0FBQSxFQUFBLE1BQUEsS0FDQSxNQUVBLFFBR0EsRUFBQSxhQUFBLFdBQ0EsR0FBQSxJQUFBLENBQ0EsVUFBQSxFQUFBLGVBQ0EsRUFBQSxnQkFBQSxHQUVBLEVBQUEsZ0JBQUEsRUFBQSxlQUNBLEVBQUEsRUFBQSxnQkFFQSxFQUFBLFFBQ0EsTUFBQSxFQUFBLGVBQ0EsWUFBQSxFQUFBLGVBQ0EsS0FBQSxFQUFBLGVBQ0EsVUFBQSxFQUFBLGVBQ0EsYUFBQSxFQUFBLGVBQ0EsVUFBQSxFQUFBLGVBQ0EsVUFBQSxJQUdBLEVBQUEsTUFBQSxFQUNBLEVBQUEsTUFBQSxFQUNBLEVBQUEsaUJBQUEsRUFDQSxFQUFBLFdBQUEsUUFBQSxPQUFBLFFBQ0EsRUFBQSxlQUFBLFlBQ0EsRUFBQSxvQkFBQSxFQUNBLEVBQUEsdUJBQUEsRUFDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSxlQUNBLEVBQUEsY0FBQSxRQUFBLEtBQUEsRUFDQSxJQUFBLEdBQUEsRUFBQSxNQUFBLEtBQUEsTUFBQSxJQUNBLEdBQUEsUUFBQSxFQUFBLE1BQUEsRUFBQSxFQUFBLE9BQUEsR0FBQSxLQUFBLEtBQ0EsS0FBQSxFQUFBLFVBQ0EsRUFBQSxTQUFBLEtBRUEsRUFBQSxZQUNBLEVBQUEsU0FBQSxFQUFBLFNBQ0EsRUFBQSxlQUFBLEVBQUEsZUFDQSxFQUFBLGFBQUEsV0FDQSxHQUFBLEdBQUEsRUFBQSxVQUFBLE9BQ0EsR0FBQSxRQUFBLE9BQUEsRUFBQSxNQUFBLEVBQUEsY0FDQSxPQUFBLElBQUEsR0FFQSxFQUFBLGdCQUFBLEVBQUEsZ0JBRUEsRUFBQSxVQUFBLFdBQ0EsR0FBQSxFQUFBLGVBRUEsR0FEQSxFQUFBLE1BQUEsS0FBQSxFQUFBLFFBQUEsRUFBQSxNQUFBLEtBQUEsU0FDQSxTQUFBLEVBQUEsT0FBQSxDQUNBLEdBQUEsR0FBQSxFQUFBLFFBQUEsTUFBQSxLQUNBLEVBQUEsRUFBQSxNQUFBLEVBQUEsRUFBQSxPQUFBLEdBQUEsS0FBQSxJQUNBLE1BQUEsSUFDQSxHQUFBLEtBRUEsRUFBQSxLQUFBLHNCQUFBLEVBQUEsT0FBQSxLQUFBLFdBQ0EsRUFBQSxLQUFBLHNCQUFBLEVBQUEsRUFBQSxNQUFBLE1BQ0EsRUFBQSxjQUFBLFFBQUEsS0FBQSxFQUFBLFFBQ0EsU0FBQSxHQUNBLEVBQUEsZUFBQSxFQUFBLFlBR0EsR0FBQSxNQUFBLE9BQUEsRUFBQSxjQUFBLE9BQ0EsRUFBQSxNQUFBLGFBQUEsRUFBQSxjQUFBLE1BRUEsRUFBQSxJQUFBLHNCQUFBLEVBQUEsT0FBQSxLQUFBLFdBQ0EsRUFBQSxjQUFBLFFBQUEsS0FBQSxFQUFBLFFBQ0EsU0FBQSxHQUNBLEVBQUEsZUFBQSxFQUFBLFNBS0EsRUFBQSxZQUFBLFdBQ0EsTUFBQSxHQUFBLFVBQUEsU0FBQSxFQUFBLHVCQUdBLEVBQUEsU0FBQSxXQUNBLEVBQUEsZ0JBQ0EsRUFBQSxZQUNBLEVBQUEsa0JBQUEsT0FBQSxLQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxPQUNBLEdBQUEsZUFBQSxXQUNBLEVBQUEsaUJBQUEsV0FDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSx1QkFBQSxFQUNBLEVBQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxPQUFBLFFBQUEsU0FBQSxHQUNBLEVBQUEsSUFBQSxFQUFBLFNBQUEsSUFBQSxFQUFBLElBQUEsRUFBQSxVQUdBLElBQUEsSUFDQSxhQUFBLEtBQUEsRUFBQSxNQUFBLE9BQ0EsUUFBQSxFQUNBLGlCQUFBLEVBQUEsaUJBRUEsR0FBQSxLQUFBLG1CQUFBLEdBQUEsS0FBQSxTQUFBLEdBQ0EsRUFBQSxXQUFBLEVBQUEsS0FBQSxLQUNBLFNBQUEsR0FDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSx1QkFBQSxFQUNBLEVBQUEsZUFBQSxFQUFBLFNBRUEsU0FBQSxHQUNBLEVBQUEsZUFBQSxFQUFBLFVBSUEsRUFBQSxXQUFBLFNBQUEsR0FDQSxFQUFBLElBQUEsMEJBQUEsR0FBQSxLQUFBLFNBQUEsR0FDQSxHQUFBLGFBQUEsRUFBQSxLQUFBLE9BQ0EsRUFBQSx1QkFBQSxFQUNBLEVBQUEsV0FDQSxFQUFBLFdBQUEsSUFDQSxTQUNBLENBQ0EsR0FBQSxHQUFBLEVBQUEsS0FBQSxPQUNBLEdBQUEsUUFBQSxFQUNBLEVBQUEsUUFBQSxHQUFBLEVBQ0EsRUFBQSxnQkFBQSxHQUNBLEVBQUEsdUJBQUEsRUFDQSxFQUFBLG1CQUFBLEVBQUEscUJBQUEsS0FFQSxTQUFBLEdBQ0Esc0JBQUEsRUFBQSxLQUFBLFFBQ0EsRUFBQSxXQUNBLEVBQUEsV0FBQSxJQUNBLE1BRUEsRUFBQSx1QkFBQSxFQUNBLEVBQUEsZUFBQSxFQUFBLFVBSUEsRUFBQSxxQkFBQSxTQUFBLEdBQ0EsR0FBQSxJQUFBLENBUUEsT0FQQSxHQUFBLFFBQUEsU0FBQSxHQUNBLEVBQUEsTUFBQSxRQUFBLFNBQUEsR0FDQSxlQUFBLEVBQUEsUUFBQSxZQUFBLEVBQUEsUUFBQSxpQkFBQSxFQUFBLFNBQ0EsR0FBQSxPQUlBLEdBRUEsRUFBQSxhQUFBLFNBQUEsRUFBQSxHQUNBLE1BQUEseUJBQUEsRUFBQSxJQUFBLEdBRUEsRUFBQSxnQkFBQSxXQUNBLE1BQUEsR0FBQSwyQkFBQSxJQUVBLEVBQUEscUJBQUEsV0FDQSxNQUFBLEdBQUEscUJBQUEsRUFBQSx3QkFFQSxFQUFBLG1CQUFBLFdBQ0EsTUFBQSxHQUFBLG1CQUNBLEVBQUEsc0JBQ0EsRUFBQSxtQkFDQSxFQUFBLGFBQUEsSUFHQSxFQUFBLGdCQUFBLFNBQUEsR0FDQSxFQUFBLGdCQUNBLEVBQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxNQUFBLFFBQUEsU0FBQSxHQUNBLFlBQUEsRUFBQSxRQUNBLEVBQUEsYUFBQSxNQUFBLEtBQUEsRUFBQSxZQU1BLEVBQUEsZ0JBQUEsV0FDQSxNQUFBLFVBQUEsRUFBQSxjQUFBLEVBQUEsYUFBQSxPQUFBLEdBRUEsRUFBQSx5QkFBQSxXQUNBLE1BQUEsR0FBQSx5QkFDQSxFQUFBLHNCQUNBLEVBQUEsbUJBQ0EsRUFBQSxhQUFBLFNBR0EsRUFBQSx3QkFBQSxFQUFBLHdCQUNBLEVBQUEsV0FBQSxTQUFBLEdBQ0EsRUFBQSxVQUVBLEVBQUEsbUJBQUEsU0FBQSxHQUNBLEVBQUEsTUFBQSxNQUFBLEdBQUEsUUFBQSxTQUFBLGNBQUEsTUFFQSxFQUFBLFlBQUEsV0FDQSxFQUFBLE1BQUEsUUFBQSxLQUFBLEVBQUEsZUFDQSxFQUFBLFVBQUEsZ0JBRUEsRUFBQSxlQUFBLFdBQ0EsT0FBQSxRQUFBLE9BQUEsRUFBQSxNQUFBLEVBQUEsZ0JBRUEsRUFBQSxlQUFBLFdBQ0EsTUFBQSxRQUFBLEVBQUEsU0FBQSxFQUFBLHVCQUdBLEVBQUEsWUFBQSxXQUNBLEdBQUEsR0FBQSxFQUFBLFFBQUEsRUFBQSxNQUFBLEtBQUEsUUFDQSxHQUFBLFlBQUEsSUFFQSxFQUFBLGFBQUEsRUFBQSxrQkFFQSxFQUFBLGlCQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxJQUFBLGlCQUNBLE9BQUEsVUFBQSxHQUFBLEtBQUEsRUFDQSxFQUFBLG1CQUFBLEdBRUEsRUFBQSxPQUFBLFdBQUEsR0FBQSxLQUFBLG9CQUFBLEVBQUEsWUFJQSxFQUFBLGVBQUEsRUFBQSxrQkM5TkEsUUFBQSxPQUFBLG9CQUNBLFdBQUEscUJBQUEsU0FBQSxTQUFBLFlBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsRUFBQSxVQUFBLFdBQ0EsRUFBQSxNQUNBLFlBQUEsaUNBQ0EsV0FBQSxjQUNBLFNBQ0EsS0FBQSxXQUNBLGNBS0EsRUFBQSxtQkFBQSxXQUNBLEVBQUEsc0JBRUEsRUFBQSxTQUFBLFdBQ0EsR0FBQSxHQUFBLEVBQUEsTUFDQSxPQUFBLEtBQUEsRUFBQSxRQUFBLHVCQUNBLGFBQ0EsSUFBQSxFQUFBLFFBQUEsc0JBQ0EsWUFDQSxJQUFBLEVBQUEsUUFBQSxxQkFDQSxhQUNBLElBQUEsRUFBQSxRQUFBLGtCQUNBLFVBQ0EsSUFBQSxFQUFBLFFBQUEsZ0JBQ0EsUUFDQSxJQUFBLEVBQUEsUUFBQSx1QkFDQSxVQUNBLElBQUEsRUFBQSxRQUFBLGVBQ0EsT0FFQSxPQ2xDQSxRQUFBLE9BQUEsaUJBQ0EsV0FBQSxZQUFBLFNBQUEsZUNEQSxRQUFBLE9BQUEsbUJBQ0EsV0FBQSxjQUFBLFNBQUEsU0FBQSxRQUFBLFlBQUEsV0FBQSxlQUFBLFNBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEdBRUEsRUFBQSxtQkFBQSxXQUNBLE1BQUEsR0FBQSxNQUNBLFlBQUEsK0NBQ0EsV0FBQSxxQkFDQSxTQUNBLEtBQUEsV0FDQSxjQU1BLEVBQUEsV0FBQSxXQUNBLEdBQUEsR0FBQSxFQUFBLG9CQUNBLFVBQUEsR0FDQSxFQUFBLE9BQUEsS0FBQSxTQUFBLEdBQ0EsR0FBQSxLQUNBLEdBQUEsS0FBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLE1BQUEsS0FBQSxFQUFBLEtBQUEsa0JBRUEsRUFBQSxRQUFBLFFBQUEsU0FBQSxHQUNBLEVBQUEsTUFBQSxLQUFBLEVBQUEsU0FFQSxFQUFBLDJCQUFBLEdBQUEsT0FBQSxLQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxRQUNBLEVBQUEsRUFBQSxNQUNBLEdBQUEsSUFBQSxxQkFBQSxLQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxJQUNBLEdBQUEsU0FDQSxXQUFBLEVBQ0EsUUFBQSxFQUNBLGlCQUFBLEdBRUEsUUFBQSxHQUNBLEVBQUEsSUFBQSxFQUFBLFNBQ0EsRUFBQSxTQUFBLEdBRUEsRUFBQSxTQUFBLFNBT0EsRUFBQSxJQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsd0JBQ0EsR0FBQSxXQUFBLEdBQ0EsRUFBQSxvQkFBQSxFQUNBLEVBQUEsb0JBQUEsRUFDQSxFQUFBLEtBQUEsbUJBQUEsR0FBQSxLQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsRUFBQSxJQUNBLFFBQUEsRUFBQSxRQUNBLEVBQUEsV0FBQSxFQUFBLEVBQUEsWUFDQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxXQUFBLEVBQUEsS0FDQSxXQUFBLEVBQUEsUUFDQSxFQUFBLFdBQUEsRUFBQSxFQUFBLFlBQ0EsRUFBQSx1QkFBQSxHQUVBLEVBQUEsZUFBQSxJQUVBLFNBQUEsR0FDQSxFQUFBLHVCQUFBLEVBQ0EsRUFBQSxvQkFBQSxFQUNBLEVBQUEsZUFBQSxFQUFBLFNBR0EsRUFBQSxXQUFBLFNBQUEsR0FDQSxFQUFBLElBQUEsMEJBQUEsR0FBQSxLQUFBLFNBQUEsR0FDQSxFQUFBLFFBQUEsRUFBQSxLQUNBLGFBQUEsRUFBQSxRQUFBLFFBQ0EsRUFBQSxvQkFBQSxFQUNBLEVBQUEsV0FDQSxFQUFBLFdBQUEsSUFDQSxPQUVBLEVBQUEsb0JBQUEsR0FFQSxTQUFBLEdBQ0Esc0JBQUEsRUFBQSxLQUFBLFFBQ0EsRUFBQSxXQUNBLEVBQUEsV0FBQSxJQUNBLE9BRUEsRUFBQSxvQkFBQSxFQUNBLEVBQUEsZUFBQSxFQUFBLFVBSUEsRUFBQSxtQkFBQSxXQUNBLE1BQUEsR0FBQSxtQkFDQSxFQUFBLHNCQUNBLEVBQUEsbUJBQ0EsRUFBQSxhQUFBLElBR0EsRUFBQSx5QkFBQSxXQUNBLE1BQUEsR0FBQSxzQkFDQSw2QkFFQSwyQkFHQSxFQUFBLHFCQUFBLFdBQ0EsTUFBQSxHQUFBLHFCQUFBLEVBQUEsd0JBRUEsRUFBQSxLQUFBLFdBQ0EsRUFBQSx1QkFBQSxFQUNBLEVBQUEsb0JBQUEsRUFDQSxFQUFBLG9CQUFBLEVBQ0EsRUFBQSxnQkFDQSxFQUFBLFdBQUEsR0FDQSxFQUFBLGFBQ0EsRUFBQSxTQUFBLEdBRUEsRUFBQSxPQUFBLFdBQ0EsTUFBQSxHQUFBLFdBQUEsTUFBQSxFQUFBLE9BQUEsSUFBQSxFQUFBLE9BQUEsb0JBRUEsRUFBQSxVQUVBLFdBQUEsc0JBQUEsU0FBQSxRQUFBLFNBQUEsaUJBQUEsZUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLE9BQUEsUUFBQSxZQUNBLEVBQUEsV0FBQSxFQUFBLElBQ0EsRUFBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLFFBQUEsRUFBQSxJQUVBLEVBQUEscUJBQUEsV0FDQSxFQUFBLFFBQUEsV0FFQSxFQUFBLGlCQUFBLFdBQ0EsR0FBQSxJQUFBLFFBQUEsV0FDQSxTQUFBLFFBQUEsRUFBQSxNQUFBLEtBQUEsU0FBQSxHQUNBLEVBQUEsVUFDQSxFQUFBLEtBQUEsTUFBQSxLQUFBLEVBQUEsU0FBQSxFQUFBLFNBR0EsUUFBQSxRQUFBLEVBQUEsTUFBQSxRQUFBLFNBQUEsR0FDQSxFQUFBLFVBQ0EsRUFBQSxRQUFBLE1BQUEsS0FBQSxFQUFBLFNBQUEsRUFBQSxLQUFBLGFBR0EsRUFBQSxNQUFBLElBRUEsRUFBQSxlQUFBLFdBQ0EsTUFBQSxLQUFBLEVBQUEsVUFFQSxFQUFBLFlBQUEsV0FDQSxHQUFBLElBQUEsQ0FhQSxPQVpBLFNBQUEsUUFBQSxFQUFBLE1BQUEsS0FBQSxTQUFBLEdBQ0EsRUFBQSxXQUNBLEdBQUEsS0FHQSxHQUNBLFFBQUEsUUFBQSxFQUFBLE1BQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxXQUNBLEdBQUEsS0FJQSxNQUdBLFdBQUEsb0JBQUEsU0FBQSxpQkFBQSxlQUFBLE9BQUEsYUFBQSxTQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsR0FDQSxFQUFBLFFBQUEsRUFBQSxRQUNBLEVBQUEsY0FDQSxFQUFBLFVBQUEsV0FDQSxFQUFBLFFBQUEsUUFBQSxTQUFBLEdBQ0EsRUFBQSxPQUFBLFFBQUEsU0FBQSxHQUNBLEdBQUEsU0FBQSxFQUFBLE9BQUEsS0FBQSxFQUFBLE1BQ0EsRUFBQSxVQUFBLE1BQ0EsQ0FDQSxFQUFBLFVBQUEsQ0FDQSxLQUNBLEVBQUEsTUFBQSxFQUFBLElBQUEsRUFBQSxTQUFBLElBQUEsRUFBQSxLQUNBLE1BQUEsR0FDQSxRQUFBLElBQUEsNkJBQUEsRUFBQSxTQUFBLElBQUEsRUFBQSxLQUNBLFFBQUEsSUFBQSxFQUFBLGdCQU1BLEVBQUEsV0FBQSxTQUFBLEdBQ0EsTUFBQSxHQUNBLEVBQUEsT0FBQSxHQUVBLEdBR0EsRUFBQSxVQUFBLFNBQUEsR0FDQSxNQUFBLFVBQUEsRUFBQSxRQUFBLEVBQUEsT0FBQSxPQUFBLEdBRUEsRUFBQSxHQUFBLFdBQ0EsRUFBQSxPQUFBLE9BQUEsTUFBQSxRQUFBLEVBQUEsV0FFQSxFQUFBLE9BQUEsV0FDQSxFQUFBLFFBQUEsV0FFQSxFQUFBLFdBQUEsV0FDQSxNQUFBLElBRUEsRUFBQSxPQUFBLFdBQ0EsRUFBQSxPQUFBLE9BQUEsTUFBQSxRQUFBLEVBQUEsV0FFQSxFQUFBLGVBQUEsU0FBQSxFQUFBLEdBQ0EsR0FBQSxHQUFBLEVBQUEsT0FBQSxHQUFBLGNBQUEsRUFBQSxNQUFBLEdBQ0EsRUFBQSxFQUFBLE9BQUEsR0FBQSxjQUFBLEVBQUEsTUFBQSxFQUNBLE9BQUEsR0FBQSxHQUVBLEVBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnc3Rvcmllc01vZHVsZScsIFtcclxuICAgICduZ1JvdXRlJyxcclxuICAgICduZ0Nvb2tpZXMnLFxyXG4gICAgJ3VpLmJvb3RzdHJhcCcsXHJcbiAgICAndWkuc29ydGFibGUnLFxyXG4gICAgJ2NvbmZpZ01vZHVsZScsXHJcbiAgICAnYm9keU1vZHVsZScsXHJcbiAgICAndG9wTWVudU1vZHVsZScsXHJcbiAgICAnc3RvcnlNb2R1bGUnLFxyXG4gICAgJ2NvbXBvc2l0ZUNsYXNzZXNNb2R1bGUnLFxyXG4gICAgJ2NvbXBvc2l0ZXNNb2R1bGUnLFxyXG4gICAgJ3J1bm5lck1vZHVsZScsXHJcbiAgICAnbG9naW5Nb2R1bGUnLFxyXG4gICAgJ3RvdXJNb2R1bGUnXHJcbl0pXHJcbiAgICAuc2VydmljZSgnVGNCZGRTZXJ2aWNlJywgZnVuY3Rpb24oJG1vZGFsLCAkaHR0cCwgJGxvY2F0aW9uLCAkcSkge1xyXG4gICAgICAgIHRoaXMub3BlbkNvbXBvc2l0ZUNsYXNzID0gZnVuY3Rpb24oY29tcG9zaXRlU3RlcFRleHQpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9jb21wb3NpdGVDbGFzc2VzL2NvbXBvc2l0ZUNsYXNzZXMudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjb21wb3NpdGVDbGFzc2VzQ3RybCcsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcG9zaXRlQ2xhc3NlczogZnVuY3Rpb24oJHJvdXRlLCAkaHR0cCwgJG1vZGFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmdldEpzb24oJy9ncm9vdnlDb21wb3NpdGVzJywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgY29tcG9zaXRlU3RlcFRleHQ6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcG9zaXRlU3RlcFRleHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMubmV3Q29sbGVjdGlvbkl0ZW0gPSBmdW5jdGlvbihldmVudCwgY29sbGVjdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoZXZlbnQud2hpY2ggPT09IDEzKSB7XHJcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLnB1c2goe30pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnJlbW92ZUNvbGxlY3Rpb25FbGVtZW50ID0gZnVuY3Rpb24oY29sbGVjdGlvbiwgaW5kZXgpIHtcclxuICAgICAgICAgICAgY29sbGVjdGlvbi5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5idXR0b25Dc3NDbGFzcyA9IGZ1bmN0aW9uKG5nTW9kZWxDb250cm9sbGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAnYnRuLXN1Y2Nlc3MnOiBuZ01vZGVsQ29udHJvbGxlci4kdmFsaWQsXHJcbiAgICAgICAgICAgICAgICAnYnRuLWRhbmdlcic6IG5nTW9kZWxDb250cm9sbGVyLiRpbnZhbGlkXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldFJ1bm5lclByb2dyZXNzQ3NzID0gZnVuY3Rpb24oaW5Qcm9ncmVzcykge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgJ3Byb2dyZXNzIHByb2dyZXNzLXN0cmlwZWQgYWN0aXZlJzogaW5Qcm9ncmVzcyxcclxuICAgICAgICAgICAgICAgICdwcm9ncmVzcyc6ICFpblByb2dyZXNzXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldFN0b3J5UnVubmVyU3RhdHVzVGV4dCA9IGZ1bmN0aW9uKGluUHJvZ3Jlc3MsIHN1Y2Nlc3MsIHBlbmRpbmdTdGVwc0xlbmd0aCkge1xyXG4gICAgICAgICAgICBpZiAoaW5Qcm9ncmVzcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdTdG9yeSBydW4gaXMgaW4gcHJvZ3Jlc3MnO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nU3RlcHNMZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdTdG9yeSBydW4gd2FzIHN1Y2Nlc3NmdWwgd2l0aCAnICsgcGVuZGluZ1N0ZXBzTGVuZ3RoICsgJyBwZW5kaW5nIHN0ZXBzJztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdTdG9yeSBydW4gd2FzIHN1Y2Nlc3NmdWwnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdTdG9yeSBydW4gZmFpbGVkJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5nZXRSdW5uZXJTdGF0dXNDc3MgPSBmdW5jdGlvbihpblByb2dyZXNzLCBzdWNjZXNzLCBwZW5kaW5nU3RlcHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICdwcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyLWluZm8nOiBpblByb2dyZXNzLFxyXG4gICAgICAgICAgICAgICAgJ3Byb2dyZXNzLWJhciBwcm9ncmVzcy1iYXItd2FybmluZyc6ICFpblByb2dyZXNzICYmIHN1Y2Nlc3MgJiYgcGVuZGluZ1N0ZXBzLFxyXG4gICAgICAgICAgICAgICAgJ3Byb2dyZXNzLWJhciBwcm9ncmVzcy1iYXItc3VjY2Vzcyc6ICFpblByb2dyZXNzICYmIHN1Y2Nlc3MgJiYgIXBlbmRpbmdTdGVwcyxcclxuICAgICAgICAgICAgICAgICdwcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyLWRhbmdlcic6ICFpblByb2dyZXNzICYmICFzdWNjZXNzXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm9wZW5SdW5uZXJQYXJhbWV0ZXJzTW9kYWwgPSBmdW5jdGlvbihzaG93R2V0QXBpKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgcmV0dXJuICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2Fzc2V0cy9odG1sL3J1bm5lci9ydW5uZXJQYXJhbXMudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdydW5uZXJQYXJhbXNDdHJsJyxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbigkcm91dGUsICRodHRwLCAkbW9kYWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZ2V0SnNvbignL3N0ZXBzL2NsYXNzZXMuanNvbicsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc2hvd0dldEFwaTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzaG93R2V0QXBpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLm9wZW5EaXIgPSBmdW5jdGlvbigkc2NvcGUsIHBhdGgpIHtcclxuICAgICAgICAgICAgaWYgKHBhdGggPT09ICcuLicpIHtcclxuICAgICAgICAgICAgICAgIHZhciBkaXJzID0gJHNjb3BlLnJvb3RQYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucm9vdFBhdGggPSBkaXJzLnNsaWNlKDAsIGRpcnMubGVuZ3RoIC0gMikuam9pbignLycpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5yb290UGF0aCAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucm9vdFBhdGggKz0gJy8nO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRTdG9yaWVzKCRzY29wZSwgJycpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRTdG9yaWVzKCRzY29wZSwgcGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0U3RvcmllcyA9IGZ1bmN0aW9uICgkc2NvcGUsIHBhdGgpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLnJvb3RQYXRoID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yb290UGF0aCA9ICcnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICRodHRwLmdldCgnL3N0b3JpZXMvbGlzdC5qc29uP3BhdGg9JyArICRzY29wZS5yb290UGF0aCArIHBhdGgpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5maWxlcyA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgICAgICAgICBpZiAocGF0aCAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucm9vdFBhdGggKz0gcGF0aCArICcvJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zdGVwVGV4dFBhdHRlcm4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICgvXihHaXZlbnxXaGVufFRoZW4pIC4rJC8pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5vcGVuQ29uZmlybWF0aW9uTW9kYWwgPSBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9jb25maXJtYXRpb25Nb2RhbC50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ21vZGFsQ3RybCcsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmNsYXNzTmFtZVBhdHRlcm4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICgvXlthLXpBLVpfJF1bYS16QS1aXFxkXyRdKiQvKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuY3NzQ2xhc3MgPSBmdW5jdGlvbihuZ01vZGVsQ29udHJvbGxlcikge1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgJ2hhcy1lcnJvcic6IG5nTW9kZWxDb250cm9sbGVyLiRpbnZhbGlkLFxyXG4gICAgICAgICAgICAgICAgJ2hhcy1zdWNjZXNzJzogbmdNb2RlbENvbnRyb2xsZXIuJHZhbGlkICYmIG5nTW9kZWxDb250cm9sbGVyLiRkaXJ0eVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgdGhpcy5kZWxldGVTdG9yeSA9IGZ1bmN0aW9uKHBhdGgpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xyXG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9IHtzdGF0dXM6ICdEZWxldGUgU3RvcnknLCBtZXNzYWdlOiAnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIHN0b3J5Pyd9O1xyXG4gICAgICAgICAgICB2YXIgb2tNb2RhbCA9IHRoaXMub3BlbkNvbmZpcm1hdGlvbk1vZGFsKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICBva01vZGFsLnJlc3VsdC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZGVsZXRlKCcvc3Rvcmllcy9zdG9yeS8nICsgcGF0aCkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3BhZ2Uvc3Rvcmllcy9uZXcvJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSgnT0snKTtcclxuICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5vcGVuRXJyb3JNb2RhbChyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoJ05PSycpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KCdOT0snKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5nZXRKc29uID0gZnVuY3Rpb24odXJsLCBjYWNoZVR5cGUpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KHVybCwge2NhY2hlOiBjYWNoZVR5cGV9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5vcGVuRXJyb3JNb2RhbCA9IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvZXJyb3JNb2RhbC50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ21vZGFsQ3RybCcsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgIH0pXHJcbiAgICAuY29udHJvbGxlcignbW9kYWxDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkbW9kYWxJbnN0YW5jZSwgZGF0YSkge1xyXG4gICAgICAgICRzY29wZS5kYXRhID0gZGF0YTtcclxuICAgICAgICAkc2NvcGUub2sgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKCdvaycpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuZGlzbWlzcygnY2FuY2VsJyk7XHJcbiAgICAgICAgfTtcclxuICAgIH0pXHJcbiAgICAuY29udHJvbGxlcignc3Rvcmllc0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbW9kYWwsICRtb2RhbEluc3RhbmNlLCAkbG9jYXRpb24sICRxLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICBUY0JkZFNlcnZpY2UuZ2V0U3Rvcmllcygkc2NvcGUsICcnKTtcclxuICAgICAgICAkc2NvcGUub3BlbkRpciA9IGZ1bmN0aW9uKHBhdGgpIHtcclxuICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5EaXIoJHNjb3BlLCBwYXRoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnZpZXdTdG9yeVVybCA9IGZ1bmN0aW9uKG5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcvcGFnZS9zdG9yaWVzL3ZpZXcvJyArICRzY29wZS5yb290UGF0aCArIG5hbWU7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuYWxsb3dUb1ByZXZEaXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5yb290UGF0aCAhPT0gJyc7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUuZGVsZXRlU3RvcnkgPSBmdW5jdGlvbihuYW1lLCBpbmRleCkge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9ICRzY29wZS5yb290UGF0aCArIG5hbWUgKyAnLnN0b3J5JztcclxuICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLmRlbGV0ZVN0b3J5KHBhdGgpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsZXMuc3Rvcmllcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5jcmVhdGVEaXJlY3RvcnkgPSBmdW5jdGlvbihwYXRoKSB7XHJcbiAgICAgICAgICAgIHZhciBqc29uID0gJ3tcInBhdGhcIjogXCInICsgJHNjb3BlLnJvb3RQYXRoICsgcGF0aCArICdcIn0nO1xyXG4gICAgICAgICAgICAkaHR0cC5wb3N0KCcvc3Rvcmllcy9kaXIuanNvbicsIGpzb24pLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlsZXMuZGlycy5wdXNoKHtuYW1lOiBwYXRofSk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICBUY0JkZFNlcnZpY2Uub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2NvbmZpZ01vZHVsZScsIFtdKVxyXG4gICAgLmNvbmZpZyhmdW5jdGlvbigkcm91dGVQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcclxuICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XHJcbiAgICAgICAgJHJvdXRlUHJvdmlkZXJcclxuICAgICAgICAgICAgLndoZW4oJy9wYWdlL3RvdXIvJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvdG91ci90b3VyLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAndG91ckN0cmwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC53aGVuKCcvcGFnZS9zdG9yaWVzL25ldy8nLCB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9zdG9yeS9zdG9yeS50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3N0b3J5Q3RybCcsXHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBzdG9yeTogZnVuY3Rpb24oJGh0dHAsICRtb2RhbCwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0SnNvbignL3N0b3JpZXMvc3RvcnkuanNvbicsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIHN0ZXBzOiBmdW5jdGlvbigkaHR0cCwgJG1vZGFsLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRKc29uKCcvc3RlcHMvbGlzdC5qc29uJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBncm9vdnlDb21wb3NpdGVzOiBmdW5jdGlvbigkaHR0cCwgJG1vZGFsLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRKc29uKCcvZ3Jvb3Z5Q29tcG9zaXRlcycsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLndoZW4oJy9wYWdlL3N0b3JpZXMvbmV3LzpwYXRoKicsIHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2Fzc2V0cy9odG1sL3N0b3J5L3N0b3J5LnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc3RvcnlDdHJsJyxcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0b3J5OiBmdW5jdGlvbigkcm91dGUsICRodHRwLCAkbW9kYWwsIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldEpzb24oJy9zdG9yaWVzL3N0b3J5Lmpzb24/cGF0aD0nICsgJHJvdXRlLmN1cnJlbnQucGFyYW1zLnBhdGggKyAnLnN0b3J5JywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3RlcHM6IGZ1bmN0aW9uKCRodHRwLCAkbW9kYWwsIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldEpzb24oJy9zdGVwcy9saXN0Lmpzb24nLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGdyb292eUNvbXBvc2l0ZXM6IGZ1bmN0aW9uKCRodHRwLCAkbW9kYWwsIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldEpzb24oJy9ncm9vdnlDb21wb3NpdGVzJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAud2hlbignL3BhZ2Uvc3Rvcmllcy92aWV3LzpwYXRoKicsIHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2Fzc2V0cy9odG1sL3N0b3J5L3N0b3J5LnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc3RvcnlDdHJsJyxcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0b3J5OiBmdW5jdGlvbigkcm91dGUsICRodHRwLCAkbW9kYWwsIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldEpzb24oJy9zdG9yaWVzL3N0b3J5Lmpzb24/cGF0aD0nICsgJHJvdXRlLmN1cnJlbnQucGFyYW1zLnBhdGggKyAnLnN0b3J5JywgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgc3RlcHM6IGZ1bmN0aW9uKCRodHRwLCAkbW9kYWwsIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldEpzb24oJy9zdGVwcy9saXN0Lmpzb24nLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGdyb292eUNvbXBvc2l0ZXM6IGZ1bmN0aW9uKCRodHRwLCAkbW9kYWwsIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldEpzb24oJy9ncm9vdnlDb21wb3NpdGVzJywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlbG9hZE9uU2VhcmNoOiBmYWxzZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIC53aGVuKCcvcGFnZS9jb21wb3NpdGVzLzpjbGFzc05hbWUqJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvY29tcG9zaXRlcy9jb21wb3NpdGVzLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnY29tcG9zaXRlc0N0cmwnLFxyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcG9zaXRlc0NsYXNzOiBmdW5jdGlvbigkcm91dGUsICRodHRwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWxlTmFtZSA9ICRyb3V0ZS5jdXJyZW50LnBhcmFtcy5jbGFzc05hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSAnL2dyb292eUNvbXBvc2l0ZXMvJyArIGZpbGVOYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KHVybCwge2NhY2hlOiBmYWxzZX0pLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSBmaWxlTmFtZS5zdWJzdHJpbmcoMCwgZmlsZU5hbWUubGFzdEluZGV4T2YoJy4nKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzOiBjbGFzc05hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9zaXRlczpbe3N0ZXBUZXh0OiAnJywgY29tcG9zaXRlU3RlcHM6IFt7fV19XSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc05ldzogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBzdGVwczogZnVuY3Rpb24oJGh0dHAsICRtb2RhbCwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0SnNvbignL3N0ZXBzL2xpc3QuanNvbicsIGZhbHNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC53aGVuKCcvcGFnZS9ydW5uZXIvJywge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYXNzZXRzL2h0bWwvcnVubmVyL3J1bm5lci50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3J1bm5lckN0cmwnLFxyXG4gICAgICAgICAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZnVuY3Rpb24oJHJvdXRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7cmVwb3J0c1BhdGg6ICRyb3V0ZS5jdXJyZW50LnBhcmFtcy5wYXRofTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC53aGVuKCcvcGFnZS9sb2dpbi8nLCB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9sb2dpbi9sb2dpbi50bXBsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2xvZ2luQ3RybCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLndoZW4oJy9wYWdlL2xvZ2luV2VsY29tZS8nLCB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9sb2dpbi9sb2dpbldlbGNvbWUudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbldlbGNvbWVDdHJsJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAub3RoZXJ3aXNlKHtcclxuICAgICAgICAgICAgICAgIHJlZGlyZWN0VG86ICcvcGFnZS90b3VyJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYm9keU1vZHVsZScsIFsnbmdKb3lSaWRlJ10pXHJcbiAgICAuY29udHJvbGxlcignYm9keUN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlKSB7XHJcbiAgICAgICAgJHNjb3BlLnN0YXJ0Sm95UmlkZUZsYWcgPSBmYWxzZTtcclxuICAgICAgICAkc2NvcGUuY29uZmlnSm95UmlkZSA9IFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogJ2VsZW1lbnQnLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICcjbWVudScsXHJcbiAgICAgICAgICAgICAgICBoZWFkaW5nOiAnTmF2aWdhdGlvbicsXHJcbiAgICAgICAgICAgICAgICB0ZXh0OiAnVGhlIG1haW4gcHVycG9zZSBvZiB0aGUgbmF2aWdhdGlvbiBtZW51IGlzIHRvIHByb3ZpZGUgcXVpY2sgbGlua3MgdG8gbWFqb3Igc2VjdGlvbnMgb2YgdGhlIGFwcGxpY2F0aW9uIGFzIHdlbGwgYXMgdGhlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBjdXJyZW50IGxvY2F0aW9uLicsXHJcbiAgICAgICAgICAgICAgICBwbGFjZW1lbnQ6ICdib3R0b20nLFxyXG4gICAgICAgICAgICAgICAgc2Nyb2xsOiB0cnVlXHJcbiAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdlbGVtZW50JyxcclxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnI2Jyb3dzZVN0b3JpZXMnLFxyXG4gICAgICAgICAgICAgICAgaGVhZGluZzogJ0Jyb3dzZSBTdG9yaWVzJyxcclxuICAgICAgICAgICAgICAgIHRleHQ6ICdEaXNwbGF5cyB0aGUgZGlhbG9nIHRoYXQgY2FuIGJlIHVzZWQgdG8gb3BlbiBhbiBleGlzdGluZyBvciBjcmVhdGUgYSBuZXcgc3RvcnkuJyxcclxuICAgICAgICAgICAgICAgIHBsYWNlbWVudDogJ2JvdHRvbScsXHJcbiAgICAgICAgICAgICAgICBzY3JvbGw6IHRydWVcclxuICAgICAgICAgICAgfSwge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogJ2VsZW1lbnQnLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICcjYnJvd3NlQ29tcG9zaXRlcycsXHJcbiAgICAgICAgICAgICAgICBoZWFkaW5nOiAnQnJvd3NlIENvbXBvc2l0ZXMnLFxyXG4gICAgICAgICAgICAgICAgdGV4dDogJ0Rpc3BsYXlzIHRoZSBkaWFsb2cgdGhhdCBjYW4gYmUgdXNlZCB0byBvcGVuIGFuIGV4aXN0aW5nIG9yIGNyZWF0ZSBhIG5ldyBjb21wb3NpdGVzIGNsYXNzLicsXHJcbiAgICAgICAgICAgICAgICBwbGFjZW1lbnQ6ICdib3R0b20nLFxyXG4gICAgICAgICAgICAgICAgc2Nyb2xsOiB0cnVlXHJcbiAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdlbGVtZW50JyxcclxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnI3J1bm5lcicsXHJcbiAgICAgICAgICAgICAgICBoZWFkaW5nOiAnUnVuIFN0b3JpZXMnLFxyXG4gICAgICAgICAgICAgICAgdGV4dDogJ0Rpc3BsYXlzIHRoZSBkaWFsb2cgdGhhdCBjYW4gYmUgdXNlZCB0byBzZWxlY3Qgb25lIG9yIG1vcmUgc3RvcmllcyBhbmQgZGlyZWN0b3JpZXMgd2l0aCBzdG9yaWVzIHRoYXQgd2lsbCBiZSBydW4uJyxcclxuICAgICAgICAgICAgICAgIHBsYWNlbWVudDogJ2JvdHRvbScsXHJcbiAgICAgICAgICAgICAgICBzY3JvbGw6IHRydWVcclxuLy8gICAgICAgICAgICB9LCB7XHJcbi8vICAgICAgICAgICAgICAgIHR5cGU6ICdlbGVtZW50JyxcclxuLy8gICAgICAgICAgICAgICAgc2VsZWN0b3I6ICcjbWVudScsXHJcbi8vICAgICAgICAgICAgICAgIGhlYWRpbmc6ICdOYXZpZ2F0aW9uJyxcclxuLy8gICAgICAgICAgICAgICAgdGV4dDogJ1BsZWFzZSB1c2Ugb25lIG9mIHRoZSBsaW5rcyBmcm9tIHRoaXMgbWVudS4gV2hlbiBkaWFsb2cgaXMgb3BlbmVkLCB5b3Ugd2lsbCBmaW5kIHRoZSBYWFggYnV0dG9uIHRoYXQgY2FuIGJlIHVzZWQgdG8gY29udGludWUgdGhlIHRvdXIuJyxcclxuLy8gICAgICAgICAgICAgICAgcGxhY2VtZW50OiAnYm90dG9tJyxcclxuLy8gICAgICAgICAgICAgICAgc2Nyb2xsOiB0cnVlXHJcbiAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdlbGVtZW50JyxcclxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAnI21lbnUnLFxyXG4gICAgICAgICAgICAgICAgaGVhZGluZzogJ05hdmlnYXRpb24nLFxyXG4gICAgICAgICAgICAgICAgdGV4dDogJ1RoaXMgdG91ciBpcyBzdGlsbCB1bmRlciBjb25zdHJ1Y3Rpb24uIE1vcmUgd2lsbCBiZSBhZGRlZCBzb29uLicsXHJcbiAgICAgICAgICAgICAgICBwbGFjZW1lbnQ6ICdib3R0b20nLFxyXG4gICAgICAgICAgICAgICAgc2Nyb2xsOiB0cnVlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdO1xyXG4gICAgICAgICRzY29wZS5vbkZpbmlzaEpveVJpZGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1RPVVIgRklOSVNIRUQnKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zdGFydEpveVJpZGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnN0YXJ0Sm95UmlkZUZsYWcgPSB0cnVlO1xyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2NvbXBvc2l0ZUNsYXNzZXNNb2R1bGUnLCBbXSlcclxuICAgIC5jb250cm9sbGVyKCdjb21wb3NpdGVDbGFzc2VzQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRtb2RhbEluc3RhbmNlLCBjb21wb3NpdGVDbGFzc2VzLCBjb21wb3NpdGVTdGVwVGV4dCwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZUNsYXNzZXMgPSBjb21wb3NpdGVDbGFzc2VzO1xyXG4gICAgICAgICRzY29wZS5jb21wb3NpdGVTdGVwVGV4dCA9IGNvbXBvc2l0ZVN0ZXBUZXh0O1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkbW9kYWxJbnN0YW5jZS5jbG9zZSgpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZUNsYXNzVXJsID0gZnVuY3Rpb24ocGFja2FnZU5hbWUsIGNsYXNzTmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgdXJsID0gJy9wYWdlL2NvbXBvc2l0ZXMvJztcclxuICAgICAgICAgICAgaWYgKHBhY2thZ2VOYW1lICE9PSB1bmRlZmluZWQgJiYgcGFja2FnZU5hbWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICB1cmwgKz0gcGFja2FnZU5hbWUgKyAnLic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGNsYXNzTmFtZVBhcnRzO1xyXG4gICAgICAgICAgICBpZiAoY2xhc3NOYW1lLmluZGV4T2YoJy8nKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWVQYXJ0cyA9IGNsYXNzTmFtZS5zcGxpdCgnLycpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lUGFydHMgPSBjbGFzc05hbWUuc3BsaXQoJ1xcXFwnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB1cmwgKz0gY2xhc3NOYW1lUGFydHNbY2xhc3NOYW1lUGFydHMubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY29tcG9zaXRlU3RlcFRleHQgIT09IHVuZGVmaW5lZCAmJiAkc2NvcGUuY29tcG9zaXRlU3RlcFRleHQgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICB1cmwgKz0gJz9zdGVwVGV4dD0nICsgJHNjb3BlLmNvbXBvc2l0ZVN0ZXBUZXh0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB1cmw7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY29tcG9zaXRlQ2xhc3NUZXh0ID0gZnVuY3Rpb24oY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgICAgIHZhciBjbGFzc05hbWVQYXJ0cztcclxuICAgICAgICAgICAgaWYgKGNsYXNzTmFtZS5pbmRleE9mKCcvJykgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lUGFydHMgPSBjbGFzc05hbWUuc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZVBhcnRzID0gY2xhc3NOYW1lLnNwbGl0KCdcXFxcJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHRleHQgPSBjbGFzc05hbWVQYXJ0c1tjbGFzc05hbWVQYXJ0cy5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgaWYgKHRleHQuaW5kZXhPZignLicpID49IDApIHtcclxuICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnN1YnN0cigwLCB0ZXh0Lmxhc3RJbmRleE9mKCcuJykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0ZXh0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNsYXNzTmFtZVBhdHRlcm4gPSBUY0JkZFNlcnZpY2UuY2xhc3NOYW1lUGF0dGVybjtcclxuICAgICAgICAvLyBUT0RPIFRlc3RcclxuICAgICAgICAkc2NvcGUuY3NzQ2xhc3MgPSBUY0JkZFNlcnZpY2UuY3NzQ2xhc3M7XHJcbiAgICAgICAgJHNjb3BlLmRhdGEgPSB7Y2xhc3M6ICcnfTtcclxuICAgIH0pOyIsImFuZ3VsYXIubW9kdWxlKCdjb21wb3NpdGVzTW9kdWxlJywgW10pXHJcbiAgICAuY29udHJvbGxlcignY29tcG9zaXRlc0N0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwLCAkbW9kYWwsICRsb2NhdGlvbiwgJGNvb2tpZVN0b3JlLCBjb21wb3NpdGVzQ2xhc3MsIHN0ZXBzLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAkc2NvcGUuYWRkTmV3Q29tcG9zaXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGUgPSB7c3RlcFRleHQ6ICcnLCBjb21wb3NpdGVTdGVwczogW3t9XX07XHJcbiAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuY29tcG9zaXRlcy5wdXNoKCRzY29wZS5jb21wb3NpdGUpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmFkZFN0ZXBUZXh0UGFyYW0gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCRsb2NhdGlvbi5zZWFyY2goKS5zdGVwVGV4dCAhPT0gdW5kZWZpbmVkICYmICRsb2NhdGlvbi5zZWFyY2goKS5zdGVwVGV4dCAhPT0gJycpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuY29tcG9zaXRlcy5wdXNoKHtzdGVwVGV4dDogJGxvY2F0aW9uLnNlYXJjaCgpLnN0ZXBUZXh0LCBjb21wb3NpdGVTdGVwczogW119KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmFkZE5ld0NvbXBvc2l0ZVN0ZXAgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZS5jb21wb3NpdGVTdGVwcy5wdXNoKHt9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zZXRMYXN0Q29tcG9zaXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY29tcG9zaXRlc0NsYXNzICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNvbXBvc2l0ZXMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZSA9ICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuY29tcG9zaXRlc1tsZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGUgPSB7fTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcyA9IGNvbXBvc2l0ZXNDbGFzcztcclxuICAgICAgICAkc2NvcGUuYWRkU3RlcFRleHRQYXJhbSgpO1xyXG4gICAgICAgICRzY29wZS5vcmlnaW5hbENvbXBvc2l0ZXNDbGFzcyA9IGFuZ3VsYXIuY29weShjb21wb3NpdGVzQ2xhc3MpO1xyXG4gICAgICAgICRzY29wZS5zZXRMYXN0Q29tcG9zaXRlKCk7XHJcbiAgICAgICAgJHNjb3BlLnN0ZXBzID0gc3RlcHM7XHJcbiAgICAgICAgJHNjb3BlLmNsYXNzTmFtZVBhdHRlcm4gPSBUY0JkZFNlcnZpY2UuY2xhc3NOYW1lUGF0dGVybjtcclxuICAgICAgICAkc2NvcGUuc3RlcFRleHRQYXR0ZXJuID0gVGNCZGRTZXJ2aWNlLnN0ZXBUZXh0UGF0dGVybjtcclxuICAgICAgICAkc2NvcGUuY3NzQ2xhc3MgPSBUY0JkZFNlcnZpY2UuY3NzQ2xhc3M7XHJcbiAgICAgICAgJHNjb3BlLmJ1dHRvbkNzc0NsYXNzID0gZnVuY3Rpb24oY29tcG9zaXRlQ2xhc3NGb3JtLCBjb21wb3NpdGVGb3JtKSB7XHJcbiAgICAgICAgICAgIGlmICghY29tcG9zaXRlQ2xhc3NGb3JtLiR2YWxpZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5idXR0b25Dc3NDbGFzcyhjb21wb3NpdGVDbGFzc0Zvcm0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5idXR0b25Dc3NDbGFzcyhjb21wb3NpdGVGb3JtKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLm9wZW5Db21wb3NpdGUgPSBmdW5jdGlvbihjb21wb3NpdGUpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZSA9IGNvbXBvc2l0ZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5uZXdDb2xsZWN0aW9uSXRlbSA9IFRjQmRkU2VydmljZS5uZXdDb2xsZWN0aW9uSXRlbTtcclxuICAgICAgICAkc2NvcGUucmVtb3ZlQ29sbGVjdGlvbkVsZW1lbnQgPSBUY0JkZFNlcnZpY2UucmVtb3ZlQ29sbGVjdGlvbkVsZW1lbnQ7XHJcbiAgICAgICAgJHNjb3BlLnJldmVydENvbXBvc2l0ZXNDbGFzcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuY29tcG9zaXRlc0NsYXNzID0gYW5ndWxhci5jb3B5KCRzY29wZS5vcmlnaW5hbENvbXBvc2l0ZXNDbGFzcyk7XHJcbiAgICAgICAgICAgICRzY29wZS5jb21wb3NpdGUgPSAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNvbXBvc2l0ZXNbMF07XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuUmV2ZXJ0Q29tcG9zaXRlc0NsYXNzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhYW5ndWxhci5lcXVhbHMoJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcywgJHNjb3BlLm9yaWdpbmFsQ29tcG9zaXRlc0NsYXNzKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5jYW5TYXZlQ29tcG9zaXRlc0NsYXNzID0gZnVuY3Rpb24obmdNb2RlbENvbnRyb2xsZXIpIHtcclxuICAgICAgICAgICAgdmFyIGlzVmFsaWQgPSBuZ01vZGVsQ29udHJvbGxlci4kdmFsaWQ7XHJcbiAgICAgICAgICAgIHZhciBpc1VwZGF0ZWQgPSAhYW5ndWxhci5lcXVhbHMoJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcywgJHNjb3BlLm9yaWdpbmFsQ29tcG9zaXRlc0NsYXNzKTtcclxuICAgICAgICAgICAgdmFyIGlzTmV3ID0gJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5pc05ldztcclxuICAgICAgICAgICAgcmV0dXJuIChpc05ldyB8fCBpc1VwZGF0ZWQpICYmIGlzVmFsaWQ7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY29tcG9zaXRlc0FyZVZhbGlkID0gZnVuY3Rpb24obmdNb2RlbENvbnRyb2xsZXIpIHtcclxuICAgICAgICAgICAgdmFyIGlzVmFsaWQgPSBuZ01vZGVsQ29udHJvbGxlci4kdmFsaWQ7XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNvbXBvc2l0ZXMsIGZ1bmN0aW9uKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LnN0ZXBUZXh0ID09PSB1bmRlZmluZWQgfHwgZWxlbWVudC5zdGVwVGV4dCA9PT0gJycpIHtcclxuICAgICAgICAgICAgICAgICAgICBpc1ZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuY29tcG9zaXRlU3RlcHMgPT09IHVuZGVmaW5lZCB8fCBlbGVtZW50LmNvbXBvc2l0ZVN0ZXBzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzVmFsaWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybiBpc1ZhbGlkO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnNhdmVDb21wb3NpdGVzQ2xhc3MgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJGh0dHAucHV0KCcvZ3Jvb3Z5Q29tcG9zaXRlcycsICRzY29wZS5jb21wb3NpdGVzQ2xhc3MpLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGVsZXRlQ29tcG9zaXRlc0NsYXNzV2l0aG91dENvbmZpcm1hdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9wYWdlL2NvbXBvc2l0ZXMvJyArICRzY29wZS5jb21wb3NpdGVzQ2xhc3MuY2xhc3MgKyAnLmdyb292eScpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbXBvc2l0ZXNDbGFzcy5pc05ldyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm9yaWdpbmFsQ29tcG9zaXRlc0NsYXNzID0gYW5ndWxhci5jb3B5KCRzY29wZS5jb21wb3NpdGVzQ2xhc3MpO1xyXG4gICAgICAgICAgICAgICAgJGNvb2tpZVN0b3JlLnB1dCgnY29tcG9zaXRlQ2xhc3MnLCAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNsYXNzKTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIFRjQmRkU2VydmljZS5vcGVuRXJyb3JNb2RhbChyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuRGVsZXRlQ29tcG9zaXRlc0NsYXNzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoISRzY29wZS5jb21wb3NpdGVzQ2xhc3MuaXNOZXcpO1xyXG5cclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5kZWxldGVDb21wb3NpdGVzQ2xhc3NXaXRob3V0Q29uZmlybWF0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSAkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmNsYXNzO1xyXG4gICAgICAgICAgICB2YXIgb3JpZ2luYWxDbGFzc05hbWUgPSAkc2NvcGUub3JpZ2luYWxDb21wb3NpdGVzQ2xhc3MuY2xhc3M7XHJcbiAgICAgICAgICAgIGlmIChjbGFzc05hbWUgIT09IG9yaWdpbmFsQ2xhc3NOYW1lKSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5kZWxldGUoJy9ncm9vdnlDb21wb3NpdGVzLycgKyBvcmlnaW5hbENsYXNzTmFtZSkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBUY0JkZFNlcnZpY2Uub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLmRlbGV0ZUNvbXBvc2l0ZXNDbGFzcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9IHtzdGF0dXM6ICdEZWxldGUgQ29tcG9zaXRlcyBDbGFzcycsIG1lc3NhZ2U6ICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgY29tcG9zaXRlcyBjbGFzcz8nfTtcclxuICAgICAgICAgICAgdmFyIG9rTW9kYWwgPSBUY0JkZFNlcnZpY2Uub3BlbkNvbmZpcm1hdGlvbk1vZGFsKG1lc3NhZ2UpO1xyXG4gICAgICAgICAgICBva01vZGFsLnJlc3VsdC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZGVsZXRlKCcvZ3Jvb3Z5Q29tcG9zaXRlcy8nICsgJHNjb3BlLm9yaWdpbmFsQ29tcG9zaXRlc0NsYXNzLmNsYXNzKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XHJcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIFRjQmRkU2VydmljZS5vcGVuRXJyb3JNb2RhbChyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIC8vIERvIG5vdGhpbmdcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuc2F2ZUNvbXBvc2l0ZXNUZXh0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuY29tcG9zaXRlc0NsYXNzLmlzTmV3KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ0NyZWF0ZSBOZXcgQ29tcG9zaXRlcyc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1VwZGF0ZSBDb21wb3NpdGVzJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9KTsiLCJhbmd1bGFyLm1vZHVsZSgnbG9naW5Nb2R1bGUnLCBbXSlcclxuICAgIC5jb250cm9sbGVyKCdsb2dpbkN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRsb2NhdGlvbiwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHNjb3BlLmluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS51c2VycyA9IFtdO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmNzc0NsYXNzID0gVGNCZGRTZXJ2aWNlLmNzc0NsYXNzO1xyXG4gICAgICAgICRzY29wZS5idXR0b25Dc3NDbGFzcyA9IFRjQmRkU2VydmljZS5idXR0b25Dc3NDbGFzcztcclxuICAgICAgICAkc2NvcGUuY2FuTG9naW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUubG9naW5Gb3JtLiR2YWxpZDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIFRPRE8gUmVtb3ZlIHdoZW4gdGhlIHJlYWwgc29sdXRpb24gaXMgZG9uZVxyXG4gICAgICAgICRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUudXNlcnMucHVzaCgkc2NvcGUudXNlcik7XHJcbiAgICAgICAgICAgICRzY29wZS51c2VyID0ge307XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLyBUT0RPIFJlbW92ZSB3aGVuIHRoZSByZWFsIHNvbHV0aW9uIGlzIGRvbmVcclxuICAgICAgICAkc2NvcGUuZGVsZXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUudXNlcnMsIGZ1bmN0aW9uKHVzZXIsIGluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodXNlci51c2VybmFtZSA9PT0gJHNjb3BlLnVzZXIudXNlcm5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXNlcnMuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXNlciA9IHt9O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBUT0RPIFN3aXRjaCB0byB0aGUgcmVhbCBIVFRQIHJlcXVlc3RcclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRzY29wZS51c2VycywgZnVuY3Rpb24odXNlciwgaW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIGlmICh1c2VyLnVzZXJuYW1lID09PSAkc2NvcGUudXNlci51c2VybmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvcGFnZS9sb2dpbldlbGNvbWUnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICRzY29wZS51c2VyLm5vdFJlZ2lzdGVyZWQgPSB0cnVlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmluaXQoKTtcclxuICAgIH0pXHJcbiAgICAuY29udHJvbGxlcignbG9naW5XZWxjb21lQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSkge1xyXG4gICAgfSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdzdG9yeU1vZHVsZScsIFtdKVxyXG4gICAgLmNvbnRyb2xsZXIoJ3N0b3J5Q3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsICRtb2RhbCwgJGxvY2F0aW9uLCAkY29va2llU3RvcmUsICRxLCAkYW5jaG9yU2Nyb2xsLCAkdGltZW91dCwgc3RvcnksIHN0ZXBzLCBncm9vdnlDb21wb3NpdGVzLCBUY0JkZFNlcnZpY2UpIHtcclxuICAgICAgICAkc2NvcGUucGVuZGluZ1N0ZXBzID0gW107XHJcbiAgICAgICAgJHNjb3BlLnNldEFjdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLnN0b3J5Lm5hbWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aW9uID0gJ1BVVCc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuYWN0aW9uID0gJ1BPU1QnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZXhwYW5kUGFuZWxzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBzY2VuYXJpb3NFeHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUucGFuZWxzRXhwYW5kZWQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBhbmVsc0V4cGFuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUucGFuZWxzRXhwYW5kZWQgPSAhJHNjb3BlLnBhbmVsc0V4cGFuZGVkO1xyXG4gICAgICAgICAgICAgICAgc2NlbmFyaW9zRXhwYW5kZWQgPSAkc2NvcGUucGFuZWxzRXhwYW5kZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHNjb3BlLnBhbmVscyA9IHtcclxuICAgICAgICAgICAgICAgIHN0b3J5OiAkc2NvcGUucGFuZWxzRXhwYW5kZWQsXHJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJHNjb3BlLnBhbmVsc0V4cGFuZGVkLFxyXG4gICAgICAgICAgICAgICAgbWV0YTogJHNjb3BlLnBhbmVsc0V4cGFuZGVkLFxyXG4gICAgICAgICAgICAgICAgbmFycmF0aXZlOiAkc2NvcGUucGFuZWxzRXhwYW5kZWQsXHJcbiAgICAgICAgICAgICAgICBnaXZlblN0b3JpZXM6ICRzY29wZS5wYW5lbHNFeHBhbmRlZCxcclxuICAgICAgICAgICAgICAgIGxpZmVjeWNsZTogJHNjb3BlLnBhbmVsc0V4cGFuZGVkLFxyXG4gICAgICAgICAgICAgICAgc2NlbmFyaW9zOiBzY2VuYXJpb3NFeHBhbmRlZFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnN0b3J5ID0gc3Rvcnk7XHJcbiAgICAgICAgJHNjb3BlLnN0ZXBzID0gc3RlcHM7XHJcbiAgICAgICAgJHNjb3BlLmdyb292eUNvbXBvc2l0ZXMgPSBncm9vdnlDb21wb3NpdGVzO1xyXG4gICAgICAgICRzY29wZS5zdGVwVHlwZXMgPSBbJ0dJVkVOJywgJ1dIRU4nLCAnVEhFTiddO1xyXG4gICAgICAgICRzY29wZS5zdG9yeUZvcm1DbGFzcyA9ICdjb2wtbWQtMTInO1xyXG4gICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyA9IHRydWU7XHJcbiAgICAgICAgJHNjb3BlLmV4cGFuZFBhbmVscygpO1xyXG4gICAgICAgICRzY29wZS5vcmlnaW5hbFN0b3J5ID0gYW5ndWxhci5jb3B5KHN0b3J5KTtcclxuICAgICAgICB2YXIgcGF0aEFycmF5ID0gJHNjb3BlLnN0b3J5LnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICAkc2NvcGUuZGlyUGF0aCA9IHBhdGhBcnJheS5zbGljZSgwLCBwYXRoQXJyYXkubGVuZ3RoIC0gMSkuam9pbignLycpO1xyXG4gICAgICAgIGlmICgkc2NvcGUuZGlyUGF0aCAhPT0gJycpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmRpclBhdGggKz0gJy8nO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkc2NvcGUuc2V0QWN0aW9uKCk7XHJcbiAgICAgICAgJHNjb3BlLmNzc0NsYXNzID0gVGNCZGRTZXJ2aWNlLmNzc0NsYXNzO1xyXG4gICAgICAgICRzY29wZS5idXR0b25Dc3NDbGFzcyA9IFRjQmRkU2VydmljZS5idXR0b25Dc3NDbGFzcztcclxuICAgICAgICAkc2NvcGUuY2FuU2F2ZVN0b3J5ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBpc1ZhbGlkID0gJHNjb3BlLnN0b3J5Rm9ybS4kdmFsaWQ7XHJcbiAgICAgICAgICAgIHZhciBoYXNDaGFuZ2VkID0gIWFuZ3VsYXIuZXF1YWxzKCRzY29wZS5zdG9yeSwgJHNjb3BlLm9yaWdpbmFsU3RvcnkpO1xyXG4gICAgICAgICAgICByZXR1cm4gaXNWYWxpZCAmJiBoYXNDaGFuZ2VkO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnN0ZXBUZXh0UGF0dGVybiA9IFRjQmRkU2VydmljZS5zdGVwVGV4dFBhdHRlcm47XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLnNhdmVTdG9yeSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmNhblNhdmVTdG9yeSgpKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnkucGF0aCA9ICRzY29wZS5kaXJQYXRoICsgJHNjb3BlLnN0b3J5Lm5hbWUgKyBcIi5zdG9yeVwiO1xyXG4gICAgICAgICAgICAgICAgaWYgKCdQT1NUJyA9PT0gJHNjb3BlLmFjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdHJpcHBlZFBhdGhBcnJheSA9ICRzY29wZS5kaXJQYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmlwcGVkUGF0aCA9IHN0cmlwcGVkUGF0aEFycmF5LnNsaWNlKDAsIHN0cmlwcGVkUGF0aEFycmF5Lmxlbmd0aCAtIDEpLmpvaW4oJy8nKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc3RyaXBwZWRQYXRoICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJpcHBlZFBhdGggKz0gJy8nO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KCcvc3Rvcmllcy9zdG9yeS5qc29uJywgJHNjb3BlLnN0b3J5KS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy9wYWdlL3N0b3JpZXMvdmlldy8nICsgc3RyaXBwZWRQYXRoICsgJHNjb3BlLnN0b3J5Lm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3JpZ2luYWxTdG9yeSA9IGFuZ3VsYXIuY29weSgkc2NvcGUuc3RvcnkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuc3RvcnkubmFtZSAhPT0gJHNjb3BlLm9yaWdpbmFsU3RvcnkubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3Rvcnkub3JpZ2luYWxQYXRoID0gJHNjb3BlLm9yaWdpbmFsU3RvcnkucGF0aDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAucHV0KCcvc3Rvcmllcy9zdG9yeS5qc29uJywgJHNjb3BlLnN0b3J5KS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9yaWdpbmFsU3RvcnkgPSBhbmd1bGFyLmNvcHkoJHNjb3BlLnN0b3J5KTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm9wZW5FcnJvck1vZGFsKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuUnVuU3RvcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUuc3RvcnlGb3JtLiR2YWxpZCAmJiAhJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5ydW5TdG9yeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCRzY29wZS5jYW5SdW5TdG9yeSgpKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2F2ZVN0b3J5KCk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUub3BlblJ1bm5lck1vZGFsKCkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY2xhc3NlcyA9IGRhdGEuY2xhc3NlcztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlGb3JtQ2xhc3MgPSAnY29sLW1kLTYnO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckNsYXNzID0gJ2NvbC1tZC02JztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJWaXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc2VzLmZvckVhY2goZnVuY3Rpb24gKGNsYXNzRW50cnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NFbnRyeS5wYXJhbXMuZm9yRWFjaChmdW5jdGlvbiAocGFyYW1FbnRyeSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvb2tpZVN0b3JlLnB1dChjbGFzc0VudHJ5LmZ1bGxOYW1lICsgXCIuXCIgKyBwYXJhbUVudHJ5LmtleSwgcGFyYW1FbnRyeS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBqc29uID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9yeVBhdGhzOiBbe3BhdGg6ICRzY29wZS5zdG9yeS5wYXRofV0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6IGNsYXNzZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyb292eUNvbXBvc2l0ZXM6ICRzY29wZS5ncm9vdnlDb21wb3NpdGVzXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KCcvcnVubmVyL3J1bi5qc29uJywganNvbikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFJlcG9ydHMocmVzcG9uc2UuZGF0YS5pZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclN1Y2Nlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5vcGVuRXJyb3JNb2RhbChyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0UmVwb3J0cyA9IGZ1bmN0aW9uKHJlcG9ydHNJZCkge1xyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvcmVwb3J0ZXJzL2xpc3QvJyArIHJlcG9ydHNJZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLnN0YXR1cyAhPT0gJ2ZpbmlzaGVkJykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZ2V0UmVwb3J0cyhyZXBvcnRzSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIDUwMDApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVwb3J0cyA9IHJlc3BvbnNlLmRhdGEucmVwb3J0cztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVwb3J0cyA9IHJlcG9ydHM7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHMuaWQgPSByZXBvcnRzSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNldFBlbmRpbmdTdGVwcyhyZXBvcnRzKTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyA9ICRzY29wZS5pc1N0b3J5UnVubmVyU3VjY2VzcyhyZXBvcnRzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlID09PSAnSUQgaXMgTk9UIGNvcnJlY3QnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRSZXBvcnRzKHJlcG9ydHNJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgNTAwMCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBUY0JkZFNlcnZpY2Uub3BlbkVycm9yTW9kYWwocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmlzU3RvcnlSdW5uZXJTdWNjZXNzID0gZnVuY3Rpb24ocmVwb3J0cykge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmVwb3J0cy5mb3JFYWNoKGZ1bmN0aW9uKHJlcG9ydCkge1xyXG4gICAgICAgICAgICAgICAgcmVwb3J0LnN0ZXBzLmZvckVhY2goZnVuY3Rpb24oc3RlcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGVwLnN0YXR1cyAhPT0gJ3N1Y2Nlc3NmdWwnICYmIHN0ZXAuc3RhdHVzICE9PSAncGVuZGluZycgJiYgc3RlcC5zdGF0dXMgIT09ICdub3RQZXJmb3JtZWQnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRSZXBvcnRVcmwgPSBmdW5jdGlvbihyZXBvcnRzSWQsIHJlcG9ydCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJy9hcGkvdjEvcmVwb3J0ZXJzL2dldC8nICsgcmVwb3J0c0lkICsgJy8nICsgcmVwb3J0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLm9wZW5SdW5uZXJNb2RhbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLm9wZW5SdW5uZXJQYXJhbWV0ZXJzTW9kYWwoZmFsc2UpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmdldFJ1bm5lclByb2dyZXNzQ3NzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldFJ1bm5lclByb2dyZXNzQ3NzKCRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmdldFJ1bm5lclN0YXR1c0NzcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5nZXRSdW5uZXJTdGF0dXNDc3MoXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJJblByb2dyZXNzLFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyxcclxuICAgICAgICAgICAgICAgICgkc2NvcGUucGVuZGluZ1N0ZXBzID4gMClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zZXRQZW5kaW5nU3RlcHMgPSBmdW5jdGlvbihyZXBvcnRzKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5wZW5kaW5nU3RlcHMgPSBbXTtcclxuICAgICAgICAgICAgcmVwb3J0cy5mb3JFYWNoKGZ1bmN0aW9uKHJlcG9ydCkge1xyXG4gICAgICAgICAgICAgICAgcmVwb3J0LnN0ZXBzLmZvckVhY2goZnVuY3Rpb24oc3RlcCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGVwLnN0YXR1cyA9PT0gJ3BlbmRpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5wZW5kaW5nU3RlcHMucHVzaCh7dGV4dDogc3RlcC50ZXh0fSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5oYXNQZW5kaW5nU3RlcHMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5wZW5kaW5nU3RlcHMgIT09IHVuZGVmaW5lZCAmJiAkc2NvcGUucGVuZGluZ1N0ZXBzLmxlbmd0aCA+IDA7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0U3RvcnlSdW5uZXJTdGF0dXNUZXh0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldFN0b3J5UnVubmVyU3RhdHVzVGV4dChcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MsXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJTdWNjZXNzLFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnBlbmRpbmdTdGVwcy5sZW5ndGhcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5yZW1vdmVDb2xsZWN0aW9uRWxlbWVudCA9IFRjQmRkU2VydmljZS5yZW1vdmVDb2xsZWN0aW9uRWxlbWVudDtcclxuICAgICAgICAkc2NvcGUuYWRkRWxlbWVudCA9IGZ1bmN0aW9uIChjb2xsZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGNvbGxlY3Rpb24ucHVzaCh7fSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuYWRkU2NlbmFyaW9FbGVtZW50ID0gZnVuY3Rpb24gKGNvbGxlY3Rpb24pIHtcclxuICAgICAgICAgICAgY29sbGVjdGlvbi5wdXNoKHt0aXRsZTogJycsIG1ldGE6IFtdLCBzdGVwczogW10sIGV4YW1wbGVzVGFibGU6ICcnfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUucmV2ZXJ0U3RvcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5zdG9yeSA9IGFuZ3VsYXIuY29weSgkc2NvcGUub3JpZ2luYWxTdG9yeSk7XHJcbiAgICAgICAgICAgICRzY29wZS5zdG9yeUZvcm0uJHNldFByaXN0aW5lKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuUmV2ZXJ0U3RvcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAhYW5ndWxhci5lcXVhbHMoJHNjb3BlLnN0b3J5LCAkc2NvcGUub3JpZ2luYWxTdG9yeSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuRGVsZXRlU3RvcnkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUuYWN0aW9uID09PSAnUFVUJyAmJiAhJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5kZWxldGVTdG9yeSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIHBhdGggPSAkc2NvcGUuZGlyUGF0aCArICRzY29wZS5zdG9yeS5uYW1lICsgJy5zdG9yeSc7XHJcbiAgICAgICAgICAgIFRjQmRkU2VydmljZS5kZWxldGVTdG9yeShwYXRoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5zdGVwRW50ZXJLZXkgPSBUY0JkZFNlcnZpY2UubmV3Q29sbGVjdGlvbkl0ZW07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLmNsaWNrUGVuZGluZ1N0ZXAgPSBmdW5jdGlvbihzdGVwVGV4dCkge1xyXG4gICAgICAgICAgICB2YXIgY29tcG9zaXRlQ2xhc3MgPSAkY29va2llU3RvcmUuZ2V0KFwiY29tcG9zaXRlQ2xhc3NcIik7XHJcbiAgICAgICAgICAgIGlmIChjb21wb3NpdGVDbGFzcyA9PT0gdW5kZWZpbmVkIHx8IGNvbXBvc2l0ZUNsYXNzID09PSAnJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFRjQmRkU2VydmljZS5vcGVuQ29tcG9zaXRlQ2xhc3Moc3RlcFRleHQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRsb2NhdGlvbi5zZWFyY2goJ3N0ZXBUZXh0Jywgc3RlcFRleHQpLnBhdGgoJy9wYWdlL2NvbXBvc2l0ZXMvJyArIGNvbXBvc2l0ZUNsYXNzICsgJy5ncm9vdnknKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0XHJcbiAgICAgICAgJHNjb3BlLm9wZW5FcnJvck1vZGFsID0gVGNCZGRTZXJ2aWNlLm9wZW5FcnJvck1vZGFsO1xyXG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoJ3RvcE1lbnVNb2R1bGUnLCBbXSlcclxuICAgIC5jb250cm9sbGVyKCd0b3BNZW51Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgJG1vZGFsLCAkbG9jYXRpb24sIFRjQmRkU2VydmljZSkge1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdCBtb3JlIHRoYW4gY2hlY2tpbmcgd2hldGhlciAkbW9kYWwub3BlbiB3YXMgY2FsbGVkXHJcbiAgICAgICAgJHNjb3BlLm9wZW5TdG9yeSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9zdG9yaWVzLnRtcGwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc3Rvcmllc0N0cmwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge307XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5vcGVuQ29tcG9zaXRlQ2xhc3MgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5Db21wb3NpdGVDbGFzcygpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmdldFRpdGxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBwYXRoID0gJGxvY2F0aW9uLnBhdGgoKTtcclxuICAgICAgICAgICAgaWYgKHBhdGguaW5kZXhPZignL3BhZ2Uvc3Rvcmllcy92aWV3LycpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1ZpZXcgU3RvcnknO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdGguaW5kZXhPZignL3BhZ2Uvc3Rvcmllcy9uZXcvJykgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnTmV3IFN0b3J5JztcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXRoLmluZGV4T2YoJy9wYWdlL2NvbXBvc2l0ZXMvJykgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnQ29tcG9zaXRlcyc7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGF0aC5pbmRleE9mKCcvcGFnZS9yZXBvcnRzLycpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1JlcG9ydHMnO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdGguaW5kZXhPZignL3BhZ2UvbG9naW4vJykgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnTG9naW4nO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdGguaW5kZXhPZignL3BhZ2UvbG9naW5XZWxjb21lLycpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1dlbGNvbWUnO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdGguaW5kZXhPZignL3BhZ2UvdG91ci8nKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdIb21lJztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ3RvdXJNb2R1bGUnLCBbXSlcclxuICAgIC5jb250cm9sbGVyKCd0b3VyQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUpIHtcclxuICAgIH0pO1xyXG4iLCJhbmd1bGFyLm1vZHVsZSgncnVubmVyTW9kdWxlJywgW10pXHJcbiAgICAuY29udHJvbGxlcigncnVubmVyQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJG1vZGFsLCAkaHR0cCwgJGxvY2F0aW9uLCAkdGltZW91dCwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgLy8gVE9ETyBUZXN0IG1vcmUgdGhhbiBjaGVja2luZyB3aGV0aGVyICRtb2RhbC5vcGVuIHdhcyBjYWxsZWRcclxuICAgICAgICAkc2NvcGUub3BlblJ1bm5lclNlbGVjdG9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9hc3NldHMvaHRtbC9ydW5uZXIvcnVubmVyU2VsZWN0b3IudG1wbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdydW5uZXJTZWxlY3RvckN0cmwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge307XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIC8vIFRPRE8gVGVzdFxyXG4gICAgICAgICRzY29wZS5vcGVuUnVubmVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBydW5uZXJTZWxlY3RvciA9ICRzY29wZS5vcGVuUnVubmVyU2VsZWN0b3IoKTtcclxuICAgICAgICAgICAgaWYgKHJ1bm5lclNlbGVjdG9yICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHJ1bm5lclNlbGVjdG9yLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3J5UGF0aHMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLmRpcnMuZm9yRWFjaChmdW5jdGlvbiAoZGlyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3J5UGF0aHMucHVzaCh7cGF0aDogZGlyLnBhdGggKyBcIi8qKi8qLnN0b3J5XCJ9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhLnN0b3JpZXMuZm9yRWFjaChmdW5jdGlvbiAoc3RvcnkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcnlQYXRocy5wdXNoKHtwYXRoOiBzdG9yeS5wYXRofSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5SdW5uZXJQYXJhbWV0ZXJzTW9kYWwodHJ1ZSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNsYXNzZXMgPSBkYXRhLmNsYXNzZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhY3Rpb24gPSBkYXRhLmFjdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCcvZ3Jvb3Z5Q29tcG9zaXRlcycpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3Jvb3Z5Q29tcG9zaXRlcyA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXBpSnNvbiA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdG9yeVBhdGhzOiBzdG9yeVBhdGhzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzZXM6IGNsYXNzZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3Jvb3Z5Q29tcG9zaXRlczogZ3Jvb3Z5Q29tcG9zaXRlc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhY3Rpb24gPT09ICdydW4nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJ1bigkc2NvcGUuYXBpSnNvbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dBcGkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNob3dBcGkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUucnVuID0gZnVuY3Rpb24oanNvbikge1xyXG4gICAgICAgICAgICB2YXIgcmVwb3J0c1ByZWZpeCA9ICcvYXBpL3YxL3JlcG9ydGVycy9nZXQvJztcclxuICAgICAgICAgICAgJHNjb3BlLnJlcG9ydHNVcmwgPSAnJztcclxuICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVyU3VjY2VzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAkc2NvcGUuc2hvd1J1bm5lclByb2dyZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgJGh0dHAucG9zdCgnL3J1bm5lci9ydW4uanNvbicsIGpzb24pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09ICdPSycpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVwb3J0c1VybCA9IHJlcG9ydHNQcmVmaXggKyBkYXRhLnJlcG9ydHNQYXRoO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRSZXBvcnRzKGRhdGEuaWQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhLnN0YXR1cyA9PT0gJ0ZBSUxFRCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVwb3J0c1VybCA9IHJlcG9ydHNQcmVmaXggKyBkYXRhLnJlcG9ydHNQYXRoO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5FcnJvck1vZGFsKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclN1Y2Nlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIFRjQmRkU2VydmljZS5vcGVuRXJyb3JNb2RhbChyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0UmVwb3J0cyA9IGZ1bmN0aW9uKHJlcG9ydHNJZCkge1xyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvdjEvcmVwb3J0ZXJzL2xpc3QvJyArIHJlcG9ydHNJZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5yZXBvcnRzID0gcmVzcG9uc2UuZGF0YTtcclxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUucmVwb3J0cy5zdGF0dXMgIT09ICdmaW5pc2hlZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1J1bm5lclByb2dyZXNzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmdldFJlcG9ydHMocmVwb3J0c0lkKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCAxNTAwMCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zaG93UnVubmVyUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5tZXNzYWdlID09PSAnSUQgaXMgTk9UIGNvcnJlY3QnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5nZXRSZXBvcnRzKHJlcG9ydHNJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMTUwMDApO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2hvd1J1bm5lclByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgVGNCZGRTZXJ2aWNlLm9wZW5FcnJvck1vZGFsKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICRzY29wZS5nZXRSdW5uZXJTdGF0dXNDc3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBUY0JkZFNlcnZpY2UuZ2V0UnVubmVyU3RhdHVzQ3NzKFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyxcclxuICAgICAgICAgICAgICAgICRzY29wZS5zdG9yeVJ1bm5lclN1Y2Nlc3MsXHJcbiAgICAgICAgICAgICAgICAoJHNjb3BlLnBlbmRpbmdTdGVwcyA+IDApXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0U3RvcnlSdW5uZXJTdGF0dXNUZXh0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICdTdG9yaWVzIHJ1biBpcyBpbiBwcm9ncmVzcyc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1N0b3JpZXMgcnVuIGlzIGZpbmlzaGVkJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmdldFJ1bm5lclByb2dyZXNzQ3NzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gVGNCZGRTZXJ2aWNlLmdldFJ1bm5lclByb2dyZXNzQ3NzKCRzY29wZS5zdG9yeVJ1bm5lckluUHJvZ3Jlc3MpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLnN0b3J5UnVubmVySW5Qcm9ncmVzcyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAkc2NvcGUuc3RvcnlSdW5uZXJTdWNjZXNzID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRzY29wZS5zaG93UnVubmVyUHJvZ3Jlc3MgPSBmYWxzZTtcclxuICAgICAgICAgICAgJHNjb3BlLnBlbmRpbmdTdGVwcyA9IFtdO1xyXG4gICAgICAgICAgICAkc2NvcGUucmVwb3J0c1VybCA9ICcnO1xyXG4gICAgICAgICAgICAkc2NvcGUub3BlblJ1bm5lcigpO1xyXG4gICAgICAgICAgICAkc2NvcGUuc2hvd0FwaSA9IGZhbHNlO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmFwaVVybCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGxvY2F0aW9uLnByb3RvY29sKCkgKyAnOi8vJyArICRsb2NhdGlvbi5ob3N0KCkgKyAnOicgKyAkbG9jYXRpb24ucG9ydCgpICsgJy9ydW5uZXIvcnVuLmpzb24nO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLmluaXQoKTtcclxuICAgIH0pXHJcbiAgICAuY29udHJvbGxlcigncnVubmVyU2VsZWN0b3JDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJG1vZGFsLCAkbW9kYWxJbnN0YW5jZSwgVGNCZGRTZXJ2aWNlKSB7XHJcbiAgICAgICAgJHNjb3BlLmZpbGVzID0ge2RpcnM6IFtdLCBzdG9yaWVzOiBbXX07XHJcbiAgICAgICAgVGNCZGRTZXJ2aWNlLmdldFN0b3JpZXMoJHNjb3BlLCAnJyk7XHJcbiAgICAgICAgJHNjb3BlLm9wZW5EaXIgPSBmdW5jdGlvbihwYXRoKSB7XHJcbiAgICAgICAgICAgIFRjQmRkU2VydmljZS5vcGVuRGlyKCRzY29wZSwgcGF0aCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuY2VsUnVubmVyU2VsZWN0b3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLm9rUnVubmVyU2VsZWN0b3IgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHNlbGVjdGVkRmlsZXMgPSB7ZGlyczogW10sIHN0b3JpZXM6IFtdfTtcclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRzY29wZS5maWxlcy5kaXJzLCBmdW5jdGlvbih2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLnNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRGaWxlcy5kaXJzLnB1c2goe3BhdGg6ICRzY29wZS5yb290UGF0aCArIHZhbHVlLm5hbWV9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuZmlsZXMuc3RvcmllcywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5zZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkRmlsZXMuc3Rvcmllcy5wdXNoKHtwYXRoOiAkc2NvcGUucm9vdFBhdGggKyB2YWx1ZS5uYW1lICsgXCIuc3RvcnlcIn0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2Uoc2VsZWN0ZWRGaWxlcyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuYWxsb3dUb1ByZXZEaXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5yb290UGF0aCAhPT0gJyc7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuQ29udGludWUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGhhc1NlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuZmlsZXMuZGlycywgZnVuY3Rpb24odmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZS5zZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc1NlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICghaGFzU2VsZWN0ZWQpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCgkc2NvcGUuZmlsZXMuc3RvcmllcywgZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLnNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc1NlbGVjdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gaGFzU2VsZWN0ZWQ7XHJcbiAgICAgICAgfTtcclxuICAgIH0pXHJcbiAgICAuY29udHJvbGxlcigncnVubmVyUGFyYW1zQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbEluc3RhbmNlLCAkY29va2llU3RvcmUsIGRhdGEsIHNob3dHZXRBcGkpIHtcclxuICAgICAgICAkc2NvcGUuY2xhc3NlcyA9IGRhdGEuY2xhc3NlcztcclxuICAgICAgICAkc2NvcGUucGFyYW1BcnJheSA9IFtdO1xyXG4gICAgICAgICRzY29wZS5zZXRQYXJhbXMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmNsYXNzZXMuZm9yRWFjaChmdW5jdGlvbihjbGFzc0VudHJ5KSB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc0VudHJ5LnBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtRW50cnkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1FbnRyeS52YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHBhcmFtRW50cnkudmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtRW50cnkuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtRW50cnkuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtRW50cnkudmFsdWUgPSAkY29va2llU3RvcmUuZ2V0KGNsYXNzRW50cnkuZnVsbE5hbWUgKyBcIi5cIiArIHBhcmFtRW50cnkua2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDb3VsZCBub3QgcmV0cmlldmUgY29va2llICcgKyBjbGFzc0VudHJ5LmZ1bGxOYW1lICsgXCIuXCIgKyBwYXJhbUVudHJ5LmtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHRcdCRzY29wZS5oYXNPcHRpb25zID0gZnVuY3Rpb24ob3B0aW9ucykge1xyXG5cdFx0XHRpZiAob3B0aW9ucykge1xyXG5cdFx0XHQgIHJldHVybiBvcHRpb25zLmxlbmd0aCA+IDA7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdCAgcmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG4gICAgICAgICRzY29wZS5oYXNQYXJhbXMgPSBmdW5jdGlvbihjbGFzc0VudHJ5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjbGFzc0VudHJ5LnBhcmFtcyAhPT0gdW5kZWZpbmVkICYmIGNsYXNzRW50cnkucGFyYW1zLmxlbmd0aCA+IDA7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUub2sgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJG1vZGFsSW5zdGFuY2UuY2xvc2Uoe2FjdGlvbjogJ3J1bicsIGNsYXNzZXM6ICRzY29wZS5jbGFzc2VzfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmRpc21pc3MoJ2NhbmNlbCcpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnNob3dHZXRBcGkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNob3dHZXRBcGk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuZ2V0QXBpID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRtb2RhbEluc3RhbmNlLmNsb3NlKHthY3Rpb246ICdhcGknLCBjbGFzc2VzOiAkc2NvcGUuY2xhc3Nlc30pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgJHNjb3BlLnBhcmFtRWxlbWVudElkID0gZnVuY3Rpb24oY2xhc3NOYW1lLCBwYXJhbUtleSkge1xyXG4gICAgICAgICAgICB2YXIgZm9ybWF0dGVkQ2xhc3NOYW1lID0gY2xhc3NOYW1lLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpICsgY2xhc3NOYW1lLnNsaWNlKDEpO1xyXG4gICAgICAgICAgICB2YXIgZm9ybWF0dGVkUGFyYW1LZXkgPSBwYXJhbUtleS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHBhcmFtS2V5LnNsaWNlKDEpO1xyXG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0dGVkQ2xhc3NOYW1lICsgZm9ybWF0dGVkUGFyYW1LZXk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICAkc2NvcGUuc2V0UGFyYW1zKCk7XHJcbiAgICB9KTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9