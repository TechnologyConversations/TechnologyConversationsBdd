
(file:data/stories/tcbdd/runners/runnerSingleStory.story)
Narrative:
In order to verify behaviours
As a application user
I want to be able to run story and see results
Lifecycle:

Scenario: Can run story
Given Web user is in the Story page with all successful steps
When File is copied from data/stories/test/dummySuccess.story to data/stories/testDirectory/testSuccessStory.story
Given Web address /page/stories/view/testDirectory/testSuccessStory is opened
When Web user clicks the element expandPanels
When Web single story runner is run
Given Web page is refreshed
When Web user clicks the element runStory
Then Web element modalHeader should have text Runner Parameters
When Web user clicks the element confirmRunStory
Given Web timeout is 60 seconds
Then story is running
Then Web element runnerStatus should have text Story run is in progress

Scenario: Can NOT run multiple stories
Given Web user is in the Story page with all successful steps
When File is copied from data/stories/test/dummySuccess.story to data/stories/testDirectory/testSuccessStory.story
Given Web address /page/stories/view/testDirectory/testSuccessStory is opened
When Web user clicks the element expandPanels
When Web single story runner is run
Given Web page is refreshed
When Web user clicks the element runStory
Then Web element modalHeader should have text Runner Parameters
When Web user clicks the element confirmRunStory
Given Web timeout is 60 seconds
Then Web element runStory is disabled

Scenario: Has progress bar
Given Web user is in the Story page with all successful steps
When File is copied from data/stories/test/dummySuccess.story to data/stories/testDirectory/testSuccessStory.story
Given Web address /page/stories/view/testDirectory/testSuccessStory is opened
When Web user clicks the element expandPanels
When Web single story runner is run
Given Web page is refreshed
When Web user clicks the element runStory
Then Web element modalHeader should have text Runner Parameters
When Web user clicks the element confirmRunStory
Given Web timeout is 60 seconds
Then Web element runnerStatus should have text Story run is in progress

Scenario: Has parameters dialog
Given Web user is in the Story page with all successful steps
When File is copied from data/stories/test/dummySuccess.story to data/stories/testDirectory/testSuccessStory.story
Given Web address /page/stories/view/testDirectory/testSuccessStory is opened
When Web user clicks the element expandPanels
When Web user clicks the element runStory
Then Web element modalHeader is visible

Scenario: Can retrieve values of last parameters used
Given Web user is in the Story page with all successful steps
When File is copied from data/stories/test/dummySuccess.story to data/stories/testDirectory/testSuccessStory.story
Given Web address /page/stories/view/testDirectory/testSuccessStory is opened
When Web user clicks the element expandPanels
When Web user clicks the element runStory
When Web user selects Phantom JS from the dropdown list webStepsBrowserOption
When Web user sets value http://localhost:9000 to the element webStepsUrl
When Web user clicks the element confirmRunStory
Given Web timeout is 60 seconds
Then Web element runnerStatus should have text Story run was successful
When Web user clicks the element runStory
Then Web dropdown list webStepsBrowserOption has Phantom JS selected
Then Web element webStepsUrl should have value http://localhost:9000

Scenario: Can display successful status
Given Web user is in the Story page with all successful steps
When File is copied from data/stories/test/dummySuccess.story to data/stories/testDirectory/testSuccessStory.story
Given Web address /page/stories/view/testDirectory/testSuccessStory is opened
When Web user clicks the element expandPanels
When Web single story runner is run
Given Web page is refreshed
When Web user clicks the element runStory
Then Web element modalHeader should have text Runner Parameters
When Web user clicks the element confirmRunStory
Given Web timeout is 60 seconds
Then Web element runnerStatus should have text Story run was successful

Scenario: Can display the list of pending steps
Given Web user is in the Story screen with pending steps
When File is copied from data/stories/test/dummyPending.story to data/stories/testDirectory/testPendingStory.story
Given Web address /page/stories/view/testDirectory/testPendingStory is opened
When Web user clicks the element expandPanels
When Web single story runner is run
Given Web page is refreshed
When Web user clicks the element runStory
Then Web element modalHeader should have text Runner Parameters
When Web user clicks the element confirmRunStory
Given Web timeout is 60 seconds
Then Web element pendingSteps is visible
Then Web element pendingStep1 is visible

Scenario: Can display runner reports
Given Web user is in the Story page with all successful steps
When File is copied from data/stories/test/dummySuccess.story to data/stories/testDirectory/testSuccessStory.story
Given Web address /page/stories/view/testDirectory/testSuccessStory is opened
When Web user clicks the element expandPanels
When Web single story runner is run
Given Web page is refreshed
When Web user clicks the element runStory
Then Web element modalHeader should have text Runner Parameters
When Web user clicks the element confirmRunStory
Given Web timeout is 60 seconds
Then Web element runnerReports is visible

Scenario: Can cancel story runner from the parameters dialog
Given Web user is in the Story page with all successful steps
When File is copied from data/stories/test/dummySuccess.story to data/stories/testDirectory/testSuccessStory.story
Given Web address /page/stories/view/testDirectory/testSuccessStory is opened
When Web user clicks the element expandPanels
When Web user clicks the element runStory
When Web user clicks the element cancelRunStory
Then Web element modalHeader is NOT visible

Scenario: Can display failed status
Given Web user is in the Story page with failed steps
When File is copied from data/stories/test/dummyFailed.story to data/stories/testDirectory/testFailedStory.story
Given Web address /page/stories/view/testDirectory/testFailedStory is opened
When Web user clicks the element expandPanels
When Web single story runner is run
Given Web page is refreshed
When Web user clicks the element runStory
Then Web element modalHeader should have text Runner Parameters
When Web user clicks the element confirmRunStory
Given Web timeout is 60 seconds
Then Web element runnerStatus should have text Story run failed

Scenario: Can display pending status
Given Web user is in the Story screen with pending steps
When File is copied from data/stories/test/dummyPending.story to data/stories/testDirectory/testPendingStory.story
Given Web address /page/stories/view/testDirectory/testPendingStory is opened
When Web user clicks the element expandPanels
When Web single story runner is run
Given Web page is refreshed
When Web user clicks the element runStory
Then Web element modalHeader should have text Runner Parameters
When Web user clicks the element confirmRunStory
Given Web timeout is 60 seconds
Then Web element runnerStatus should have text Story run was successful with 1 pending steps

Scenario: Pending steps are links to composites page
Given Web user is in the Story screen with pending steps
When File is copied from data/stories/test/dummyPending.story to data/stories/testDirectory/testPendingStory.story
Given Web address /page/stories/view/testDirectory/testPendingStory is opened
When Web user clicks the element expandPanels
When Web single story runner is run
Given Web page is refreshed
When Web user clicks the element runStory
Then Web element modalHeader should have text Runner Parameters
When Web user clicks the element confirmRunStory
Given Web timeout is 60 seconds
When Web user clicks the element pendingStep1
Then Web user is in the composites modal screen
Then Web element modalHeader should have text Browse Composites

Scenario: Can choose which browser to run from a dropdown list
Given Web user is in the Story page with all successful steps
When File is copied from data/stories/test/dummySuccess.story to data/stories/testDirectory/testSuccessStory.story
Given Web address /page/stories/view/testDirectory/testSuccessStory is opened
When Web user clicks the element expandPanels
When Web user clicks the element runStory
When Web user selects Mozilla Firefox from the dropdown list webStepsBrowserOption
When Web user selects Phantom JS from the dropdown list webStepsBrowserOption
Then Web dropdown list webStepsBrowserOption has Phantom JS selected


