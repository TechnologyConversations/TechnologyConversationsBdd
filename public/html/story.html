<form class="form-horizontal" role="form" id="storyForm" name="storyForm" novalidate="novalidate">
    <!--Story name-->
    <div class="form-group" ng-class="getCssClass(storyForm.storyNameInput)">
        <div class="col-sm-12">
            <input id="storyNameInput" name="storyNameInput" class="form-control input-lg" type="text" ng-model="story.name" placeholder="story name" required="true">
        </div>
    </div>
    <accordion close-others="false">
        <accordion-group heading="Description">
            <div class="form-group" ng-class="getCssClass(storyForm.storyDescriptionInput)">
                <div class="col-sm-12">
                    <textarea id="storyDescriptionInput" name="storyDescriptionInput" class="form-control" ng-model="story.description" placeholder="story description" rows="5"></textarea>
                </div>
            </div>
        </accordion-group>
        <!--Story meta-->
        <accordion-group heading="Meta">
            <div class="form-group">
                <div ng-repeat="meta in story.meta" ng-form="storyMetaForm" ng-class="getCssClass(storyMetaForm.storyMetaInput)">
                    <div class="col-sm-11">
                        <input id="storyMetaInput{{$index}}" name="storyMetaInput" class="form-control" type="text" ng-model="meta.element" required="true">
                    </div>
                    <div class="col-sm-1">
                        <button id="storyMetaRemove{{$index}}" class="btn btn-warning" ng-click="removeElement(story.meta, $index)">X</button>
                    </div>
                </div>
                <div>
                    <div class="col-sm-11">&nbsp;</div>
                    <div class="col-sm-1">
                        <button id="storyMetaAdd" class="btn btn-warning" ng-click="addElement(story.meta, element)">&gt;</button>
                    </div>
                </div>
            </div>
        </accordion-group>
        <!--Narrative-->
        <accordion-group heading="Narrative">
            <div class="form-group" ng-class="getCssClass(storyForm.storyNarrativeInOrderToInput)">
                <label id="storyNarrativeInOrderTo" for="storyNarrativeInOrderToInput" class="control-label col-sm-2">In order to</label>
                <div class="col-sm-10">
                    <input id="storyNarrativeInOrderToInput" name="storyNarrativeInOrderToInput" class="form-control" type="text" ng-model="story.narrative.inOrderTo">
                </div>
            </div>
            <div class="form-group" ng-class="getCssClass(storyForm.storyNarrativeAsAInput)">
                <label id="storyNarrativeAsA" for="storyNarrativeAsAInput" class="control-label col-sm-2">As a</label>
                <div class="col-sm-10">
                    <input id="storyNarrativeAsAInput" name="storyNarrativeAsAInput" class="form-control" type="text" ng-model="story.narrative.asA">
                </div>
            </div>
            <div class="form-group" ng-class="getCssClass(storyForm.storyNarrativeIWantToInput)">
                <label id="storyNarrativeIWantTo" for="storyNarrativeIWantToInput" class="control-label col-sm-2">I want to</label>
                <div class="col-sm-10">
                    <input id="storyNarrativeIWantToInput" name="storyNarrativeIWantToInput" class="form-control" type="text" ng-model="story.narrative.iWantTo">
                </div>
            </div>
        </accordion-group>
        <!--Given stories-->
        <accordion-group heading="Given Stories">
            <div class="form-group">
                <div ng-repeat="givenStory in story.givenStories" ng-form="storyGivenStoryForm" ng-class="getCssClass(storyGivenStoryForm.storyGivenStoryInput)">
                    <div class="col-sm-11">
                        <input id="storyGivenStoryInput{{$index}}" name="storyGivenStoryInput" class="form-control" type="text" ng-model="givenStory.story" required="true">
                    </div>
                    <div class="col-sm-1">
                        <button id="storyGivenStoryAdd{{$index}}" class="btn btn-warning" ng-click="removeElement(story.givenStories, $index)">X</button>
                    </div>
                </div>
                <div>
                    <div class="col-sm-11">&nbsp;</div>
                    <div class="col-sm-1">
                        <button id="storyGivenStoryRemove" class="btn btn-warning" ng-click="addElement(story.givenStories, story)">&gt;</button>
                    </div>
                </div>
            </div>
        </accordion-group>
        <!--Lifecycle-->
        <accordion-group heading="Lifecycle">
            <h3 id="storyLifecycleBeforeHeader">Before:</h3>
            <div class="form-group">
                <div ng-repeat="stepElement in story.lifecycle.before" ng-form="storyLifecycleBeforeForm" ng-class="getCssClass(storyLifecycleBeforeForm.storyStepInput)">
                    <div class="col-sm-11">
                        <input id="storyLifecycleBeforeStepInput{{$index}}" name="storyStepInput" class="form-control" type="text" ng-model="stepElement.step" required="true">
                    </div>
                    <div class="col-sm-1">
                        <button id="storyLifecycleBeforeStepRemove{{$index}}" class="btn btn-warning" ng-click="removeElement(story.lifecycle.before, $index)">X</button>
                    </div>
                </div>
                <div>
                    <div class="col-sm-11">&nbsp;</div>
                    <div class="col-sm-1">
                        <button id="storyLifecycleBeforeStepAdd" class="btn btn-warning" ng-click="addElement(story.lifecycle.before, step)">&gt;</button>
                    </div>
                </div>
            </div>
            <h3 id="storyLifecycleAfterHeader">After:</h3>
            <div class="form-group">
                <div ng-repeat="stepElement in story.lifecycle.after" ng-form="storyLifecycleAfterForm" ng-class="getCssClass(storyLifecycleAfterForm.storyStepInput)">
                    <div class="col-sm-11">
                        <input id="storyLifecycleAfterStepInput{{$index}}" name="storyStepInput" class="form-control" type="text" ng-model="stepElement.step" required="true">
                    </div>
                    <div class="col-sm-1">
                        <button id="storyLifecycleAfterStepRemove{{$index}}" class="btn btn-warning" ng-click="removeElement(story.lifecycle.after, $index)">X</button>
                    </div>
                </div>
                <div>
                    <div class="col-sm-11">&nbsp;</div>
                    <div class="col-sm-1">
                        <button id="storyLifecycleAfterStepAdd" class="btn btn-warning" ng-click="addElement(story.lifecycle.after, step)">&gt;</button>
                    </div>
                </div>
            </div>
        </accordion-group>
        <!--Scenarios-->
        <accordion-group heading="Scenarios" is-open="true">
            <div class="form-group">
                <accordion close-others="false">
                    <accordion-group ng-repeat="scenario in story.scenarios" ng-form="storyScenarioForm" ng-class="getCssClass(storyScenarioForm.storyScenarioTitleInput)">
                        <accordion-heading>
                            Scenario: {{scenario.title}}
                        </accordion-heading>
                        <h3 id="storyScenarioScenarioHeader{{$index}}" class="col-sm-12">Scenario:</h3>
                        <!--Scenario title-->
                        <div class="col-sm-11">
                            <input id="storyScenarioTitleInput{{$index}}" name="storyScenarioTitleInput" class="form-control" type="text" ng-model="scenario.title" required="true">
                        </div>
                        <div class="col-sm-1">
                            <button id="storyScenarioRemove{{$index}}" class="btn btn-warning" ng-click="removeElement(story.scenarios, $index)">X</button>
                        </div>
                        <!--Scenario meta-->
                        <h4 id="storyScenarioMetaHeader{{$index}}" class="col-sm-12">Meta:</h4>
                        <div ng-repeat="meta in scenario.meta" ng-form="storyScenarioMetaForm" ng-class="getCssClass(storyScenarioMetaForm.storyScenarioMetaInput)">
                            <div class="col-sm-11">
                                <input name="storyScenarioMetaInput" class="form-control" type="text" ng-model="meta.element" required="true">
                            </div>
                            <div class="col-sm-1">
                                <button id="storyScenarioMetaRemove{{$index}}" class="btn btn-warning" ng-click="removeElement(scenario.meta, $index)">X</button>
                            </div>
                        </div>
                        <div>
                            <div class="col-sm-11">&nbsp;</div>
                            <div class="col-sm-1">
                                <button id="storyScenarioMetaAdd" class="btn btn-warning" ng-click="addElement(scenario.meta, element)">&gt;</button>
                            </div>
                        </div>
                        <!--Scenario steps-->
                        <h4 id="storyScenarioStepsHeader{{$index}}" class="col-sm-12">Steps:</h4>
                        <div ng-repeat="stepElement in scenario.steps" ng-form="storyScenarioStepForm" ng-class="getCssClass(storyScenarioStepForm.storyScenarioStepInput)">
                            <div class="col-sm-11">
                                <input name="storyScenarioStepInput" class="form-control" type="text" ng-model="stepElement.step" required="true">
                            </div>
                            <div class="col-sm-1">
                                <button class="btn btn-warning" ng-click="removeElement(scenario.steps, $index)">X</button>
                            </div>
                        </div>
                        <div>
                            <div class="col-sm-11">&nbsp;</div>
                            <div class="col-sm-1">
                                <button class="btn btn-warning" ng-click="addElement(scenario.steps, step)">&gt;</button>
                            </div>
                        </div>
                        <!--Scenario examples-->
                        <h4 id="storyScenarioExamplesHeader{{$index}}" class="col-sm-12">Examples:</h4>
                        <div class="col-sm-12">
                            <textarea name="storyScenarioExamplesInput" class="form-control" ng-model="scenario.examplesTable"></textarea>
                        </div>
                    </accordion-group>
                </accordion>
                <div>
                    <div class="col-sm-11">&nbsp;</div>
                    <div class="col-sm-1">
                        <button id="storyScenarioAdd" class="btn btn-warning" ng-click="addScenarioElement(story.scenarios)">&gt;</button>
                    </div>
                </div>
            </div>
        </accordion-group>
    </accordion>
    <button class="btn btn-lg btn-primary" ng-class="getButtonCssClass()" ng-disabled="!canSaveStory()" ng-click="saveStory()">Save</button>
    <button class="btn btn-lg btn-info" ng-click="revertStory()" ng-disabled="!canRevertStory()">Revert Changes</button>
</form>